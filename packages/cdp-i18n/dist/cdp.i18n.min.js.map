{"version":3,"sources":["dist/cdp.i18n.js"],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_1__","__WEBPACK_EXTERNAL_MODULE_2__","__WEBPACK_EXTERNAL_MODULE_3__","modules","installedModules","__webpack_require__","moduleId","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","$","CDP","apply","undefined","jQuery","RESULT_CODE_BASE","_MODULE_RESULT_CODE_RANGE_CDP","LOCAL_CODE_BASE","RESULT_CODE","DECLARE_ERROR_CODE","CDP_I18N","I18N","Promise","TAG","initializeI18N","settings","resolve","reject","i18nSettings","options","i18nOptions_1","resources","lng","ns","getLocaleFallbackResource","fallbackResources","then","__WEBPACK_AMD_REQUIRE_ARRAY__","$18Next","i18next","Backend","Cache","PostProcessor","LanguageDetector","use","init","error","t","tName","i18nName","handleName","selectorAttr","targetAttr","optionsAttr","useOptionsAttr","parseDefaultValueFromContent","preload","_preload_1","_resources_1","loadLanguages","i18n","catch","oe","e","path","json","ajax","url","toUrl","method","async","dataType","success","data","xhr","status","makeErrorInfo","ERROR_CDP_I18N_INITIALIZE_FAILED","global","jqueryI18next","_extends","assign","target","arguments","length","source","key","defaults","parse","ele","opts","attr","indexOf","parts","split","substr","extendDefault","val","defaultValue","html","text","prepend","append","dataAttr","translated","localize","targetSelector","find","keys","each","k","trim","clone","handle","elements","bind","fn","index","_typeof","Symbol","iterator","obj","constructor","classCallCheck","instance","Constructor","TypeError","inherits","subClass","superClass","create","value","writable","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_i","_s","next","done","push","err","Array","isArray","toConsumableArray","arr2","from","consoleLogger","type","log","args","output","warn","_console","console","Logger","concreteLogger","prefix","logger","debug","setDebug","bool","_len","_key","forward","_len2","_key2","_len3","_key3","deprecate","_len4","_key4","lvl","debugOnly","moduleName","baseLogger","EventEmitter","observers","on","events","listener","_this","forEach","event","off","_this2","splice","emit","cloned","concat","observer","_cloned","_ref","makeString","copy","a","getLastOfPath","Empty","cleanKey","replace","canNotTraverseDeeper","stack","shift","setPath","newValue","_getLastOfPath","pushPath","_getLastOfPath2","getPath","_getLastOfPath3","deepExtend","overwrite","prop","String","regexEscape","str","_entityMap","&","<",">","\"","'","/","escape","ResourceStore","_EventEmitter","defaultNS","addNamespaces","removeNamespaces","getResource","keySeparator","addResource","silent","addResources","addResourceBundle","deep","pack","removeResourceBundle","hasResourceBundle","getResourceBundle","compatibilityAPI","toJSON","postProcessor","processors","addPostProcessor","translator","processor","process","Translator","services","changeLanguage","language","exists","interpolation","resolved","res","extractFromKey","nsSeparator","namespaces","join","translate","overloadTranslationOptionHandler","_extractFromKey","namespace","appendNamespaceToCIMode","toLowerCase","usedKey","resType","toString","noObject","joinArrays","returnObjects","returnedObjectHandler","copy$$1","extendTranslation","usedDefault","_usedKey","isValidLookup","lngs","fallbackLngs","languageUtils","getFallbackCodes","fallbackLng","saveMissingTo","toResolveHierarchy","saveMissing","missingKeyHandler","backendConnector","appendNamespaceToMissingKey","parseMissingKeyHandler","interpolator","defaultVariables","interpolate","nest","reset","postProcess","postProcessorNames","applyPostProcessor","_this3","found","extracted","fallbackNS","needsPluralHandling","count","needsContextHandling","context","codes","code","finalKey","finalKeys","pluralSuffix","pluralResolver","getSuffix","contextSeparator","possibleKey","pop","returnNull","returnEmptyString","resourceStore","capitalize","string","charAt","toUpperCase","slice","LanguageUtil","whitelist","getScriptPartFromCode","formatLanguageCode","getLanguagePartFromCode","specialCases","lowerCaseLng","map","part","cleanCode","isWhitelisted","load","nonExplicitWhitelist","fallbacks","default","fallbackCode","fallbackCodes","addCode","fc","sets","nr","_rulesPluralsTypes","1","_","Number","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","createRules","rules","set$$1","numbers","plurals","PluralResolver","addRule","getRule","needsPlural","rule","idx","noAbs","Math","abs","suffix","simplifyPluralSuffix","returnSuffix","compatibilityJSON","Interpolator","format","escapeValue","iOpts","prefixEscaped","suffixEscaped","formatSeparator","unescapePrefix","unescapeSuffix","nestingPrefix","nestingPrefixEscaped","nestingSuffix","nestingSuffixEscaped","maxReplaces","resetRegExp","regexpStr","regexp","RegExp","regexpUnescapeStr","regexpUnescape","nestingRegexpStr","nestingRegexp","match","replaces","regexSafe","handleFormat","f","exec","lastIndex","clonedOptions","handleHasOptions","optionsString","JSON","remove","what","Connector","backend","store","state","queue","queueLoad","languages","callback","toLoad","pending","toLoadLanguages","toLoadNamespaces","hasAllNamespaces","loaded","errors","_name$split","_name$split2","q","filter","read","fcName","tried","_this4","wait","setTimeout","_this5","allowMultiLoading","readMulti","_name$split3","_name$split4","bundle","loadOne","reload","_this6","_this7","_name$split5","_name$split6","fallbackValue","Connector$1","cache","loadLngs","enabled","save","get$1","initImmediate","pluralSeparator","_format","transformOptions","noop","I18n","external","isInitialized","isClone","_ret","createClassOnDemand","ClassOrObject","lu","cacheConnector","languageDetector","detection","storeApi","_store","loadResources","reloadResources","setLng","cacheUserLanguage","detect","getFixedT","fixedT","_translator","_translator2","setDefaultNamespace","loadNamespaces","preloaded","newLngs","dir","rtlLngs","createInstance","cloneInstance","mergedOptions","membersToCopy","i18nextXHRBackend","addQueryString","params","queryString","encodeURIComponent","paramName","Date","queryStringParams","x","XMLHttpRequest","ActiveXObject","open","crossDomain","setRequestHeader","withCredentials","overrideMimeType","h","customHeaders","onreadystatechange","readyState","responseText","send","_createClass","defineProperties","props","descriptor","protoProps","staticProps","_classCallCheck","getDefaults","loadPath","addPath","loadUrl","ret","payload","i18nextLocalStorageCache","debounce","func","immediate","timeout","later","callNow","clearTimeout","storage","setItem","window","localStorage","getItem","expirationTime","versions","debouncedStore","nowMS","getTime","todo","local","i18nStamp","i18nVersion","storeParam","stringify","i18nextSprintfPostProcessor","babelHelpers","typeof","re","not_string","number","not_json","modulo","placeholder","key_access","index_access","sign","sprintf","parse_tree","argv","cursor","tree_length","node_type","arg","pad","pad_character","pad_length","is_positive","get_type","Error","test","isNaN","fromCharCode","parseInt","toExponential","parseFloat","toFixed","toPrecision","substring","str_repeat","fmt","_fmt","arg_names","field_list","replacement_field","field_match","SyntaxError","vsprintf","_argv","variable","input","multiplier","values","i18nextBrowserLanguageDetector","createClass","cookie","minutes","domain","expires","date","setTime","toGMTString","document","nameEQ","ca","cookie$1","lookup","lookupCookie","cookieMinutes","cookieDomain","querystring","query","location","search","pos","lookupQuerystring","hasLocalStorageSupport","testKey","removeItem","lookupLocalStorage","navigator$1","navigator","userLanguage","htmlTag","documentElement","getAttribute","order","caches","excludeCacheFor","Browser","detectors","i18nOptions","addDetector","detector","detectionOrder","detected","detectorName","cleanedLng","cacheName"],"mappings":"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","sourcesContent":["/*!\n * cdp.i18n.js 2.0.0\n *\n * Date: 2017-10-27T06:12:35.658Z\n */\n\n(function webpackUniversalModuleDefinition(root, factory) {\n    if(typeof exports === 'object' && typeof module === 'object')\n        module.exports = factory(require(\"jquery\"), require(\"cdp.core\"), require(\"cdp.promise\"));\n    else if(typeof define === 'function' && define.amd)\n        define([\"jquery\", \"cdp.core\", \"cdp.promise\"], factory);\n    else if(typeof exports === 'object')\n        exports[\"CDP\"] = factory(require(\"jquery\"), require(\"cdp.core\"), require(\"cdp.promise\"));\n    else\n        root[\"CDP\"] = factory(root[\"jQuery\"], root[\"CDP\"], root[\"CDP\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/     // The module cache\n/******/     var installedModules = {};\n/******/\n/******/     // The require function\n/******/     function __webpack_require__(moduleId) {\n/******/\n/******/         // Check if module is in cache\n/******/         if(installedModules[moduleId]) {\n/******/             return installedModules[moduleId].exports;\n/******/         }\n/******/         // Create a new module (and put it into the cache)\n/******/         var module = installedModules[moduleId] = {\n/******/             i: moduleId,\n/******/             l: false,\n/******/             exports: {}\n/******/         };\n/******/\n/******/         // Execute the module function\n/******/         modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/         // Flag the module as loaded\n/******/         module.l = true;\n/******/\n/******/         // Return the exports of the module\n/******/         return module.exports;\n/******/     }\n/******/\n/******/\n/******/     // expose the modules object (__webpack_modules__)\n/******/     __webpack_require__.m = modules;\n/******/\n/******/     // expose the module cache\n/******/     __webpack_require__.c = installedModules;\n/******/\n/******/     // define getter function for harmony exports\n/******/     __webpack_require__.d = function(exports, name, getter) {\n/******/         if(!__webpack_require__.o(exports, name)) {\n/******/             Object.defineProperty(exports, name, {\n/******/                 configurable: false,\n/******/                 enumerable: true,\n/******/                 get: getter\n/******/             });\n/******/         }\n/******/     };\n/******/\n/******/     // getDefaultExport function for compatibility with non-harmony modules\n/******/     __webpack_require__.n = function(module) {\n/******/         var getter = module && module.__esModule ?\n/******/             function getDefault() { return module['default']; } :\n/******/             function getModuleExports() { return module; };\n/******/         __webpack_require__.d(getter, 'a', getter);\n/******/         return getter;\n/******/     };\n/******/\n/******/     // Object.prototype.hasOwnProperty.call\n/******/     __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/     // __webpack_public_path__\n/******/     __webpack_require__.p = \"\";\n/******/\n/******/     // Load entry module and return exports\n/******/     return __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (root, factory) { if (true) { !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1), __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function ($, CDP) { return factory($, CDP); }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n                __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)); } else { factory(root.jQuery || root.$, root.CDP || (root.CDP = {})); } }(this, function ($, CDP) {\nvar CDP;\n(function (CDP) {\n    // @internal Error code offset definition of `cdp-i18n`.\n    var RESULT_CODE_BASE;\n    (function (RESULT_CODE_BASE) {\n        RESULT_CODE_BASE[RESULT_CODE_BASE[\"CDP_I18N_DECLARERATION\"] = 0] = \"CDP_I18N_DECLARERATION\";\n        RESULT_CODE_BASE[RESULT_CODE_BASE[\"CDP_I18N\"] = 3 * CDP._MODULE_RESULT_CODE_RANGE_CDP] = \"CDP_I18N\";\n    })(RESULT_CODE_BASE = CDP.RESULT_CODE_BASE || (CDP.RESULT_CODE_BASE = {}));\n    ///////////////////////////////////////////////////////////////////////\n    // module error declaration:\n    // @internal cdp.i18n \n    var LOCAL_CODE_BASE;\n    (function (LOCAL_CODE_BASE) {\n        LOCAL_CODE_BASE[LOCAL_CODE_BASE[\"I18N\"] = 0] = \"I18N\";\n    })(LOCAL_CODE_BASE || (LOCAL_CODE_BASE = {}));\n    /* tslint:disable:max-line-length */\n    // Error code definition of `cdp-i18n`.\n    var RESULT_CODE;\n    (function (RESULT_CODE) {\n        RESULT_CODE[RESULT_CODE[\"ERROR_CDP_I18N_DECLARATION\"] = 0] = \"ERROR_CDP_I18N_DECLARATION\";\n        /** `en` [[CDP.initializeI18N]]() failer code. <br> `ja` [[CDP.initializeI18N]]()  */\n        RESULT_CODE[RESULT_CODE[\"ERROR_CDP_I18N_INITIALIZE_FAILED\"] = CDP.DECLARE_ERROR_CODE(RESULT_CODE_BASE.CDP_I18N, LOCAL_CODE_BASE.I18N + 1, \"i18n initialize failed.\")] = \"ERROR_CDP_I18N_INITIALIZE_FAILED\";\n    })(RESULT_CODE = CDP.RESULT_CODE || (CDP.RESULT_CODE = {}));\n    /* tslint:enable:max-line-length */\n})(CDP || (CDP = {}));\n\n/* tslint:disable:max-line-length */\nvar CDP;\n(function (CDP) {\n    var Promise = CDP.Promise;\n    var TAG = \"[CDP.i18n] \";\n    /**\n     * @en initialize i18next. <br>\n     *     It'll be usually called from framework.\n     * @ja i18next  <br>\n     *      Framework \n     */\n    function initializeI18N(settings) {\n        return new Promise(function (resolve, reject) {\n            var i18nSettings = settings || {};\n            i18nSettings.options = i18nSettings.options || {};\n            try {\n                var i18nOptions_1 = (function (resources) {\n                    if (resources) {\n                        for (var lng in resources) {\n                            if (resources.hasOwnProperty(lng)) {\n                                for (var ns in resources[lng]) {\n                                    if (resources[lng].hasOwnProperty(ns)) {\n                                        resources[lng][ns] = getLocaleFallbackResource(resources[lng][ns]);\n                                    }\n                                }\n                            }\n                        }\n                        i18nSettings.options.resources = resources;\n                        return i18nSettings.options;\n                    }\n                    else {\n                        return i18nSettings.options;\n                    }\n                })(i18nSettings.fallbackResources);\n                new Promise(function(resolve) { resolve(); }).then(function() { var __WEBPACK_AMD_REQUIRE_ARRAY__ = [__webpack_require__(4)]; (function ($18Next) {\n                    new Promise(function(resolve) { resolve(); }).then(function() { var __WEBPACK_AMD_REQUIRE_ARRAY__ = [\n                        __webpack_require__(5),\n                        __webpack_require__(6),\n                        __webpack_require__(7),\n                        __webpack_require__(8),\n                        __webpack_require__(9),\n                    ]; (function (i18next, Backend, Cache, PostProcessor, LanguageDetector) {\n                        i18next\n                            .use(Backend)\n                            .use(Cache)\n                            .use(PostProcessor)\n                            .use(LanguageDetector)\n                            .init(i18nOptions_1, function (error, t) {\n                            $18Next.init(i18next, $, {\n                                tName: \"t\",\n                                i18nName: \"i18n\",\n                                handleName: \"localize\",\n                                selectorAttr: \"data-i18n\",\n                                targetAttr: \"i18n-target\",\n                                optionsAttr: \"i18n-options\",\n                                useOptionsAttr: false,\n                                parseDefaultValueFromContent: true // parses default values from content ele.val or ele.text\n                            });\n                            // i18next 3.4.1: resources  preload .\n                            if (i18next.options.resources && i18next.options.preload) {\n                                // options .\n                                var _preload_1 = i18next.options.preload;\n                                var _resources_1 = i18next.options.resources;\n                                delete i18next.options.resources;\n                                delete i18next.options.preload;\n                                i18next.loadLanguages(_preload_1, function () {\n                                    // options \n                                    i18next.options.resources = _resources_1;\n                                    i18next.options.preload = _preload_1;\n                                    CDP.i18n = i18next;\n                                    resolve();\n                                });\n                            }\n                            else {\n                                CDP.i18n = i18next;\n                                resolve();\n                            }\n                        });\n                    }.apply(null, __WEBPACK_AMD_REQUIRE_ARRAY__));}).catch(__webpack_require__.oe);\n                }.apply(null, __WEBPACK_AMD_REQUIRE_ARRAY__));}).catch(__webpack_require__.oe);\n            }\n            catch (e) {\n                return reject(e);\n            }\n        });\n    }\n    CDP.initializeI18N = initializeI18N;\n    /**\n     * @es get string resource for fallback.\n     * @js Fallback \n     *\n     * @internal\n     * @returns\n     *   - `en` fallback resource object\n     *   - `ja` fallback \n     */\n    function getLocaleFallbackResource(path) {\n        var json;\n        var error;\n        $.ajax({\n            url: CDP.toUrl(path),\n            method: \"GET\",\n            async: false,\n            dataType: \"json\",\n            success: function (data) {\n                json = data;\n            },\n            error: function (xhr, status) {\n                error = CDP.makeErrorInfo(CDP.RESULT_CODE.ERROR_CDP_I18N_INITIALIZE_FAILED, TAG, \"ajax request failed. status: \" + status);\n            }\n        });\n        if (null != error) {\n            throw error;\n        }\n        return json;\n    }\n})(CDP || (CDP = {}));\n\nreturn CDP; }));\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function (global, factory) {\n   true ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.jqueryI18next = factory());\n}(this, (function () { 'use strict';\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar defaults = {\n  tName: 't',\n  i18nName: 'i18n',\n  handleName: 'localize',\n  selectorAttr: 'data-i18n',\n  targetAttr: 'i18n-target',\n  optionsAttr: 'i18n-options',\n  useOptionsAttr: false,\n  parseDefaultValueFromContent: true\n};\n\nfunction init(i18next, $) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\n  options = _extends({}, defaults, options);\n\n  function parse(ele, key, opts) {\n    if (key.length === 0) return;\n\n    var attr = 'text';\n\n    if (key.indexOf('[') === 0) {\n      var parts = key.split(']');\n      key = parts[1];\n      attr = parts[0].substr(1, parts[0].length - 1);\n    }\n\n    if (key.indexOf(';') === key.length - 1) {\n      key = key.substr(0, key.length - 2);\n    }\n\n    function extendDefault(o, val) {\n      if (!options.parseDefaultValueFromContent) return o;\n      return _extends({}, o, { defaultValue: val });\n    }\n\n    if (attr === 'html') {\n      ele.html(i18next.t(key, extendDefault(opts, ele.html())));\n    } else if (attr === 'text') {\n      ele.text(i18next.t(key, extendDefault(opts, ele.text())));\n    } else if (attr === 'prepend') {\n      ele.prepend(i18next.t(key, extendDefault(opts, ele.html())));\n    } else if (attr === 'append') {\n      ele.append(i18next.t(key, extendDefault(opts, ele.html())));\n    } else if (attr.indexOf('data-') === 0) {\n      var dataAttr = attr.substr('data-'.length);\n      var translated = i18next.t(key, extendDefault(opts, ele.data(dataAttr)));\n\n      // we change into the data cache\n      ele.data(dataAttr, translated);\n      // we change into the dom\n      ele.attr(attr, translated);\n    } else {\n      ele.attr(attr, i18next.t(key, extendDefault(opts, ele.attr(attr))));\n    }\n  }\n\n  function localize(ele, opts) {\n    var key = ele.attr(options.selectorAttr);\n    if (!key && typeof key !== 'undefined' && key !== false) key = ele.text() || ele.val();\n    if (!key) return;\n\n    var target = ele,\n        targetSelector = ele.data(options.targetAttr);\n\n    if (targetSelector) target = ele.find(targetSelector) || ele;\n\n    if (!opts && options.useOptionsAttr === true) opts = ele.data(options.optionsAttr);\n\n    opts = opts || {};\n\n    if (key.indexOf(';') >= 0) {\n      var keys = key.split(';');\n\n      $.each(keys, function (m, k) {\n        // .trim(): Trim the comma-separated parameters on the data-i18n attribute.\n        if (k !== '') parse(target, k.trim(), opts);\n      });\n    } else {\n      parse(target, key, opts);\n    }\n\n    if (options.useOptionsAttr === true) {\n      var clone = {};\n      clone = _extends({ clone: clone }, opts);\n\n      delete clone.lng;\n      ele.data(options.optionsAttr, clone);\n    }\n  }\n\n  function handle(opts) {\n    return this.each(function () {\n      // localize element itself\n      localize($(this), opts);\n\n      // localize children\n      var elements = $(this).find('[' + options.selectorAttr + ']');\n      elements.each(function () {\n        localize($(this), opts);\n      });\n    });\n  };\n\n  // $.t $.i18n shortcut\n  $[options.tName] = i18next.t.bind(i18next);\n  $[options.i18nName] = i18next;\n\n  // selector function $(mySelector).localize(opts);\n  $.fn[options.handleName] = handle;\n}\n\nvar index = {\n  init: init\n};\n\nreturn index;\n\n})));\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function (global, factory) {\n     true ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global.i18next = factory());\n}(this, (function () { 'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n\n\n\n\n\n\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n\n\n\nvar slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\nvar consoleLogger = {\n  type: 'logger',\n\n  log: function log(args) {\n    this.output('log', args);\n  },\n  warn: function warn(args) {\n    this.output('warn', args);\n  },\n  error: function error(args) {\n    this.output('error', args);\n  },\n  output: function output(type, args) {\n    var _console;\n\n    /* eslint no-console: 0 */\n    if (console && console[type]) (_console = console)[type].apply(_console, toConsumableArray(args));\n  }\n};\n\nvar Logger = function () {\n  function Logger(concreteLogger) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    classCallCheck(this, Logger);\n\n    this.init(concreteLogger, options);\n  }\n\n  Logger.prototype.init = function init(concreteLogger) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    this.prefix = options.prefix || 'i18next:';\n    this.logger = concreteLogger || consoleLogger;\n    this.options = options;\n    this.debug = options.debug;\n  };\n\n  Logger.prototype.setDebug = function setDebug(bool) {\n    this.debug = bool;\n  };\n\n  Logger.prototype.log = function log() {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return this.forward(args, 'log', '', true);\n  };\n\n  Logger.prototype.warn = function warn() {\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return this.forward(args, 'warn', '', true);\n  };\n\n  Logger.prototype.error = function error() {\n    for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    return this.forward(args, 'error', '');\n  };\n\n  Logger.prototype.deprecate = function deprecate() {\n    for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    return this.forward(args, 'warn', 'WARNING DEPRECATED: ', true);\n  };\n\n  Logger.prototype.forward = function forward(args, lvl, prefix, debugOnly) {\n    if (debugOnly && !this.debug) return null;\n    if (typeof args[0] === 'string') args[0] = '' + prefix + this.prefix + ' ' + args[0];\n    return this.logger[lvl](args);\n  };\n\n  Logger.prototype.create = function create(moduleName) {\n    return new Logger(this.logger, _extends({ prefix: this.prefix + ':' + moduleName + ':' }, this.options));\n  };\n\n  return Logger;\n}();\n\nvar baseLogger = new Logger();\n\nvar EventEmitter = function () {\n  function EventEmitter() {\n    classCallCheck(this, EventEmitter);\n\n    this.observers = {};\n  }\n\n  EventEmitter.prototype.on = function on(events, listener) {\n    var _this = this;\n\n    events.split(' ').forEach(function (event) {\n      _this.observers[event] = _this.observers[event] || [];\n      _this.observers[event].push(listener);\n    });\n  };\n\n  EventEmitter.prototype.off = function off(event, listener) {\n    var _this2 = this;\n\n    if (!this.observers[event]) {\n      return;\n    }\n\n    this.observers[event].forEach(function () {\n      if (!listener) {\n        delete _this2.observers[event];\n      } else {\n        var index = _this2.observers[event].indexOf(listener);\n        if (index > -1) {\n          _this2.observers[event].splice(index, 1);\n        }\n      }\n    });\n  };\n\n  EventEmitter.prototype.emit = function emit(event) {\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (this.observers[event]) {\n      var cloned = [].concat(this.observers[event]);\n      cloned.forEach(function (observer) {\n        observer.apply(undefined, args);\n      });\n    }\n\n    if (this.observers['*']) {\n      var _cloned = [].concat(this.observers['*']);\n      _cloned.forEach(function (observer) {\n        var _ref;\n\n        observer.apply(observer, (_ref = [event]).concat.apply(_ref, args));\n      });\n    }\n  };\n\n  return EventEmitter;\n}();\n\nfunction makeString(object) {\n  if (object == null) return '';\n  /* eslint prefer-template: 0 */\n  return '' + object;\n}\n\nfunction copy(a, s, t) {\n  a.forEach(function (m) {\n    if (s[m]) t[m] = s[m];\n  });\n}\n\nfunction getLastOfPath(object, path, Empty) {\n  function cleanKey(key) {\n    return key && key.indexOf('###') > -1 ? key.replace(/###/g, '.') : key;\n  }\n\n  function canNotTraverseDeeper() {\n    return !object || typeof object === 'string';\n  }\n\n  var stack = typeof path !== 'string' ? [].concat(path) : path.split('.');\n  while (stack.length > 1) {\n    if (canNotTraverseDeeper()) return {};\n\n    var key = cleanKey(stack.shift());\n    if (!object[key] && Empty) object[key] = new Empty();\n    object = object[key];\n  }\n\n  if (canNotTraverseDeeper()) return {};\n  return {\n    obj: object,\n    k: cleanKey(stack.shift())\n  };\n}\n\nfunction setPath(object, path, newValue) {\n  var _getLastOfPath = getLastOfPath(object, path, Object),\n      obj = _getLastOfPath.obj,\n      k = _getLastOfPath.k;\n\n  obj[k] = newValue;\n}\n\nfunction pushPath(object, path, newValue, concat) {\n  var _getLastOfPath2 = getLastOfPath(object, path, Object),\n      obj = _getLastOfPath2.obj,\n      k = _getLastOfPath2.k;\n\n  obj[k] = obj[k] || [];\n  if (concat) obj[k] = obj[k].concat(newValue);\n  if (!concat) obj[k].push(newValue);\n}\n\nfunction getPath(object, path) {\n  var _getLastOfPath3 = getLastOfPath(object, path),\n      obj = _getLastOfPath3.obj,\n      k = _getLastOfPath3.k;\n\n  if (!obj) return undefined;\n  return obj[k];\n}\n\nfunction deepExtend(target, source, overwrite) {\n  /* eslint no-restricted-syntax: 0 */\n  for (var prop in source) {\n    if (prop in target) {\n      // If we reached a leaf string in target or source then replace with source or skip depending on the 'overwrite' switch\n      if (typeof target[prop] === 'string' || target[prop] instanceof String || typeof source[prop] === 'string' || source[prop] instanceof String) {\n        if (overwrite) target[prop] = source[prop];\n      } else {\n        deepExtend(target[prop], source[prop], overwrite);\n      }\n    } else {\n      target[prop] = source[prop];\n    }\n  }\n  return target;\n}\n\nfunction regexEscape(str) {\n  /* eslint no-useless-escape: 0 */\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\n\n/* eslint-disable */\nvar _entityMap = {\n  \"&\": \"&amp;\",\n  \"<\": \"&lt;\",\n  \">\": \"&gt;\",\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  \"/\": '&#x2F;'\n};\n/* eslint-enable */\n\nfunction escape(data) {\n  if (typeof data === 'string') {\n    return data.replace(/[&<>\"'\\/]/g, function (s) {\n      return _entityMap[s];\n    });\n  }\n\n  return data;\n}\n\nvar ResourceStore = function (_EventEmitter) {\n  inherits(ResourceStore, _EventEmitter);\n\n  function ResourceStore(data) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { ns: ['translation'], defaultNS: 'translation' };\n    classCallCheck(this, ResourceStore);\n\n    var _this = possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    _this.data = data || {};\n    _this.options = options;\n    return _this;\n  }\n\n  ResourceStore.prototype.addNamespaces = function addNamespaces(ns) {\n    if (this.options.ns.indexOf(ns) < 0) {\n      this.options.ns.push(ns);\n    }\n  };\n\n  ResourceStore.prototype.removeNamespaces = function removeNamespaces(ns) {\n    var index = this.options.ns.indexOf(ns);\n    if (index > -1) {\n      this.options.ns.splice(index, 1);\n    }\n  };\n\n  ResourceStore.prototype.getResource = function getResource(lng, ns, key) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    var keySeparator = options.keySeparator || this.options.keySeparator;\n    if (keySeparator === undefined) keySeparator = '.';\n\n    var path = [lng, ns];\n    if (key && typeof key !== 'string') path = path.concat(key);\n    if (key && typeof key === 'string') path = path.concat(keySeparator ? key.split(keySeparator) : key);\n\n    if (lng.indexOf('.') > -1) {\n      path = lng.split('.');\n    }\n\n    return getPath(this.data, path);\n  };\n\n  ResourceStore.prototype.addResource = function addResource(lng, ns, key, value) {\n    var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : { silent: false };\n\n    var keySeparator = this.options.keySeparator;\n    if (keySeparator === undefined) keySeparator = '.';\n\n    var path = [lng, ns];\n    if (key) path = path.concat(keySeparator ? key.split(keySeparator) : key);\n\n    if (lng.indexOf('.') > -1) {\n      path = lng.split('.');\n      value = ns;\n      ns = path[1];\n    }\n\n    this.addNamespaces(ns);\n\n    setPath(this.data, path, value);\n\n    if (!options.silent) this.emit('added', lng, ns, key, value);\n  };\n\n  ResourceStore.prototype.addResources = function addResources(lng, ns, resources) {\n    /* eslint no-restricted-syntax: 0 */\n    for (var m in resources) {\n      if (typeof resources[m] === 'string') this.addResource(lng, ns, m, resources[m], { silent: true });\n    }\n    this.emit('added', lng, ns, resources);\n  };\n\n  ResourceStore.prototype.addResourceBundle = function addResourceBundle(lng, ns, resources, deep, overwrite) {\n    var path = [lng, ns];\n    if (lng.indexOf('.') > -1) {\n      path = lng.split('.');\n      deep = resources;\n      resources = ns;\n      ns = path[1];\n    }\n\n    this.addNamespaces(ns);\n\n    var pack = getPath(this.data, path) || {};\n\n    if (deep) {\n      deepExtend(pack, resources, overwrite);\n    } else {\n      pack = _extends({}, pack, resources);\n    }\n\n    setPath(this.data, path, pack);\n\n    this.emit('added', lng, ns, resources);\n  };\n\n  ResourceStore.prototype.removeResourceBundle = function removeResourceBundle(lng, ns) {\n    if (this.hasResourceBundle(lng, ns)) {\n      delete this.data[lng][ns];\n    }\n    this.removeNamespaces(ns);\n\n    this.emit('removed', lng, ns);\n  };\n\n  ResourceStore.prototype.hasResourceBundle = function hasResourceBundle(lng, ns) {\n    return this.getResource(lng, ns) !== undefined;\n  };\n\n  ResourceStore.prototype.getResourceBundle = function getResourceBundle(lng, ns) {\n    if (!ns) ns = this.options.defaultNS;\n\n    // COMPATIBILITY: remove extend in v2.1.0\n    if (this.options.compatibilityAPI === 'v1') return _extends({}, this.getResource(lng, ns));\n\n    return this.getResource(lng, ns);\n  };\n\n  ResourceStore.prototype.toJSON = function toJSON() {\n    return this.data;\n  };\n\n  return ResourceStore;\n}(EventEmitter);\n\nvar postProcessor = {\n\n  processors: {},\n\n  addPostProcessor: function addPostProcessor(module) {\n    this.processors[module.name] = module;\n  },\n  handle: function handle(processors, value, key, options, translator) {\n    var _this = this;\n\n    processors.forEach(function (processor) {\n      if (_this.processors[processor]) value = _this.processors[processor].process(value, key, options, translator);\n    });\n\n    return value;\n  }\n};\n\nvar Translator = function (_EventEmitter) {\n  inherits(Translator, _EventEmitter);\n\n  function Translator(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    classCallCheck(this, Translator);\n\n    var _this = possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector'], services, _this);\n\n    _this.options = options;\n    _this.logger = baseLogger.create('translator');\n    return _this;\n  }\n\n  Translator.prototype.changeLanguage = function changeLanguage(lng) {\n    if (lng) this.language = lng;\n  };\n\n  Translator.prototype.exists = function exists(key) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { interpolation: {} };\n\n    var resolved = this.resolve(key, options);\n    return resolved && resolved.res !== undefined;\n  };\n\n  Translator.prototype.extractFromKey = function extractFromKey(key, options) {\n    var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n    if (nsSeparator === undefined) nsSeparator = ':';\n    var keySeparator = options.keySeparator || this.options.keySeparator || '.';\n\n    var namespaces = options.ns || this.options.defaultNS;\n    if (nsSeparator && key.indexOf(nsSeparator) > -1) {\n      var parts = key.split(nsSeparator);\n      if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n      key = parts.join(keySeparator);\n    }\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n\n    return {\n      key: key,\n      namespaces: namespaces\n    };\n  };\n\n  Translator.prototype.translate = function translate(keys) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {\n      /* eslint prefer-rest-params: 0 */\n      options = this.options.overloadTranslationOptionHandler(arguments);\n    }\n\n    // non valid keys handling\n    if (keys === undefined || keys === null || keys === '') return '';\n    if (typeof keys === 'number') keys = String(keys);\n    if (typeof keys === 'string') keys = [keys];\n\n    // separators\n    var keySeparator = options.keySeparator || this.options.keySeparator || '.';\n\n    // get namespace(s)\n\n    var _extractFromKey = this.extractFromKey(keys[keys.length - 1], options),\n        key = _extractFromKey.key,\n        namespaces = _extractFromKey.namespaces;\n\n    var namespace = namespaces[namespaces.length - 1];\n\n    // return key on CIMode\n    var lng = options.lng || this.language;\n    var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n    if (lng && lng.toLowerCase() === 'cimode') {\n      if (appendNamespaceToCIMode) {\n        var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n        return namespace + nsSeparator + key;\n      }\n\n      return key;\n    }\n\n    // resolve from store\n    var resolved = this.resolve(keys, options);\n    var res = resolved && resolved.res;\n    var usedKey = resolved && resolved.usedKey || key;\n\n    var resType = Object.prototype.toString.apply(res);\n    var noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n    var joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays;\n\n    // object\n    if (res && typeof res !== 'string' && noObject.indexOf(resType) < 0 && !(joinArrays && resType === '[object Array]')) {\n      if (!options.returnObjects && !this.options.returnObjects) {\n        this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n        return this.options.returnedObjectHandler ? this.options.returnedObjectHandler(usedKey, res, options) : 'key \\'' + key + ' (' + this.language + ')\\' returned an object instead of string.';\n      }\n\n      // if we got a separator we loop over children - else we just return object as is\n      // as having it set to false means no hierarchy so no lookup for nested values\n      if (options.keySeparator || this.options.keySeparator) {\n        var copy$$1 = resType === '[object Array]' ? [] : {}; // apply child translation on a copy\n\n        /* eslint no-restricted-syntax: 0 */\n        for (var m in res) {\n          if (Object.prototype.hasOwnProperty.call(res, m)) {\n            copy$$1[m] = this.translate('' + usedKey + keySeparator + m, _extends({}, options, { joinArrays: false, ns: namespaces }));\n          }\n        }\n        res = copy$$1;\n      }\n    } else if (joinArrays && resType === '[object Array]') {\n      // array special treatment\n      res = res.join(joinArrays);\n      if (res) res = this.extendTranslation(res, keys, options);\n    } else {\n      // string, empty or null\n      var usedDefault = false;\n      var _usedKey = false;\n\n      // fallback value\n      if (!this.isValidLookup(res) && options.defaultValue !== undefined) {\n        usedDefault = true;\n        res = options.defaultValue;\n      }\n      if (!this.isValidLookup(res)) {\n        _usedKey = true;\n        res = key;\n      }\n\n      // save missing\n      if (_usedKey || usedDefault) {\n        this.logger.log('missingKey', lng, namespace, key, res);\n\n        var lngs = [];\n        var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n        if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n          for (var i = 0; i < fallbackLngs.length; i++) {\n            lngs.push(fallbackLngs[i]);\n          }\n        } else if (this.options.saveMissingTo === 'all') {\n          lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n        } else {\n          lngs.push(options.lng || this.language);\n        }\n\n        if (this.options.saveMissing) {\n          if (this.options.missingKeyHandler) {\n            this.options.missingKeyHandler(lngs, namespace, key, res);\n          } else if (this.backendConnector && this.backendConnector.saveMissing) {\n            this.backendConnector.saveMissing(lngs, namespace, key, res);\n          }\n        }\n\n        this.emit('missingKey', lngs, namespace, key, res);\n      }\n\n      // extend\n      res = this.extendTranslation(res, keys, options);\n\n      // append namespace if still key\n      if (_usedKey && res === key && this.options.appendNamespaceToMissingKey) res = namespace + ':' + key;\n\n      // parseMissingKeyHandler\n      if (_usedKey && this.options.parseMissingKeyHandler) res = this.options.parseMissingKeyHandler(res);\n    }\n\n    // return\n    return res;\n  };\n\n  Translator.prototype.extendTranslation = function extendTranslation(res, key, options) {\n    var _this2 = this;\n\n    if (options.interpolation) this.interpolator.init(_extends({}, options, { interpolation: _extends({}, this.options.interpolation, options.interpolation) }));\n\n    // interpolate\n    var data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n    if (this.options.interpolation.defaultVariables) data = _extends({}, this.options.interpolation.defaultVariables, data);\n    res = this.interpolator.interpolate(res, data, options.lng || this.language);\n\n    // nesting\n    if (options.nest !== false) res = this.interpolator.nest(res, function () {\n      return _this2.translate.apply(_this2, arguments);\n    }, options);\n\n    if (options.interpolation) this.interpolator.reset();\n\n    // post process\n    var postProcess = options.postProcess || this.options.postProcess;\n    var postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n\n    if (res !== undefined && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n      res = postProcessor.handle(postProcessorNames, res, key, options, this);\n    }\n\n    return res;\n  };\n\n  Translator.prototype.resolve = function resolve(keys) {\n    var _this3 = this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var found = void 0;\n    var usedKey = void 0;\n\n    if (typeof keys === 'string') keys = [keys];\n\n    // forEach possible key\n    keys.forEach(function (k) {\n      if (_this3.isValidLookup(found)) return;\n      var extracted = _this3.extractFromKey(k, options);\n      var key = extracted.key;\n      usedKey = key;\n      var namespaces = extracted.namespaces;\n      if (_this3.options.fallbackNS) namespaces = namespaces.concat(_this3.options.fallbackNS);\n\n      var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n      var needsContextHandling = options.context !== undefined && typeof options.context === 'string' && options.context !== '';\n\n      var codes = options.lngs ? options.lngs : _this3.languageUtils.toResolveHierarchy(options.lng || _this3.language);\n\n      namespaces.forEach(function (ns) {\n        if (_this3.isValidLookup(found)) return;\n\n        codes.forEach(function (code) {\n          if (_this3.isValidLookup(found)) return;\n\n          var finalKey = key;\n          var finalKeys = [finalKey];\n\n          var pluralSuffix = void 0;\n          if (needsPluralHandling) pluralSuffix = _this3.pluralResolver.getSuffix(code, options.count);\n\n          // fallback for plural if context not found\n          if (needsPluralHandling && needsContextHandling) finalKeys.push(finalKey + pluralSuffix);\n\n          // get key for context if needed\n          if (needsContextHandling) finalKeys.push(finalKey += '' + _this3.options.contextSeparator + options.context);\n\n          // get key for plural if needed\n          if (needsPluralHandling) finalKeys.push(finalKey += pluralSuffix);\n\n          // iterate over finalKeys starting with most specific pluralkey (-> contextkey only) -> singularkey only\n          var possibleKey = void 0;\n          /* eslint no-cond-assign: 0 */\n          while (possibleKey = finalKeys.pop()) {\n            if (!_this3.isValidLookup(found)) {\n              found = _this3.getResource(code, ns, possibleKey, options);\n            }\n          }\n        });\n      });\n    });\n\n    return { res: found, usedKey: usedKey };\n  };\n\n  Translator.prototype.isValidLookup = function isValidLookup(res) {\n    return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n  };\n\n  Translator.prototype.getResource = function getResource(code, ns, key) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    return this.resourceStore.getResource(code, ns, key, options);\n  };\n\n  return Translator;\n}(EventEmitter);\n\nfunction capitalize(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nvar LanguageUtil = function () {\n  function LanguageUtil(options) {\n    classCallCheck(this, LanguageUtil);\n\n    this.options = options;\n\n    this.whitelist = this.options.whitelist || false;\n    this.logger = baseLogger.create('languageUtils');\n  }\n\n  LanguageUtil.prototype.getScriptPartFromCode = function getScriptPartFromCode(code) {\n    if (!code || code.indexOf('-') < 0) return null;\n\n    var p = code.split('-');\n    if (p.length === 2) return null;\n    p.pop();\n    return this.formatLanguageCode(p.join('-'));\n  };\n\n  LanguageUtil.prototype.getLanguagePartFromCode = function getLanguagePartFromCode(code) {\n    if (!code || code.indexOf('-') < 0) return code;\n\n    var p = code.split('-');\n    return this.formatLanguageCode(p[0]);\n  };\n\n  LanguageUtil.prototype.formatLanguageCode = function formatLanguageCode(code) {\n    // http://www.iana.org/assignments/language-tags/language-tags.xhtml\n    if (typeof code === 'string' && code.indexOf('-') > -1) {\n      var specialCases = ['hans', 'hant', 'latn', 'cyrl', 'cans', 'mong', 'arab'];\n      var p = code.split('-');\n\n      if (this.options.lowerCaseLng) {\n        p = p.map(function (part) {\n          return part.toLowerCase();\n        });\n      } else if (p.length === 2) {\n        p[0] = p[0].toLowerCase();\n        p[1] = p[1].toUpperCase();\n\n        if (specialCases.indexOf(p[1].toLowerCase()) > -1) p[1] = capitalize(p[1].toLowerCase());\n      } else if (p.length === 3) {\n        p[0] = p[0].toLowerCase();\n\n        // if lenght 2 guess it's a country\n        if (p[1].length === 2) p[1] = p[1].toUpperCase();\n        if (p[0] !== 'sgn' && p[2].length === 2) p[2] = p[2].toUpperCase();\n\n        if (specialCases.indexOf(p[1].toLowerCase()) > -1) p[1] = capitalize(p[1].toLowerCase());\n        if (specialCases.indexOf(p[2].toLowerCase()) > -1) p[2] = capitalize(p[2].toLowerCase());\n      }\n\n      return p.join('-');\n    }\n\n    return this.options.cleanCode || this.options.lowerCaseLng ? code.toLowerCase() : code;\n  };\n\n  LanguageUtil.prototype.isWhitelisted = function isWhitelisted(code) {\n    if (this.options.load === 'languageOnly' || this.options.nonExplicitWhitelist) {\n      code = this.getLanguagePartFromCode(code);\n    }\n    return !this.whitelist || !this.whitelist.length || this.whitelist.indexOf(code) > -1;\n  };\n\n  LanguageUtil.prototype.getFallbackCodes = function getFallbackCodes(fallbacks, code) {\n    if (!fallbacks) return [];\n    if (typeof fallbacks === 'string') fallbacks = [fallbacks];\n    if (Object.prototype.toString.apply(fallbacks) === '[object Array]') return fallbacks;\n\n    if (!code) return fallbacks.default || [];\n\n    // asume we have an object defining fallbacks\n    var found = fallbacks[code];\n    if (!found) found = fallbacks[this.getScriptPartFromCode(code)];\n    if (!found) found = fallbacks[this.formatLanguageCode(code)];\n    if (!found) found = fallbacks.default;\n\n    return found || [];\n  };\n\n  LanguageUtil.prototype.toResolveHierarchy = function toResolveHierarchy(code, fallbackCode) {\n    var _this = this;\n\n    var fallbackCodes = this.getFallbackCodes(fallbackCode || this.options.fallbackLng || [], code);\n\n    var codes = [];\n    var addCode = function addCode(c) {\n      if (!c) return;\n      if (_this.isWhitelisted(c)) {\n        codes.push(c);\n      } else {\n        _this.logger.warn('rejecting non-whitelisted language code: ' + c);\n      }\n    };\n\n    if (typeof code === 'string' && code.indexOf('-') > -1) {\n      if (this.options.load !== 'languageOnly') addCode(this.formatLanguageCode(code));\n      if (this.options.load !== 'languageOnly' && this.options.load !== 'currentOnly') addCode(this.getScriptPartFromCode(code));\n      if (this.options.load !== 'currentOnly') addCode(this.getLanguagePartFromCode(code));\n    } else if (typeof code === 'string') {\n      addCode(this.formatLanguageCode(code));\n    }\n\n    fallbackCodes.forEach(function (fc) {\n      if (codes.indexOf(fc) < 0) addCode(_this.formatLanguageCode(fc));\n    });\n\n    return codes;\n  };\n\n  return LanguageUtil;\n}();\n\n// definition http://translate.sourceforge.net/wiki/l10n/pluralforms\n/* eslint-disable */\nvar sets = [{ lngs: ['ach', 'ak', 'am', 'arn', 'br', 'fil', 'gun', 'ln', 'mfe', 'mg', 'mi', 'oc', 'pt', 'pt-BR', 'tg', 'ti', 'tr', 'uz', 'wa'], nr: [1, 2], fc: 1 }, { lngs: ['af', 'an', 'ast', 'az', 'bg', 'bn', 'ca', 'da', 'de', 'dev', 'el', 'en', 'eo', 'es', 'et', 'eu', 'fi', 'fo', 'fur', 'fy', 'gl', 'gu', 'ha', 'he', 'hi', 'hu', 'hy', 'ia', 'it', 'kn', 'ku', 'lb', 'mai', 'ml', 'mn', 'mr', 'nah', 'nap', 'nb', 'ne', 'nl', 'nn', 'no', 'nso', 'pa', 'pap', 'pms', 'ps', 'pt-PT', 'rm', 'sco', 'se', 'si', 'so', 'son', 'sq', 'sv', 'sw', 'ta', 'te', 'tk', 'ur', 'yo'], nr: [1, 2], fc: 2 }, { lngs: ['ay', 'bo', 'cgg', 'fa', 'id', 'ja', 'jbo', 'ka', 'kk', 'km', 'ko', 'ky', 'lo', 'ms', 'sah', 'su', 'th', 'tt', 'ug', 'vi', 'wo', 'zh'], nr: [1], fc: 3 }, { lngs: ['be', 'bs', 'dz', 'hr', 'ru', 'sr', 'uk'], nr: [1, 2, 5], fc: 4 }, { lngs: ['ar'], nr: [0, 1, 2, 3, 11, 100], fc: 5 }, { lngs: ['cs', 'sk'], nr: [1, 2, 5], fc: 6 }, { lngs: ['csb', 'pl'], nr: [1, 2, 5], fc: 7 }, { lngs: ['cy'], nr: [1, 2, 3, 8], fc: 8 }, { lngs: ['fr'], nr: [1, 2], fc: 9 }, { lngs: ['ga'], nr: [1, 2, 3, 7, 11], fc: 10 }, { lngs: ['gd'], nr: [1, 2, 3, 20], fc: 11 }, { lngs: ['is'], nr: [1, 2], fc: 12 }, { lngs: ['jv'], nr: [0, 1], fc: 13 }, { lngs: ['kw'], nr: [1, 2, 3, 4], fc: 14 }, { lngs: ['lt'], nr: [1, 2, 10], fc: 15 }, { lngs: ['lv'], nr: [1, 2, 0], fc: 16 }, { lngs: ['mk'], nr: [1, 2], fc: 17 }, { lngs: ['mnk'], nr: [0, 1, 2], fc: 18 }, { lngs: ['mt'], nr: [1, 2, 11, 20], fc: 19 }, { lngs: ['or'], nr: [2, 1], fc: 2 }, { lngs: ['ro'], nr: [1, 2, 20], fc: 20 }, { lngs: ['sl'], nr: [5, 1, 2, 3], fc: 21 }];\n\nvar _rulesPluralsTypes = {\n  1: function _(n) {\n    return Number(n > 1);\n  },\n  2: function _(n) {\n    return Number(n != 1);\n  },\n  3: function _(n) {\n    return 0;\n  },\n  4: function _(n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  5: function _(n) {\n    return Number(n === 0 ? 0 : n == 1 ? 1 : n == 2 ? 2 : n % 100 >= 3 && n % 100 <= 10 ? 3 : n % 100 >= 11 ? 4 : 5);\n  },\n  6: function _(n) {\n    return Number(n == 1 ? 0 : n >= 2 && n <= 4 ? 1 : 2);\n  },\n  7: function _(n) {\n    return Number(n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  8: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n != 8 && n != 11 ? 2 : 3);\n  },\n  9: function _(n) {\n    return Number(n >= 2);\n  },\n  10: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n < 7 ? 2 : n < 11 ? 3 : 4);\n  },\n  11: function _(n) {\n    return Number(n == 1 || n == 11 ? 0 : n == 2 || n == 12 ? 1 : n > 2 && n < 20 ? 2 : 3);\n  },\n  12: function _(n) {\n    return Number(n % 10 != 1 || n % 100 == 11);\n  },\n  13: function _(n) {\n    return Number(n !== 0);\n  },\n  14: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n == 3 ? 2 : 3);\n  },\n  15: function _(n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  16: function _(n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n !== 0 ? 1 : 2);\n  },\n  17: function _(n) {\n    return Number(n == 1 || n % 10 == 1 ? 0 : 1);\n  },\n  18: function _(n) {\n    return Number(n == 0 ? 0 : n == 1 ? 1 : 2);\n  },\n  19: function _(n) {\n    return Number(n == 1 ? 0 : n === 0 || n % 100 > 1 && n % 100 < 11 ? 1 : n % 100 > 10 && n % 100 < 20 ? 2 : 3);\n  },\n  20: function _(n) {\n    return Number(n == 1 ? 0 : n === 0 || n % 100 > 0 && n % 100 < 20 ? 1 : 2);\n  },\n  21: function _(n) {\n    return Number(n % 100 == 1 ? 1 : n % 100 == 2 ? 2 : n % 100 == 3 || n % 100 == 4 ? 3 : 0);\n  }\n};\n/* eslint-enable */\n\nfunction createRules() {\n  var rules = {};\n  sets.forEach(function (set$$1) {\n    set$$1.lngs.forEach(function (l) {\n      rules[l] = {\n        numbers: set$$1.nr,\n        plurals: _rulesPluralsTypes[set$$1.fc]\n      };\n    });\n  });\n  return rules;\n}\n\nvar PluralResolver = function () {\n  function PluralResolver(languageUtils) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    classCallCheck(this, PluralResolver);\n\n    this.languageUtils = languageUtils;\n    this.options = options;\n\n    this.logger = baseLogger.create('pluralResolver');\n\n    this.rules = createRules();\n  }\n\n  PluralResolver.prototype.addRule = function addRule(lng, obj) {\n    this.rules[lng] = obj;\n  };\n\n  PluralResolver.prototype.getRule = function getRule(code) {\n    return this.rules[code] || this.rules[this.languageUtils.getLanguagePartFromCode(code)];\n  };\n\n  PluralResolver.prototype.needsPlural = function needsPlural(code) {\n    var rule = this.getRule(code);\n\n    return rule && rule.numbers.length > 1;\n  };\n\n  PluralResolver.prototype.getSuffix = function getSuffix(code, count) {\n    var _this = this;\n\n    var rule = this.getRule(code);\n\n    if (rule) {\n      //if (rule.numbers.length === 1) return ''; // only singular\n\n      var idx = rule.noAbs ? rule.plurals(count) : rule.plurals(Math.abs(count));\n      var suffix = rule.numbers[idx];\n\n      // special treatment for lngs only having singular and plural\n      if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n        if (suffix === 2) {\n          suffix = 'plural';\n        } else if (suffix === 1) {\n          suffix = '';\n        }\n      }\n\n      var returnSuffix = function returnSuffix() {\n        return _this.options.prepend && suffix.toString() ? _this.options.prepend + suffix.toString() : suffix.toString();\n      };\n\n      // COMPATIBILITY JSON\n      // v1\n      if (this.options.compatibilityJSON === 'v1') {\n        if (suffix === 1) return '';\n        if (typeof suffix === 'number') return '_plural_' + suffix.toString();\n        return returnSuffix();\n      } else if ( /* v2 */this.options.compatibilityJSON === 'v2' || rule.numbers.length === 2 && rule.numbers[0] === 1) {\n        return returnSuffix();\n      } else if ( /* v3 - gettext index */rule.numbers.length === 2 && rule.numbers[0] === 1) {\n        return returnSuffix();\n      }\n      return this.options.prepend && idx.toString() ? this.options.prepend + idx.toString() : idx.toString();\n    }\n\n    this.logger.warn('no plural rule found for: ' + code);\n    return '';\n  };\n\n  return PluralResolver;\n}();\n\nvar Interpolator = function () {\n  function Interpolator() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    classCallCheck(this, Interpolator);\n\n    this.logger = baseLogger.create('interpolator');\n\n    this.init(options, true);\n  }\n\n  /* eslint no-param-reassign: 0 */\n\n\n  Interpolator.prototype.init = function init() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var reset = arguments[1];\n\n    if (reset) {\n      this.options = options;\n      this.format = options.interpolation && options.interpolation.format || function (value) {\n        return value;\n      };\n      this.escape = options.interpolation && options.interpolation.escape || escape;\n    }\n    if (!options.interpolation) options.interpolation = { escapeValue: true };\n\n    var iOpts = options.interpolation;\n\n    this.escapeValue = iOpts.escapeValue !== undefined ? iOpts.escapeValue : true;\n\n    this.prefix = iOpts.prefix ? regexEscape(iOpts.prefix) : iOpts.prefixEscaped || '{{';\n    this.suffix = iOpts.suffix ? regexEscape(iOpts.suffix) : iOpts.suffixEscaped || '}}';\n\n    this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ',';\n\n    this.unescapePrefix = iOpts.unescapeSuffix ? '' : iOpts.unescapePrefix || '-';\n    this.unescapeSuffix = this.unescapePrefix ? '' : iOpts.unescapeSuffix || '';\n\n    this.nestingPrefix = iOpts.nestingPrefix ? regexEscape(iOpts.nestingPrefix) : iOpts.nestingPrefixEscaped || regexEscape('$t(');\n    this.nestingSuffix = iOpts.nestingSuffix ? regexEscape(iOpts.nestingSuffix) : iOpts.nestingSuffixEscaped || regexEscape(')');\n\n    this.maxReplaces = iOpts.maxReplaces ? iOpts.maxReplaces : 1000;\n\n    // the regexp\n    this.resetRegExp();\n  };\n\n  Interpolator.prototype.reset = function reset() {\n    if (this.options) this.init(this.options);\n  };\n\n  Interpolator.prototype.resetRegExp = function resetRegExp() {\n    // the regexp\n    var regexpStr = this.prefix + '(.+?)' + this.suffix;\n    this.regexp = new RegExp(regexpStr, 'g');\n\n    var regexpUnescapeStr = '' + this.prefix + this.unescapePrefix + '(.+?)' + this.unescapeSuffix + this.suffix;\n    this.regexpUnescape = new RegExp(regexpUnescapeStr, 'g');\n\n    var nestingRegexpStr = this.nestingPrefix + '(.+?)' + this.nestingSuffix;\n    this.nestingRegexp = new RegExp(nestingRegexpStr, 'g');\n  };\n\n  Interpolator.prototype.interpolate = function interpolate(str, data, lng) {\n    var _this = this;\n\n    var match = void 0;\n    var value = void 0;\n    var replaces = void 0;\n\n    function regexSafe(val) {\n      return val.replace(/\\$/g, '$$$$');\n    }\n\n    var handleFormat = function handleFormat(key) {\n      if (key.indexOf(_this.formatSeparator) < 0) return getPath(data, key);\n\n      var p = key.split(_this.formatSeparator);\n      var k = p.shift().trim();\n      var f = p.join(_this.formatSeparator).trim();\n\n      return _this.format(getPath(data, k), f, lng);\n    };\n\n    this.resetRegExp();\n\n    replaces = 0;\n    // unescape if has unescapePrefix/Suffix\n    /* eslint no-cond-assign: 0 */\n    while (match = this.regexpUnescape.exec(str)) {\n      value = handleFormat(match[1].trim());\n      str = str.replace(match[0], value);\n      this.regexpUnescape.lastIndex = 0;\n      replaces++;\n      if (replaces >= this.maxReplaces) {\n        break;\n      }\n    }\n\n    replaces = 0;\n    // regular escape on demand\n    while (match = this.regexp.exec(str)) {\n      value = handleFormat(match[1].trim());\n      if (typeof value !== 'string') value = makeString(value);\n      if (!value) {\n        this.logger.warn('missed to pass in variable ' + match[1] + ' for interpolating ' + str);\n        value = '';\n      }\n      value = this.escapeValue ? regexSafe(this.escape(value)) : regexSafe(value);\n      str = str.replace(match[0], value);\n      this.regexp.lastIndex = 0;\n      replaces++;\n      if (replaces >= this.maxReplaces) {\n        break;\n      }\n    }\n    return str;\n  };\n\n  Interpolator.prototype.nest = function nest(str, fc) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    var match = void 0;\n    var value = void 0;\n\n    var clonedOptions = _extends({}, options);\n    clonedOptions.applyPostProcessor = false; // avoid post processing on nested lookup\n\n    // if value is something like \"myKey\": \"lorem $(anotherKey, { \"count\": {{aValueInOptions}} })\"\n    function handleHasOptions(key) {\n      if (key.indexOf(',') < 0) return key;\n\n      var p = key.split(',');\n      key = p.shift();\n      var optionsString = p.join(',');\n      optionsString = this.interpolate(optionsString, clonedOptions);\n      optionsString = optionsString.replace(/'/g, '\"');\n\n      try {\n        clonedOptions = JSON.parse(optionsString);\n      } catch (e) {\n        this.logger.error('failed parsing options string in nesting for key ' + key, e);\n      }\n\n      return key;\n    }\n\n    // regular escape on demand\n    while (match = this.nestingRegexp.exec(str)) {\n      value = fc(handleHasOptions.call(this, match[1].trim()), clonedOptions);\n\n      // is only the nesting key (key1 = '$(key2)') return the value without stringify\n      if (value && match[0] === str && typeof value !== 'string') return value;\n\n      // no string to include or empty\n      if (typeof value !== 'string') value = makeString(value);\n      if (!value) {\n        this.logger.warn('missed to resolve ' + match[1] + ' for nesting ' + str);\n        value = '';\n      }\n      // Nested keys should not be escaped by default #854\n      // value = this.escapeValue ? regexSafe(utils.escape(value)) : regexSafe(value);\n      str = str.replace(match[0], value);\n      this.regexp.lastIndex = 0;\n    }\n    return str;\n  };\n\n  return Interpolator;\n}();\n\nfunction remove(arr, what) {\n  var found = arr.indexOf(what);\n\n  while (found !== -1) {\n    arr.splice(found, 1);\n    found = arr.indexOf(what);\n  }\n}\n\nvar Connector = function (_EventEmitter) {\n  inherits(Connector, _EventEmitter);\n\n  function Connector(backend, store, services) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    classCallCheck(this, Connector);\n\n    var _this = possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    _this.backend = backend;\n    _this.store = store;\n    _this.languageUtils = services.languageUtils;\n    _this.options = options;\n    _this.logger = baseLogger.create('backendConnector');\n\n    _this.state = {};\n    _this.queue = [];\n\n    if (_this.backend && _this.backend.init) {\n      _this.backend.init(services, options.backend, options);\n    }\n    return _this;\n  }\n\n  Connector.prototype.queueLoad = function queueLoad(languages, namespaces, callback) {\n    var _this2 = this;\n\n    // find what needs to be loaded\n    var toLoad = [];\n    var pending = [];\n    var toLoadLanguages = [];\n    var toLoadNamespaces = [];\n\n    languages.forEach(function (lng) {\n      var hasAllNamespaces = true;\n\n      namespaces.forEach(function (ns) {\n        var name = lng + '|' + ns;\n\n        if (_this2.store.hasResourceBundle(lng, ns)) {\n          _this2.state[name] = 2; // loaded\n        } else if (_this2.state[name] < 0) {\n          // nothing to do for err\n        } else if (_this2.state[name] === 1) {\n          if (pending.indexOf(name) < 0) pending.push(name);\n        } else {\n          _this2.state[name] = 1; // pending\n\n          hasAllNamespaces = false;\n\n          if (pending.indexOf(name) < 0) pending.push(name);\n          if (toLoad.indexOf(name) < 0) toLoad.push(name);\n          if (toLoadNamespaces.indexOf(ns) < 0) toLoadNamespaces.push(ns);\n        }\n      });\n\n      if (!hasAllNamespaces) toLoadLanguages.push(lng);\n    });\n\n    if (toLoad.length || pending.length) {\n      this.queue.push({\n        pending: pending,\n        loaded: {},\n        errors: [],\n        callback: callback\n      });\n    }\n\n    return {\n      toLoad: toLoad,\n      pending: pending,\n      toLoadLanguages: toLoadLanguages,\n      toLoadNamespaces: toLoadNamespaces\n    };\n  };\n\n  Connector.prototype.loaded = function loaded(name, err, data) {\n    var _this3 = this;\n\n    var _name$split = name.split('|'),\n        _name$split2 = slicedToArray(_name$split, 2),\n        lng = _name$split2[0],\n        ns = _name$split2[1];\n\n    if (err) this.emit('failedLoading', lng, ns, err);\n\n    if (data) {\n      this.store.addResourceBundle(lng, ns, data);\n    }\n\n    // set loaded\n    this.state[name] = err ? -1 : 2;\n\n    // callback if ready\n    this.queue.forEach(function (q) {\n      pushPath(q.loaded, [lng], ns);\n      remove(q.pending, name);\n\n      if (err) q.errors.push(err);\n\n      if (q.pending.length === 0 && !q.done) {\n        _this3.emit('loaded', q.loaded);\n        /* eslint no-param-reassign: 0 */\n        q.done = true;\n        if (q.errors.length) {\n          q.callback(q.errors);\n        } else {\n          q.callback();\n        }\n      }\n    });\n\n    // remove done load requests\n    this.queue = this.queue.filter(function (q) {\n      return !q.done;\n    });\n  };\n\n  Connector.prototype.read = function read(lng, ns, fcName) {\n    var tried = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n    var _this4 = this;\n\n    var wait = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var callback = arguments[5];\n\n    if (!lng.length) return callback(null, {}); // noting to load\n\n    return this.backend[fcName](lng, ns, function (err, data) {\n      if (err && data /* = retryFlag */ && tried < 5) {\n        setTimeout(function () {\n          _this4.read.call(_this4, lng, ns, fcName, tried + 1, wait * 2, callback);\n        }, wait);\n        return;\n      }\n      callback(err, data);\n    });\n  };\n\n  /* eslint consistent-return: 0 */\n\n\n  Connector.prototype.load = function load(languages, namespaces, callback) {\n    var _this5 = this;\n\n    if (!this.backend) {\n      this.logger.warn('No backend was added via i18next.use. Will not load resources.');\n      return callback && callback();\n    }\n    var options = _extends({}, this.backend.options, this.options.backend);\n\n    if (typeof languages === 'string') languages = this.languageUtils.toResolveHierarchy(languages);\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n\n    var toLoad = this.queueLoad(languages, namespaces, callback);\n    if (!toLoad.toLoad.length) {\n      if (!toLoad.pending.length) callback(); // nothing to load and no pendings...callback now\n      return null; // pendings will trigger callback\n    }\n\n    // load with multi-load\n    if (options.allowMultiLoading && this.backend.readMulti) {\n      this.read(toLoad.toLoadLanguages, toLoad.toLoadNamespaces, 'readMulti', null, null, function (err, data) {\n        if (err) _this5.logger.warn('loading namespaces ' + toLoad.toLoadNamespaces.join(', ') + ' for languages ' + toLoad.toLoadLanguages.join(', ') + ' via multiloading failed', err);\n        if (!err && data) _this5.logger.log('successfully loaded namespaces ' + toLoad.toLoadNamespaces.join(', ') + ' for languages ' + toLoad.toLoadLanguages.join(', ') + ' via multiloading', data);\n\n        toLoad.toLoad.forEach(function (name) {\n          var _name$split3 = name.split('|'),\n              _name$split4 = slicedToArray(_name$split3, 2),\n              l = _name$split4[0],\n              n = _name$split4[1];\n\n          var bundle = getPath(data, [l, n]);\n          if (bundle) {\n            _this5.loaded(name, err, bundle);\n          } else {\n            var error = 'loading namespace ' + n + ' for language ' + l + ' via multiloading failed';\n            _this5.loaded(name, error);\n            _this5.logger.error(error);\n          }\n        });\n      });\n    } else {\n      toLoad.toLoad.forEach(function (name) {\n        _this5.loadOne(name);\n      });\n    }\n  };\n\n  Connector.prototype.reload = function reload(languages, namespaces) {\n    var _this6 = this;\n\n    if (!this.backend) {\n      this.logger.warn('No backend was added via i18next.use. Will not load resources.');\n    }\n    var options = _extends({}, this.backend.options, this.options.backend);\n\n    if (typeof languages === 'string') languages = this.languageUtils.toResolveHierarchy(languages);\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n\n    // load with multi-load\n    if (options.allowMultiLoading && this.backend.readMulti) {\n      this.read(languages, namespaces, 'readMulti', null, null, function (err, data) {\n        if (err) _this6.logger.warn('reloading namespaces ' + namespaces.join(', ') + ' for languages ' + languages.join(', ') + ' via multiloading failed', err);\n        if (!err && data) _this6.logger.log('successfully reloaded namespaces ' + namespaces.join(', ') + ' for languages ' + languages.join(', ') + ' via multiloading', data);\n\n        languages.forEach(function (l) {\n          namespaces.forEach(function (n) {\n            var bundle = getPath(data, [l, n]);\n            if (bundle) {\n              _this6.loaded(l + '|' + n, err, bundle);\n            } else {\n              var error = 'reloading namespace ' + n + ' for language ' + l + ' via multiloading failed';\n              _this6.loaded(l + '|' + n, error);\n              _this6.logger.error(error);\n            }\n          });\n        });\n      });\n    } else {\n      languages.forEach(function (l) {\n        namespaces.forEach(function (n) {\n          _this6.loadOne(l + '|' + n, 're');\n        });\n      });\n    }\n  };\n\n  Connector.prototype.loadOne = function loadOne(name) {\n    var _this7 = this;\n\n    var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n    var _name$split5 = name.split('|'),\n        _name$split6 = slicedToArray(_name$split5, 2),\n        lng = _name$split6[0],\n        ns = _name$split6[1];\n\n    this.read(lng, ns, 'read', null, null, function (err, data) {\n      if (err) _this7.logger.warn(prefix + 'loading namespace ' + ns + ' for language ' + lng + ' failed', err);\n      if (!err && data) _this7.logger.log(prefix + 'loaded namespace ' + ns + ' for language ' + lng, data);\n\n      _this7.loaded(name, err, data);\n    });\n  };\n\n  Connector.prototype.saveMissing = function saveMissing(languages, namespace, key, fallbackValue) {\n    if (this.backend && this.backend.create) this.backend.create(languages, namespace, key, fallbackValue);\n\n    // write to store to avoid resending\n    if (!languages || !languages[0]) return;\n    this.store.addResource(languages[0], namespace, key, fallbackValue);\n  };\n\n  return Connector;\n}(EventEmitter);\n\nvar Connector$1 = function (_EventEmitter) {\n  inherits(Connector, _EventEmitter);\n\n  function Connector(cache, store, services) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    classCallCheck(this, Connector);\n\n    var _this = possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    _this.cache = cache;\n    _this.store = store;\n    _this.services = services;\n    _this.options = options;\n    _this.logger = baseLogger.create('cacheConnector');\n\n    if (_this.cache && _this.cache.init) _this.cache.init(services, options.cache, options);\n    return _this;\n  }\n\n  /* eslint consistent-return: 0 */\n\n\n  Connector.prototype.load = function load(languages, namespaces, callback) {\n    var _this2 = this;\n\n    if (!this.cache) return callback && callback();\n    var options = _extends({}, this.cache.options, this.options.cache);\n\n    var loadLngs = typeof languages === 'string' ? this.services.languageUtils.toResolveHierarchy(languages) : languages;\n\n    if (options.enabled) {\n      this.cache.load(loadLngs, function (err, data) {\n        if (err) _this2.logger.error('loading languages ' + loadLngs.join(', ') + ' from cache failed', err);\n        if (data) {\n          /* eslint no-restricted-syntax: 0 */\n          for (var l in data) {\n            if (Object.prototype.hasOwnProperty.call(data, l)) {\n              for (var n in data[l]) {\n                if (Object.prototype.hasOwnProperty.call(data[l], n)) {\n                  if (n !== 'i18nStamp') {\n                    var bundle = data[l][n];\n                    if (bundle) _this2.store.addResourceBundle(l, n, bundle);\n                  }\n                }\n              }\n            }\n          }\n        }\n        if (callback) callback();\n      });\n    } else if (callback) {\n      callback();\n    }\n  };\n\n  Connector.prototype.save = function save() {\n    if (this.cache && this.options.cache && this.options.cache.enabled) this.cache.save(this.store.data);\n  };\n\n  return Connector;\n}(EventEmitter);\n\nfunction get$1() {\n  return {\n    debug: false,\n    initImmediate: true,\n\n    ns: ['translation'],\n    defaultNS: ['translation'],\n    fallbackLng: ['dev'],\n    fallbackNS: false, // string or array of namespaces\n\n    whitelist: false, // array with whitelisted languages\n    nonExplicitWhitelist: false,\n    load: 'all', // | currentOnly | languageOnly\n    preload: false, // array with preload languages\n\n    simplifyPluralSuffix: true,\n    keySeparator: '.',\n    nsSeparator: ':',\n    pluralSeparator: '_',\n    contextSeparator: '_',\n\n    saveMissing: false, // enable to send missing values\n    saveMissingTo: 'fallback', // 'current' || 'all'\n    missingKeyHandler: false, // function(lng, ns, key, fallbackValue) -> override if prefer on handling\n\n    postProcess: false, // string or array of postProcessor names\n    returnNull: true, // allows null value as valid translation\n    returnEmptyString: true, // allows empty string value as valid translation\n    returnObjects: false,\n    joinArrays: false, // or string to join array\n    returnedObjectHandler: function returnedObjectHandler() {}, // function(key, value, options) triggered if key returns object but returnObjects is set to false\n    parseMissingKeyHandler: false, // function(key) parsed a key that was not found in t() before returning\n    appendNamespaceToMissingKey: false,\n    appendNamespaceToCIMode: false,\n    overloadTranslationOptionHandler: function handle(args) {\n      return { defaultValue: args[1] };\n    },\n\n    interpolation: {\n      escapeValue: true,\n      format: function format(value, _format, lng) {\n        return value;\n      },\n      prefix: '{{',\n      suffix: '}}',\n      formatSeparator: ',',\n      // prefixEscaped: '{{',\n      // suffixEscaped: '}}',\n      // unescapeSuffix: '',\n      unescapePrefix: '-',\n\n      nestingPrefix: '$t(',\n      nestingSuffix: ')',\n      // nestingPrefixEscaped: '$t(',\n      // nestingSuffixEscaped: ')',\n      // defaultVariables: undefined // object that can have values to interpolate on - extends passed in interpolation data\n      maxReplaces: 1000 // max replaces to prevent endless loop\n    }\n  };\n}\n\n/* eslint no-param-reassign: 0 */\nfunction transformOptions(options) {\n  // create namespace object if namespace is passed in as string\n  if (typeof options.ns === 'string') options.ns = [options.ns];\n  if (typeof options.fallbackLng === 'string') options.fallbackLng = [options.fallbackLng];\n  if (typeof options.fallbackNS === 'string') options.fallbackNS = [options.fallbackNS];\n\n  // extend whitelist with cimode\n  if (options.whitelist && options.whitelist.indexOf('cimode') < 0) options.whitelist.push('cimode');\n\n  return options;\n}\n\nfunction noop() {}\n\nvar I18n = function (_EventEmitter) {\n  inherits(I18n, _EventEmitter);\n\n  function I18n() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var callback = arguments[1];\n    classCallCheck(this, I18n);\n\n    var _this = possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    _this.options = transformOptions(options);\n    _this.services = {};\n    _this.logger = baseLogger;\n    _this.modules = { external: [] };\n\n    if (callback && !_this.isInitialized && !options.isClone) {\n      var _ret;\n\n      // https://github.com/i18next/i18next/issues/879\n      if (!_this.options.initImmediate) return _ret = _this.init(options, callback), possibleConstructorReturn(_this, _ret);\n      setTimeout(function () {\n        _this.init(options, callback);\n      }, 0);\n    }\n    return _this;\n  }\n\n  I18n.prototype.init = function init() {\n    var _this2 = this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var callback = arguments[1];\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    this.options = _extends({}, get$1(), this.options, transformOptions(options));\n\n    this.format = this.options.interpolation.format;\n    if (!callback) callback = noop;\n\n    function createClassOnDemand(ClassOrObject) {\n      if (!ClassOrObject) return null;\n      if (typeof ClassOrObject === 'function') return new ClassOrObject();\n      return ClassOrObject;\n    }\n\n    // init services\n    if (!this.options.isClone) {\n      if (this.modules.logger) {\n        baseLogger.init(createClassOnDemand(this.modules.logger), this.options);\n      } else {\n        baseLogger.init(null, this.options);\n      }\n\n      var lu = new LanguageUtil(this.options);\n      this.store = new ResourceStore(this.options.resources, this.options);\n\n      var s = this.services;\n      s.logger = baseLogger;\n      s.resourceStore = this.store;\n      s.resourceStore.on('added removed', function (lng, ns) {\n        s.cacheConnector.save();\n      });\n      s.languageUtils = lu;\n      s.pluralResolver = new PluralResolver(lu, { prepend: this.options.pluralSeparator, compatibilityJSON: this.options.compatibilityJSON, simplifyPluralSuffix: this.options.simplifyPluralSuffix });\n      s.interpolator = new Interpolator(this.options);\n\n      s.backendConnector = new Connector(createClassOnDemand(this.modules.backend), s.resourceStore, s, this.options);\n      // pipe events from backendConnector\n      s.backendConnector.on('*', function (event) {\n        for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        _this2.emit.apply(_this2, [event].concat(args));\n      });\n\n      s.backendConnector.on('loaded', function (loaded) {\n        s.cacheConnector.save();\n      });\n\n      s.cacheConnector = new Connector$1(createClassOnDemand(this.modules.cache), s.resourceStore, s, this.options);\n      // pipe events from backendConnector\n      s.cacheConnector.on('*', function (event) {\n        for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n          args[_key2 - 1] = arguments[_key2];\n        }\n\n        _this2.emit.apply(_this2, [event].concat(args));\n      });\n\n      if (this.modules.languageDetector) {\n        s.languageDetector = createClassOnDemand(this.modules.languageDetector);\n        s.languageDetector.init(s, this.options.detection, this.options);\n      }\n\n      this.translator = new Translator(this.services, this.options);\n      // pipe events from translator\n      this.translator.on('*', function (event) {\n        for (var _len3 = arguments.length, args = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n          args[_key3 - 1] = arguments[_key3];\n        }\n\n        _this2.emit.apply(_this2, [event].concat(args));\n      });\n\n      this.modules.external.forEach(function (m) {\n        if (m.init) m.init(_this2);\n      });\n    }\n\n    // append api\n    var storeApi = ['getResource', 'addResource', 'addResources', 'addResourceBundle', 'removeResourceBundle', 'hasResourceBundle', 'getResourceBundle'];\n    storeApi.forEach(function (fcName) {\n      _this2[fcName] = function () {\n        var _store;\n\n        return (_store = _this2.store)[fcName].apply(_store, arguments);\n      };\n    });\n\n    var load = function load() {\n      _this2.changeLanguage(_this2.options.lng, function (err, t) {\n        _this2.isInitialized = true;\n        _this2.logger.log('initialized', _this2.options);\n        _this2.emit('initialized', _this2.options);\n\n        callback(err, t);\n      });\n    };\n\n    if (this.options.resources || !this.options.initImmediate) {\n      load();\n    } else {\n      setTimeout(load, 0);\n    }\n\n    return this;\n  };\n\n  /* eslint consistent-return: 0 */\n\n\n  I18n.prototype.loadResources = function loadResources() {\n    var _this3 = this;\n\n    var callback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : noop;\n\n    if (!this.options.resources) {\n      if (this.language && this.language.toLowerCase() === 'cimode') return callback(); // avoid loading resources for cimode\n\n      var toLoad = [];\n\n      var append = function append(lng) {\n        if (!lng) return;\n        var lngs = _this3.services.languageUtils.toResolveHierarchy(lng);\n        lngs.forEach(function (l) {\n          if (toLoad.indexOf(l) < 0) toLoad.push(l);\n        });\n      };\n\n      if (!this.language) {\n        // at least load fallbacks in this case\n        var fallbacks = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);\n        fallbacks.forEach(function (l) {\n          return append(l);\n        });\n      } else {\n        append(this.language);\n      }\n\n      if (this.options.preload) {\n        this.options.preload.forEach(function (l) {\n          return append(l);\n        });\n      }\n\n      this.services.cacheConnector.load(toLoad, this.options.ns, function () {\n        _this3.services.backendConnector.load(toLoad, _this3.options.ns, callback);\n      });\n    } else {\n      callback(null);\n    }\n  };\n\n  I18n.prototype.reloadResources = function reloadResources(lngs, ns) {\n    if (!lngs) lngs = this.languages;\n    if (!ns) ns = this.options.ns;\n    this.services.backendConnector.reload(lngs, ns);\n  };\n\n  I18n.prototype.use = function use(module) {\n    if (module.type === 'backend') {\n      this.modules.backend = module;\n    }\n\n    if (module.type === 'cache') {\n      this.modules.cache = module;\n    }\n\n    if (module.type === 'logger' || module.log && module.warn && module.error) {\n      this.modules.logger = module;\n    }\n\n    if (module.type === 'languageDetector') {\n      this.modules.languageDetector = module;\n    }\n\n    if (module.type === 'postProcessor') {\n      postProcessor.addPostProcessor(module);\n    }\n\n    if (module.type === '3rdParty') {\n      this.modules.external.push(module);\n    }\n\n    return this;\n  };\n\n  I18n.prototype.changeLanguage = function changeLanguage(lng, callback) {\n    var _this4 = this;\n\n    var done = function done(err, l) {\n      _this4.translator.changeLanguage(l);\n\n      if (l) {\n        _this4.emit('languageChanged', l);\n        _this4.logger.log('languageChanged', l);\n      }\n\n      if (callback) callback(err, function () {\n        return _this4.t.apply(_this4, arguments);\n      });\n    };\n\n    var setLng = function setLng(l) {\n      if (l) {\n        _this4.language = l;\n        _this4.languages = _this4.services.languageUtils.toResolveHierarchy(l);\n\n        if (_this4.services.languageDetector) _this4.services.languageDetector.cacheUserLanguage(l);\n      }\n\n      _this4.loadResources(function (err) {\n        done(err, l);\n      });\n    };\n\n    if (!lng && this.services.languageDetector && !this.services.languageDetector.async) {\n      setLng(this.services.languageDetector.detect());\n    } else if (!lng && this.services.languageDetector && this.services.languageDetector.async) {\n      this.services.languageDetector.detect(setLng);\n    } else {\n      setLng(lng);\n    }\n  };\n\n  I18n.prototype.getFixedT = function getFixedT(lng, ns) {\n    var _this5 = this;\n\n    var fixedT = function fixedT(key) {\n      var opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var options = typeof opts === 'string' ? { defaultValue: opts } : _extends({}, opts);\n      options.lng = options.lng || fixedT.lng;\n      options.lngs = options.lngs || fixedT.lngs;\n      options.ns = options.ns || fixedT.ns;\n      return _this5.t(key, options);\n    };\n    if (typeof lng === 'string') {\n      fixedT.lng = lng;\n    } else {\n      fixedT.lngs = lng;\n    }\n    fixedT.ns = ns;\n    return fixedT;\n  };\n\n  I18n.prototype.t = function t() {\n    var _translator;\n\n    return this.translator && (_translator = this.translator).translate.apply(_translator, arguments);\n  };\n\n  I18n.prototype.exists = function exists() {\n    var _translator2;\n\n    return this.translator && (_translator2 = this.translator).exists.apply(_translator2, arguments);\n  };\n\n  I18n.prototype.setDefaultNamespace = function setDefaultNamespace(ns) {\n    this.options.defaultNS = ns;\n  };\n\n  I18n.prototype.loadNamespaces = function loadNamespaces(ns, callback) {\n    var _this6 = this;\n\n    if (!this.options.ns) return callback && callback();\n    if (typeof ns === 'string') ns = [ns];\n\n    ns.forEach(function (n) {\n      if (_this6.options.ns.indexOf(n) < 0) _this6.options.ns.push(n);\n    });\n\n    this.loadResources(callback);\n  };\n\n  I18n.prototype.loadLanguages = function loadLanguages(lngs, callback) {\n    if (typeof lngs === 'string') lngs = [lngs];\n    var preloaded = this.options.preload || [];\n\n    var newLngs = lngs.filter(function (lng) {\n      return preloaded.indexOf(lng) < 0;\n    });\n    // Exit early if all given languages are already preloaded\n    if (!newLngs.length) return callback();\n\n    this.options.preload = preloaded.concat(newLngs);\n    this.loadResources(callback);\n  };\n\n  I18n.prototype.dir = function dir(lng) {\n    if (!lng) lng = this.languages && this.languages.length > 0 ? this.languages[0] : this.language;\n    if (!lng) return 'rtl';\n\n    var rtlLngs = ['ar', 'shu', 'sqr', 'ssh', 'xaa', 'yhd', 'yud', 'aao', 'abh', 'abv', 'acm', 'acq', 'acw', 'acx', 'acy', 'adf', 'ads', 'aeb', 'aec', 'afb', 'ajp', 'apc', 'apd', 'arb', 'arq', 'ars', 'ary', 'arz', 'auz', 'avl', 'ayh', 'ayl', 'ayn', 'ayp', 'bbz', 'pga', 'he', 'iw', 'ps', 'pbt', 'pbu', 'pst', 'prp', 'prd', 'ur', 'ydd', 'yds', 'yih', 'ji', 'yi', 'hbo', 'men', 'xmn', 'fa', 'jpr', 'peo', 'pes', 'prs', 'dv', 'sam'];\n\n    return rtlLngs.indexOf(this.services.languageUtils.getLanguagePartFromCode(lng)) >= 0 ? 'rtl' : 'ltr';\n  };\n\n  /* eslint class-methods-use-this: 0 */\n\n\n  I18n.prototype.createInstance = function createInstance() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var callback = arguments[1];\n\n    return new I18n(options, callback);\n  };\n\n  I18n.prototype.cloneInstance = function cloneInstance() {\n    var _this7 = this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n\n    var mergedOptions = _extends({}, this.options, options, { isClone: true });\n    var clone = new I18n(mergedOptions, callback);\n    var membersToCopy = ['store', 'services', 'language'];\n    membersToCopy.forEach(function (m) {\n      clone[m] = _this7[m];\n    });\n    clone.translator = new Translator(clone.services, clone.options);\n    clone.translator.on('*', function (event) {\n      for (var _len4 = arguments.length, args = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        args[_key4 - 1] = arguments[_key4];\n      }\n\n      clone.emit.apply(clone, [event].concat(args));\n    });\n    clone.init(mergedOptions, callback);\n\n    return clone;\n  };\n\n  return I18n;\n}(EventEmitter);\n\nvar i18next = new I18n();\n\nreturn i18next;\n\n})));\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function (global, factory) {\n   true ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.i18nextXHRBackend = factory());\n}(this, (function () { 'use strict';\n\nvar arr = [];\nvar each = arr.forEach;\nvar slice = arr.slice;\n\nfunction defaults(obj) {\n  each.call(slice.call(arguments, 1), function (source) {\n    if (source) {\n      for (var prop in source) {\n        if (obj[prop] === undefined) obj[prop] = source[prop];\n      }\n    }\n  });\n  return obj;\n}\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction addQueryString(url, params) {\n  if (params && (typeof params === 'undefined' ? 'undefined' : _typeof(params)) === 'object') {\n    var queryString = '',\n        e = encodeURIComponent;\n\n    // Must encode data\n    for (var paramName in params) {\n      queryString += '&' + e(paramName) + '=' + e(params[paramName]);\n    }\n\n    if (!queryString) {\n      return url;\n    }\n\n    url = url + (url.indexOf('?') !== -1 ? '&' : '?') + queryString.slice(1);\n  }\n\n  return url;\n}\n\n// https://gist.github.com/Xeoncross/7663273\nfunction ajax(url, options, callback, data, cache) {\n\n  if (data && (typeof data === 'undefined' ? 'undefined' : _typeof(data)) === 'object') {\n    if (!cache) {\n      data['_t'] = new Date();\n    }\n    // URL encoded form data must be in querystring format\n    data = addQueryString('', data).slice(1);\n  }\n\n  if (options.queryStringParams) {\n    url = addQueryString(url, options.queryStringParams);\n  }\n\n  try {\n    var x;\n    if (XMLHttpRequest) {\n      x = new XMLHttpRequest();\n    } else {\n      x = new ActiveXObject('MSXML2.XMLHTTP.3.0');\n    }\n    x.open(data ? 'POST' : 'GET', url, 1);\n    if (!options.crossDomain) {\n      x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n    }\n    x.withCredentials = !!options.withCredentials;\n    if (data) {\n      x.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n    }\n    if (x.overrideMimeType) {\n      x.overrideMimeType(\"application/json\");\n    }\n    var h = options.customHeaders;\n    if (h) {\n      for (var i in h) {\n        x.setRequestHeader(i, h[i]);\n      }\n    }\n    x.onreadystatechange = function () {\n      x.readyState > 3 && callback && callback(x.responseText, x);\n    };\n    x.send(data);\n  } catch (e) {\n    console && console.log(e);\n  }\n}\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction getDefaults() {\n  return {\n    loadPath: '/locales/{{lng}}/{{ns}}.json',\n    addPath: 'locales/add/{{lng}}/{{ns}}',\n    allowMultiLoading: false,\n    parse: JSON.parse,\n    crossDomain: false,\n    ajax: ajax\n  };\n}\n\nvar Backend = function () {\n  function Backend(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Backend);\n\n    this.init(services, options);\n\n    this.type = 'backend';\n  }\n\n  _createClass(Backend, [{\n    key: 'init',\n    value: function init(services) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      this.services = services;\n      this.options = defaults(options, this.options || {}, getDefaults());\n    }\n  }, {\n    key: 'readMulti',\n    value: function readMulti(languages, namespaces, callback) {\n      var loadPath = this.options.loadPath;\n      if (typeof this.options.loadPath === 'function') {\n        loadPath = this.options.loadPath(languages, namespaces);\n      }\n\n      var url = this.services.interpolator.interpolate(loadPath, { lng: languages.join('+'), ns: namespaces.join('+') });\n\n      this.loadUrl(url, callback);\n    }\n  }, {\n    key: 'read',\n    value: function read(language, namespace, callback) {\n      var loadPath = this.options.loadPath;\n      if (typeof this.options.loadPath === 'function') {\n        loadPath = this.options.loadPath([language], [namespace]);\n      }\n\n      var url = this.services.interpolator.interpolate(loadPath, { lng: language, ns: namespace });\n\n      this.loadUrl(url, callback);\n    }\n  }, {\n    key: 'loadUrl',\n    value: function loadUrl(url, callback) {\n      var _this = this;\n\n      this.options.ajax(url, this.options, function (data, xhr) {\n        if (xhr.status >= 500 && xhr.status < 600) return callback('failed loading ' + url, true /* retry */);\n        if (xhr.status >= 400 && xhr.status < 500) return callback('failed loading ' + url, false /* no retry */);\n\n        var ret = void 0,\n            err = void 0;\n        try {\n          ret = _this.options.parse(data, url);\n        } catch (e) {\n          err = 'failed parsing ' + url + ' to json';\n        }\n        if (err) return callback(err, false);\n        callback(null, ret);\n      });\n    }\n  }, {\n    key: 'create',\n    value: function create(languages, namespace, key, fallbackValue) {\n      var _this2 = this;\n\n      if (typeof languages === 'string') languages = [languages];\n\n      var payload = {};\n      payload[key] = fallbackValue || '';\n\n      languages.forEach(function (lng) {\n        var url = _this2.services.interpolator.interpolate(_this2.options.addPath, { lng: lng, ns: namespace });\n\n        _this2.options.ajax(url, _this2.options, function (data, xhr) {\n          //const statusCode = xhr.status.toString();\n          // TODO: if statusCode === 4xx do log\n        }, payload);\n      });\n    }\n  }]);\n\n  return Backend;\n}();\n\nBackend.type = 'backend';\n\nreturn Backend;\n\n})));\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function (global, factory) {\n     true ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global.i18nextLocalStorageCache = factory());\n}(this, (function () { 'use strict';\n\nvar arr = [];\nvar each = arr.forEach;\nvar slice = arr.slice;\n\nfunction defaults(obj) {\n  each.call(slice.call(arguments, 1), function (source) {\n    if (source) {\n      for (var prop in source) {\n        if (obj[prop] === undefined) obj[prop] = source[prop];\n      }\n    }\n  });\n  return obj;\n}\n\n\n\nfunction debounce(func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = this,\n        args = arguments;\n    var later = function later() {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar storage = {\n  setItem: function setItem(key, value) {\n    if (window.localStorage) {\n      try {\n        window.localStorage.setItem(key, value);\n      } catch (e) {\n        // f.log('failed to set value for key \"' + key + '\" to localStorage.');\n      }\n    }\n  },\n  getItem: function getItem(key, value) {\n    if (window.localStorage) {\n      try {\n        return window.localStorage.getItem(key, value);\n      } catch (e) {\n        // f.log('failed to get value for key \"' + key + '\" from localStorage.');\n      }\n    }\n    return undefined;\n  }\n};\n\nfunction getDefaults() {\n  return {\n    enabled: false,\n    prefix: 'i18next_res_',\n    expirationTime: 7 * 24 * 60 * 60 * 1000,\n    versions: {}\n  };\n}\n\nvar Cache = function () {\n  function Cache(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Cache);\n\n    this.init(services, options);\n\n    this.type = 'cache';\n    this.debouncedStore = debounce(this.store, 10000);\n  }\n\n  _createClass(Cache, [{\n    key: 'init',\n    value: function init(services) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      this.services = services;\n      this.options = defaults(options, this.options || {}, getDefaults());\n    }\n  }, {\n    key: 'load',\n    value: function load(lngs, callback) {\n      var _this = this;\n\n      var store = {};\n      var nowMS = new Date().getTime();\n\n      if (!window.localStorage || !lngs.length) {\n        return callback(null, null);\n      }\n\n      var todo = lngs.length;\n\n      lngs.forEach(function (lng) {\n        var local = storage.getItem(_this.options.prefix + lng);\n\n        if (local) {\n          local = JSON.parse(local);\n          if (\n          // expiration field is mandatory, and should not be expired\n          local.i18nStamp && local.i18nStamp + _this.options.expirationTime > nowMS &&\n\n          // there should be no language version set, or if it is, it should match the one in translation\n          _this.options.versions[lng] === local.i18nVersion) {\n            delete local.i18nVersion;\n            store[lng] = local;\n          }\n        }\n\n        todo -= 1;\n        if (todo === 0) {\n          callback(null, store);\n        }\n      });\n      return undefined;\n    }\n  }, {\n    key: 'store',\n    value: function store(storeParam) {\n      var store = storeParam;\n      if (window.localStorage) {\n        for (var m in store) {\n          // eslint-disable-line\n          // timestamp\n          store[m].i18nStamp = new Date().getTime();\n\n          // language version (if set)\n          if (this.options.versions[m]) {\n            store[m].i18nVersion = this.options.versions[m];\n          }\n\n          // save\n          storage.setItem(this.options.prefix + m, JSON.stringify(store[m]));\n        }\n      }\n    }\n  }, {\n    key: 'save',\n    value: function save(store) {\n      this.debouncedStore(store);\n    }\n  }]);\n\n  return Cache;\n}();\n\nCache.type = 'cache';\n\nreturn Cache;\n\n})));\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function (global, factory) {\n     true ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('i18nextSprintfPostProcessor', factory) :\n    (global.i18nextSprintfPostProcessor = factory());\n}(this, function () { 'use strict';\n\n    var babelHelpers = {};\n    babelHelpers.typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj;\n    };\n    babelHelpers;\n\n    var re = {\n        not_string: /[^s]/,\n        number: /[diefg]/,\n        json: /[j]/,\n        not_json: /[^j]/,\n        text: /^[^\\x25]+/,\n        modulo: /^\\x25{2}/,\n        placeholder: /^\\x25(?:([1-9]\\d*)\\$|\\(([^\\)]+)\\))?(\\+)?(0|'[^$])?(-)?(\\d+)?(?:\\.(\\d+))?([b-gijosuxX])/,\n        key: /^([a-z_][a-z_\\d]*)/i,\n        key_access: /^\\.([a-z_][a-z_\\d]*)/i,\n        index_access: /^\\[(\\d+)\\]/,\n        sign: /^[\\+\\-]/\n    };\n\n    function sprintf() {\n        var key = arguments[0],\n            cache = sprintf.cache;\n        if (!(cache[key] && cache.hasOwnProperty(key))) {\n            cache[key] = sprintf.parse(key);\n        }\n        return sprintf.format.call(null, cache[key], arguments);\n    }\n\n    sprintf.format = function (parse_tree, argv) {\n        var cursor = 1,\n            tree_length = parse_tree.length,\n            node_type = \"\",\n            arg,\n            output = [],\n            i,\n            k,\n            match,\n            pad,\n            pad_character,\n            pad_length,\n            is_positive = true,\n            sign = \"\";\n        for (i = 0; i < tree_length; i++) {\n            node_type = get_type(parse_tree[i]);\n            if (node_type === \"string\") {\n                output[output.length] = parse_tree[i];\n            } else if (node_type === \"array\") {\n                match = parse_tree[i]; // convenience purposes only\n                if (match[2]) {\n                    // keyword argument\n                    arg = argv[cursor];\n                    for (k = 0; k < match[2].length; k++) {\n                        if (!arg.hasOwnProperty(match[2][k])) {\n                            throw new Error(sprintf(\"[sprintf] property '%s' does not exist\", match[2][k]));\n                        }\n                        arg = arg[match[2][k]];\n                    }\n                } else if (match[1]) {\n                    // positional argument (explicit)\n                    arg = argv[match[1]];\n                } else {\n                    // positional argument (implicit)\n                    arg = argv[cursor++];\n                }\n\n                if (get_type(arg) == \"function\") {\n                    arg = arg();\n                }\n\n                if (re.not_string.test(match[8]) && re.not_json.test(match[8]) && get_type(arg) != \"number\" && isNaN(arg)) {\n                    throw new TypeError(sprintf(\"[sprintf] expecting number but found %s\", get_type(arg)));\n                }\n\n                if (re.number.test(match[8])) {\n                    is_positive = arg >= 0;\n                }\n\n                switch (match[8]) {\n                    case \"b\":\n                        arg = arg.toString(2);\n                        break;\n                    case \"c\":\n                        arg = String.fromCharCode(arg);\n                        break;\n                    case \"d\":\n                    case \"i\":\n                        arg = parseInt(arg, 10);\n                        break;\n                    case \"j\":\n                        arg = JSON.stringify(arg, null, match[6] ? parseInt(match[6]) : 0);\n                        break;\n                    case \"e\":\n                        arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential();\n                        break;\n                    case \"f\":\n                        arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg);\n                        break;\n                    case \"g\":\n                        arg = match[7] ? parseFloat(arg).toPrecision(match[7]) : parseFloat(arg);\n                        break;\n                    case \"o\":\n                        arg = arg.toString(8);\n                        break;\n                    case \"s\":\n                        arg = (arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg;\n                        break;\n                    case \"u\":\n                        arg = arg >>> 0;\n                        break;\n                    case \"x\":\n                        arg = arg.toString(16);\n                        break;\n                    case \"X\":\n                        arg = arg.toString(16).toUpperCase();\n                        break;\n                }\n                if (re.json.test(match[8])) {\n                    output[output.length] = arg;\n                } else {\n                    if (re.number.test(match[8]) && (!is_positive || match[3])) {\n                        sign = is_positive ? \"+\" : \"-\";\n                        arg = arg.toString().replace(re.sign, \"\");\n                    } else {\n                        sign = \"\";\n                    }\n                    pad_character = match[4] ? match[4] === \"0\" ? \"0\" : match[4].charAt(1) : \" \";\n                    pad_length = match[6] - (sign + arg).length;\n                    pad = match[6] ? pad_length > 0 ? str_repeat(pad_character, pad_length) : \"\" : \"\";\n                    output[output.length] = match[5] ? sign + arg + pad : pad_character === \"0\" ? sign + pad + arg : pad + sign + arg;\n                }\n            }\n        }\n        return output.join(\"\");\n    };\n\n    sprintf.cache = {};\n\n    sprintf.parse = function (fmt) {\n        var _fmt = fmt,\n            match = [],\n            parse_tree = [],\n            arg_names = 0;\n        while (_fmt) {\n            if ((match = re.text.exec(_fmt)) !== null) {\n                parse_tree[parse_tree.length] = match[0];\n            } else if ((match = re.modulo.exec(_fmt)) !== null) {\n                parse_tree[parse_tree.length] = \"%\";\n            } else if ((match = re.placeholder.exec(_fmt)) !== null) {\n                if (match[2]) {\n                    arg_names |= 1;\n                    var field_list = [],\n                        replacement_field = match[2],\n                        field_match = [];\n                    if ((field_match = re.key.exec(replacement_field)) !== null) {\n                        field_list[field_list.length] = field_match[1];\n                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== \"\") {\n                            if ((field_match = re.key_access.exec(replacement_field)) !== null) {\n                                field_list[field_list.length] = field_match[1];\n                            } else if ((field_match = re.index_access.exec(replacement_field)) !== null) {\n                                field_list[field_list.length] = field_match[1];\n                            } else {\n                                throw new SyntaxError(\"[sprintf] failed to parse named argument key\");\n                            }\n                        }\n                    } else {\n                        throw new SyntaxError(\"[sprintf] failed to parse named argument key\");\n                    }\n                    match[2] = field_list;\n                } else {\n                    arg_names |= 2;\n                }\n                if (arg_names === 3) {\n                    throw new Error(\"[sprintf] mixing positional and named placeholders is not (yet) supported\");\n                }\n                parse_tree[parse_tree.length] = match;\n            } else {\n                throw new SyntaxError(\"[sprintf] unexpected placeholder\");\n            }\n            _fmt = _fmt.substring(match[0].length);\n        }\n        return parse_tree;\n    };\n\n    function vsprintf(fmt, argv, _argv) {\n        _argv = (argv || []).slice(0);\n        _argv.splice(0, 0, fmt);\n        return sprintf.apply(null, _argv);\n    }\n\n    /**\n     * helpers\n     */\n    function get_type(variable) {\n        return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase();\n    }\n\n    function str_repeat(input, multiplier) {\n        return Array(multiplier + 1).join(input);\n    }\n\n    var index = {\n      name: 'sprintf',\n      type: 'postProcessor',\n\n      process: function process(value, key, options) {\n        if (!options.sprintf) return value;\n\n        if (Object.prototype.toString.apply(options.sprintf) === '[object Array]') {\n          return vsprintf(value, options.sprintf);\n        } else if (babelHelpers.typeof(options.sprintf) === 'object') {\n          return sprintf(value, options.sprintf);\n        }\n\n        return value;\n      },\n      overloadTranslationOptionHandler: function overloadTranslationOptionHandler(args) {\n        var values = [];\n\n        for (var i = 1; i < args.length; i++) {\n          values.push(args[i]);\n        }\n\n        return {\n          postProcess: 'sprintf',\n          sprintf: values\n        };\n      }\n    };\n\n    return index;\n\n}));\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n(function (global, factory) {\n   true ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.i18nextBrowserLanguageDetector = factory());\n}(this, function () { 'use strict';\n\n  var babelHelpers = {};\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.createClass = function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  }();\n\n  babelHelpers;\n\n  var arr = [];\n  var each = arr.forEach;\n  var slice = arr.slice;\n\n  function defaults(obj) {\n    each.call(slice.call(arguments, 1), function (source) {\n      if (source) {\n        for (var prop in source) {\n          if (obj[prop] === undefined) obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  }\n\n  var cookie = {\n    create: function create(name, value, minutes, domain) {\n      var expires = void 0;\n      if (minutes) {\n        var date = new Date();\n        date.setTime(date.getTime() + minutes * 60 * 1000);\n        expires = '; expires=' + date.toGMTString();\n      } else expires = '';\n      domain = domain ? 'domain=' + domain + ';' : '';\n      document.cookie = name + '=' + value + expires + ';' + domain + 'path=/';\n    },\n\n    read: function read(name) {\n      var nameEQ = name + '=';\n      var ca = document.cookie.split(';');\n      for (var i = 0; i < ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) === ' ') {\n          c = c.substring(1, c.length);\n        }if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n      }\n      return null;\n    },\n\n    remove: function remove(name) {\n      this.create(name, '', -1);\n    }\n  };\n\n  var cookie$1 = {\n    name: 'cookie',\n\n    lookup: function lookup(options) {\n      var found = void 0;\n\n      if (options.lookupCookie && typeof document !== 'undefined') {\n        var c = cookie.read(options.lookupCookie);\n        if (c) found = c;\n      }\n\n      return found;\n    },\n    cacheUserLanguage: function cacheUserLanguage(lng, options) {\n      if (options.lookupCookie && typeof document !== 'undefined') {\n        cookie.create(options.lookupCookie, lng, options.cookieMinutes, options.cookieDomain);\n      }\n    }\n  };\n\n  var querystring = {\n    name: 'querystring',\n\n    lookup: function lookup(options) {\n      var found = void 0;\n\n      if (typeof window !== 'undefined') {\n        var query = window.location.search.substring(1);\n        var params = query.split('&');\n        for (var i = 0; i < params.length; i++) {\n          var pos = params[i].indexOf('=');\n          if (pos > 0) {\n            var key = params[i].substring(0, pos);\n            if (key === options.lookupQuerystring) {\n              found = params[i].substring(pos + 1);\n            }\n          }\n        }\n      }\n\n      return found;\n    }\n  };\n\n  var hasLocalStorageSupport = void 0;\n  try {\n    hasLocalStorageSupport = window !== 'undefined' && window.localStorage !== null;\n    var testKey = 'i18next.translate.boo';\n    window.localStorage.setItem(testKey, 'foo');\n    window.localStorage.removeItem(testKey);\n  } catch (e) {\n    hasLocalStorageSupport = false;\n  }\n\n  var localStorage = {\n    name: 'localStorage',\n\n    lookup: function lookup(options) {\n      var found = void 0;\n\n      if (options.lookupLocalStorage && hasLocalStorageSupport) {\n        var lng = window.localStorage.getItem(options.lookupLocalStorage);\n        if (lng) found = lng;\n      }\n\n      return found;\n    },\n    cacheUserLanguage: function cacheUserLanguage(lng, options) {\n      if (options.lookupLocalStorage && hasLocalStorageSupport) {\n        window.localStorage.setItem(options.lookupLocalStorage, lng);\n      }\n    }\n  };\n\n  var navigator$1 = {\n    name: 'navigator',\n\n    lookup: function lookup(options) {\n      var found = [];\n\n      if (typeof navigator !== 'undefined') {\n        if (navigator.languages) {\n          // chrome only; not an array, so can't use .push.apply instead of iterating\n          for (var i = 0; i < navigator.languages.length; i++) {\n            found.push(navigator.languages[i]);\n          }\n        }\n        if (navigator.userLanguage) {\n          found.push(navigator.userLanguage);\n        }\n        if (navigator.language) {\n          found.push(navigator.language);\n        }\n      }\n\n      return found.length > 0 ? found : undefined;\n    }\n  };\n\n  var htmlTag = {\n    name: 'htmlTag',\n\n    lookup: function lookup(options) {\n      var found = void 0;\n      var htmlTag = options.htmlTag || (typeof document !== 'undefined' ? document.documentElement : null);\n\n      if (htmlTag && typeof htmlTag.getAttribute === 'function') {\n        found = htmlTag.getAttribute('lang');\n      }\n\n      return found;\n    }\n  };\n\n  function getDefaults() {\n    return {\n      order: ['querystring', 'cookie', 'localStorage', 'navigator', 'htmlTag'],\n      lookupQuerystring: 'lng',\n      lookupCookie: 'i18next',\n      lookupLocalStorage: 'i18nextLng',\n\n      // cache user language\n      caches: ['localStorage'],\n      excludeCacheFor: ['cimode']\n      //cookieMinutes: 10,\n      //cookieDomain: 'myDomain'\n    };\n  }\n\n  var Browser = function () {\n    function Browser(services) {\n      var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n      babelHelpers.classCallCheck(this, Browser);\n\n      this.type = 'languageDetector';\n      this.detectors = {};\n\n      this.init(services, options);\n    }\n\n    babelHelpers.createClass(Browser, [{\n      key: 'init',\n      value: function init(services) {\n        var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n        var i18nOptions = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n        this.services = services;\n        this.options = defaults(options, this.options || {}, getDefaults());\n        this.i18nOptions = i18nOptions;\n\n        this.addDetector(cookie$1);\n        this.addDetector(querystring);\n        this.addDetector(localStorage);\n        this.addDetector(navigator$1);\n        this.addDetector(htmlTag);\n      }\n    }, {\n      key: 'addDetector',\n      value: function addDetector(detector) {\n        this.detectors[detector.name] = detector;\n      }\n    }, {\n      key: 'detect',\n      value: function detect(detectionOrder) {\n        var _this = this;\n\n        if (!detectionOrder) detectionOrder = this.options.order;\n\n        var detected = [];\n        detectionOrder.forEach(function (detectorName) {\n          if (_this.detectors[detectorName]) {\n            var lookup = _this.detectors[detectorName].lookup(_this.options);\n            if (lookup && typeof lookup === 'string') lookup = [lookup];\n            if (lookup) detected = detected.concat(lookup);\n          }\n        });\n\n        var found = void 0;\n        detected.forEach(function (lng) {\n          if (found) return;\n          var cleanedLng = _this.services.languageUtils.formatLanguageCode(lng);\n          if (_this.services.languageUtils.isWhitelisted(cleanedLng)) found = cleanedLng;\n        });\n\n        return found || this.i18nOptions.fallbackLng[0];\n      }\n    }, {\n      key: 'cacheUserLanguage',\n      value: function cacheUserLanguage(lng, caches) {\n        var _this2 = this;\n\n        if (!caches) caches = this.options.caches;\n        if (!caches) return;\n        if (this.options.excludeCacheFor && this.options.excludeCacheFor.indexOf(lng) > -1) return;\n        caches.forEach(function (cacheName) {\n          if (_this2.detectors[cacheName]) _this2.detectors[cacheName].cacheUserLanguage(lng, _this2.options);\n        });\n      }\n    }]);\n    return Browser;\n  }();\n\n  Browser.type = 'languageDetector';\n\n  return Browser;\n\n}));\n\n/***/ })\n/******/ ]);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA3ZDM2MmZkZmI4NTIwYzhkZTMyOSIsImNkcDovLy9DRFAvRXJyb3JEZWZzLnRzIiwiY2RwOi8vL0NEUC9pMThuLnRzIiwid2VicGFjazovLy9leHRlcm5hbCB7XCJyb290XCI6XCJqUXVlcnlcIixcImNvbW1vbmpzXCI6XCJqcXVlcnlcIixcImNvbW1vbmpzMlwiOlwianF1ZXJ5XCIsXCJhbWRcIjpcImpxdWVyeVwifSIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwge1wicm9vdFwiOlwiQ0RQXCIsXCJjb21tb25qc1wiOlwiY2RwLmNvcmVcIixcImNvbW1vbmpzMlwiOlwiY2RwLmNvcmVcIixcImFtZFwiOlwiY2RwLmNvcmVcIn0iLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIHtcInJvb3RcIjpcIkNEUFwiLFwiY29tbW9uanNcIjpcImNkcC5wcm9taXNlXCIsXCJjb21tb25qczJcIjpcImNkcC5wcm9taXNlXCIsXCJhbWRcIjpcImNkcC5wcm9taXNlXCJ9Iiwid2VicGFjazovLy9leHRlcm5hbC9pMThuZXh0L3NjcmlwdHMvanF1ZXJ5LWkxOG5leHQuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsL2kxOG5leHQvc2NyaXB0cy9pMThuZXh0LmpzIiwid2VicGFjazovLy9leHRlcm5hbC9pMThuZXh0L3NjcmlwdHMvaTE4bmV4dFhIUkJhY2tlbmQuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsL2kxOG5leHQvc2NyaXB0cy9pMThuZXh0TG9jYWxTdG9yYWdlQ2FjaGUuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsL2kxOG5leHQvc2NyaXB0cy9pMThuZXh0U3ByaW50ZlBvc3RQcm9jZXNzb3IuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsL2kxOG5leHQvc2NyaXB0cy9pMThuZXh0QnJvd3Nlckxhbmd1YWdlRGV0ZWN0b3IuanMiXSwibmFtZXMi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QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsaUVBQWlFLFlBQVksMkJBQTJCLHNEQUFzRDs7QUFFOUo7QUFDQTtBQUNBLHVFQUF1RTtBQUN2RTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSzs7QUFFTCxZQUFZO0FBQ1o7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7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cnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJqcXVlcnlcIiksIHJlcXVpcmUoXCJjZHAuY29yZVwiKSwgcmVxdWlyZShcImNkcC5wcm9taXNlXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtcImpxdWVyeVwiLCBcImNkcC5jb3JlXCIsIFwiY2RwLnByb21pc2VcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiQ0RQXCJdID0gZmFjdG9yeShyZXF1aXJlKFwianF1ZXJ5XCIpLCByZXF1aXJlKFwiY2RwLmNvcmVcIiksIHJlcXVpcmUoXCJjZHAucHJvbWlzZVwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiQ0RQXCJdID0gZmFjdG9yeShyb290W1wialF1ZXJ5XCJdLCByb290W1wiQ0RQXCJdLCByb290W1wiQ0RQXCJdKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMV9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzJfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8zX18pIHtcbnJldHVybiBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgN2QzNjJmZGZiODUyMGM4ZGUzMjkiLCJuYW1lc3BhY2UgQ0RQIHtcclxuXHJcbiAgICAvLyBAaW50ZXJuYWwgRXJyb3IgY29kZSBvZmZzZXQgZGVmaW5pdGlvbiBvZiBgY2RwLWkxOG5gLlxyXG4gICAgZXhwb3J0IGVudW0gUkVTVUxUX0NPREVfQkFTRSB7XHJcbiAgICAgICAgQ0RQX0kxOE5fREVDTEFSRVJBVElPTiA9IDAsIC8vIFRTMjQzMiDlr77nrZZcclxuICAgICAgICBDRFBfSTE4TiA9IDMgKiBfTU9EVUxFX1JFU1VMVF9DT0RFX1JBTkdFX0NEUCxcclxuICAgIH1cclxuXHJcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgLy8gbW9kdWxlIGVycm9yIGRlY2xhcmF0aW9uOlxyXG5cclxuICAgIC8vIEBpbnRlcm5hbCBjZHAuaTE4biDlhoXjga7jg63jg7zjgqvjg6vjgrPjg7zjg4njgqrjg5Xjgrvjg4Pjg4jlgKRcclxuICAgIGVudW0gTE9DQUxfQ09ERV9CQVNFIHtcclxuICAgICAgICBJMThOID0gMCxcclxuICAgIH1cclxuXHJcbiAgICAvKiB0c2xpbnQ6ZGlzYWJsZTptYXgtbGluZS1sZW5ndGggKi9cclxuICAgIC8vIEVycm9yIGNvZGUgZGVmaW5pdGlvbiBvZiBgY2RwLWkxOG5gLlxyXG4gICAgZXhwb3J0IGVudW0gUkVTVUxUX0NPREUge1xyXG4gICAgICAgIEVSUk9SX0NEUF9JMThOX0RFQ0xBUkFUSU9OID0gMCwgLy8gVFMyNDMyIOWvvuetllxyXG4gICAgICAgIC8qKiBgZW5gIFtbQ0RQLmluaXRpYWxpemVJMThOXV0oKSBmYWlsZXIgY29kZS4gPGJyPiBgamFgIFtbQ0RQLmluaXRpYWxpemVJMThOXV0oKSDjga7jgqjjg6njg7zjgrPjg7zjg4kgKi9cclxuICAgICAgICBFUlJPUl9DRFBfSTE4Tl9JTklUSUFMSVpFX0ZBSUxFRCA9IERFQ0xBUkVfRVJST1JfQ09ERShSRVNVTFRfQ09ERV9CQVNFLkNEUF9JMThOLCBMT0NBTF9DT0RFX0JBU0UuSTE4TiArIDEsIFwiaTE4biBpbml0aWFsaXplIGZhaWxlZC5cIiksXHJcbiAgICB9XHJcbiAgICAvKiB0c2xpbnQ6ZW5hYmxlOm1heC1saW5lLWxlbmd0aCAqL1xyXG59XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBjZHA6Ly8vQ0RQL0Vycm9yRGVmcy50cyIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9AdHlwZXMvaTE4bmV4dC5kLnRzXCIgLz5cclxuLyogdHNsaW50OmRpc2FibGU6bWF4LWxpbmUtbGVuZ3RoICovXHJcblxyXG5uYW1lc3BhY2UgQ0RQIHtcclxuXHJcbiAgICBpbXBvcnQgUHJvbWlzZSA9IENEUC5Qcm9taXNlO1xyXG4gICAgaW1wb3J0IEkxOG5leHQgPSBpMThuZXh0LmkxOG47XHJcblxyXG4gICAgZXhwb3J0IG5hbWVzcGFjZSBJMThOIHtcclxuICAgICAgICBleHBvcnQgdHlwZSBJMThuID0gSTE4bmV4dC5pMThuO1xyXG4gICAgICAgIGV4cG9ydCB0eXBlIE9wdGlvbnMgPSBJMThuZXh0LkluaXRPcHRpb25zICYgeyBba2V5czogc3RyaW5nXTogYW55IH07XHJcbiAgICAgICAgZXhwb3J0IHR5cGUgVHJhbnNsYXRpb25PcHRpb25zID0gSTE4bmV4dC5UcmFuc2xhdGlvbk9wdGlvbnM7XHJcbiAgICAgICAgZXhwb3J0IHR5cGUgVHJhbnNsYXRpb25GdW5jdGlvbiA9IEkxOG5leHQuVHJhbnNsYXRpb25GdW5jdGlvbjtcclxuICAgICAgICBleHBvcnQgdHlwZSBJbnRlcnBvbGF0aW9uT3B0aW9ucyA9IEkxOG5leHQuSW50ZXJwb2xhdGlvbk9wdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgVEFHID0gXCJbQ0RQLmkxOG5dIFwiO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQGVuIERpcmVjdCBhY2Nlc3NvciBmb3IgaTE4bmV4dCBvYmplY3QuXHJcbiAgICAgKiBAamEgaTE4bmV4dCDjgbjjga7jg4DjgqTjg6zjgq/jg4jjgqLjgq/jgrvjgrlcclxuICAgICAqL1xyXG4gICAgZXhwb3J0IGxldCBpMThuOiBJMThOLkkxOG47XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW4gT3B0aW9ucyBpbnRlcmZhY2UgZm9yIGxvY2FsaXplIHNldHRpbmdzXHJcbiAgICAgKiBAamEg44Ot44O844Kr44Op44Kk44K66Kit5a6a55So44Kq44OX44K344On44OzXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBpbnRlcmZhY2UgSTE4TlNldHRpbmdzIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAZXMgZmFsbGJhY2sgc3RyaW5nIHJlc291cmNlIHNldHRpbmcgd2hlbiBhdXRvbWF0aWMgcmVzb2x1dGlvbiBmYWlsZWQuXHJcbiAgICAgICAgICogQGphIOiHquWLleino+axuuOBp+OBjeOBquOBi+OBo+OBn+OBqOOBjeOBq+S9v+eUqOOBmeOCi+ODquOCveODvOOCuVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGV4YW1wbGUgPGJyPlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogYGBgdHNcclxuICAgICAgICAgKiAgZW46IHtcclxuICAgICAgICAgKiAgICAgIG1lc3NhZ2VzOiBcIi9yZXMvbG9jYWxlcy9tZXNzYWdlcy5lbi1VUy5qc29uXCIsXHJcbiAgICAgICAgICogIH0sXHJcbiAgICAgICAgICogIGphOiB7XHJcbiAgICAgICAgICogICAgICBtZXNzYWdlczogXCIvcmVzL2xvY2FsZXMvbWVzc2FnZXMuamEtSlAuanNvblwiLFxyXG4gICAgICAgICAqICB9LFxyXG4gICAgICAgICAqIGBgYFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZhbGxiYWNrUmVzb3VyY2VzPzogeyBbbG5nOiBzdHJpbmddOiB7IFtuczogc3RyaW5nXTogc3RyaW5nIH0gfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQGVzIHNldCBwcmVsb2FkIHJlc291cmNlIG5hbWVcclxuICAgICAgICAgKiBAamEgcHJlbG9hZCDjgZnjgovjg6rjgr3jg7zjgrnmjIflrppcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBleGFtcGxlIDxicj5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIGBgYHRzXHJcbiAgICAgICAgICogIHByZWxvYWQ6IFtcclxuICAgICAgICAgKiAgICAgIFwiZW4tVVNcIixcclxuICAgICAgICAgKiAgICAgIFwiamEtSlBcIixcclxuICAgICAgICAgKiAgXSxcclxuICAgICAgICAgKiBgYGBcclxuICAgICAgICAgKi9cclxuICAgICAgICBwcmVsb2FkPzogc3RyaW5nW107XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBlcyBpMThuZXh0IHJhdyBvcHRpb25zXHJcbiAgICAgICAgICogQGphIGkxOG5leHQg44GM5o+Q5L6b44GZ44KL44Kq44OX44K344On44OzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgb3B0aW9ucz86IEkxOE4uT3B0aW9ucztcclxuICAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZW4gaW5pdGlhbGl6ZSBpMThuZXh0LiA8YnI+XHJcbiAgICAgKiAgICAgSXQnbGwgYmUgdXN1YWxseSBjYWxsZWQgZnJvbSBmcmFtZXdvcmsuXHJcbiAgICAgKiBAamEgaTE4bmV4dCDjga7liJ3mnJ/ljJYgPGJyPlxyXG4gICAgICogICAgIOmAmuW4uOOBryBGcmFtZXdvcmsg44GM5ZG844Gz5Ye644GZ44CCXHJcbiAgICAgKi9cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplSTE4TihzZXR0aW5ncz86IEkxOE5TZXR0aW5ncyk6IElQcm9taXNlQmFzZTxhbnk+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpMThuU2V0dGluZ3M6IEkxOE5TZXR0aW5ncyA9IHNldHRpbmdzIHx8IHt9O1xyXG4gICAgICAgICAgICBpMThuU2V0dGluZ3Mub3B0aW9ucyA9IGkxOG5TZXR0aW5ncy5vcHRpb25zIHx8IHt9O1xyXG5cclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkxOG5PcHRpb25zOiBJMThOLk9wdGlvbnMgPSAoKHJlc291cmNlczogeyBbbG5nOiBzdHJpbmddOiB7IFtuczogc3RyaW5nXTogc3RyaW5nIH0gfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsbmcgaW4gcmVzb3VyY2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2VzLmhhc093blByb3BlcnR5KGxuZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5zIGluIHJlc291cmNlc1tsbmddKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZXNbbG5nXS5oYXNPd25Qcm9wZXJ0eShucykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlc1tsbmddW25zXSA9IGdldExvY2FsZUZhbGxiYWNrUmVzb3VyY2UocmVzb3VyY2VzW2xuZ11bbnNdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpMThuU2V0dGluZ3Mub3B0aW9ucy5yZXNvdXJjZXMgPSA8YW55PnJlc291cmNlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkxOG5TZXR0aW5ncy5vcHRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpMThuU2V0dGluZ3Mub3B0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KShpMThuU2V0dGluZ3MuZmFsbGJhY2tSZXNvdXJjZXMpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVpcmUoW1wianF1ZXJ5STE4bmV4dFwiXSwgKCQxOE5leHQ6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmUoW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImkxOG5leHRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpMThuZXh0WEhSQmFja2VuZFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImkxOG5leHRMb2NhbFN0b3JhZ2VDYWNoZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImkxOG5leHRTcHJpbnRmUG9zdFByb2Nlc3NvclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImkxOG5leHRCcm93c2VyTGFuZ3VhZ2VEZXRlY3RvclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIF0sIChpMThuZXh0OiBJMThOLkkxOG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBCYWNrZW5kOiBhbnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBDYWNoZTogYW55XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgUG9zdFByb2Nlc3NvcjogYW55XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgTGFuZ3VhZ2VEZXRlY3RvcjogYW55XHJcbiAgICAgICAgICAgICAgICAgICAgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMThuZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVzZShCYWNrZW5kKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51c2UoQ2FjaGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnVzZShQb3N0UHJvY2Vzc29yKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC51c2UoTGFuZ3VhZ2VEZXRlY3RvcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaW5pdChpMThuT3B0aW9ucywgKGVycm9yOiBhbnksIHQ6IEkxOE4uVHJhbnNsYXRpb25GdW5jdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkMThOZXh0LmluaXQoaTE4bmV4dCwgJCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdE5hbWU6IFwidFwiLCAgICAgICAgICAgICAgICAgICAgICAgICAvLyAtLT4gYXBwZW5kcyAkLnQgPSBpMThuZXh0LnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkxOG5OYW1lOiBcImkxOG5cIiwgICAgICAgICAgICAgICAgICAgLy8gLS0+IGFwcGVuZHMgJC5pMThuID0gaTE4bmV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlTmFtZTogXCJsb2NhbGl6ZVwiLCAgICAgICAgICAgICAvLyAtLT4gYXBwZW5kcyAkKHNlbGVjdG9yKS5sb2NhbGl6ZShvcHRzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yQXR0cjogXCJkYXRhLWkxOG5cIiwgICAgICAgICAgLy8gc2VsZWN0b3IgZm9yIHRyYW5zbGF0aW5nIGVsZW1lbnRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBdHRyOiBcImkxOG4tdGFyZ2V0XCIsICAgICAgICAgIC8vIGRhdGEtKCkgYXR0cmlidXRlIHRvIGdyYWIgdGFyZ2V0IGVsZW1lbnQgdG8gdHJhbnNsYXRlIChpZiBkaWZmcmVudCB0aGVuIGl0c2VsZilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNBdHRyOiBcImkxOG4tb3B0aW9uc1wiLCAgICAgICAgLy8gZGF0YS0oKSBhdHRyaWJ1dGUgdGhhdCBjb250YWlucyBvcHRpb25zLCB3aWxsIGxvYWQvc2V0IGlmIHVzZU9wdGlvbnNBdHRyID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlT3B0aW9uc0F0dHI6IGZhbHNlLCAgICAgICAgICAgICAgLy8gbm8gdXNlIG9wdGlvbnNBdHRyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZURlZmF1bHRWYWx1ZUZyb21Db250ZW50OiB0cnVlICAvLyBwYXJzZXMgZGVmYXVsdCB2YWx1ZXMgZnJvbSBjb250ZW50IGVsZS52YWwgb3IgZWxlLnRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGkxOG5leHQgMy40LjE6IHJlc291cmNlcyDjgYzmjIflrprjgZXjgozjgovjgaggcHJlbG9hZCDjgYzoqq3jgb/ovrzjgb7jgozjgarjgYTjgZ/jgoHjgIHlho3oqq3jgb/ovrzjgb/lh6bnkIbjgpLooYzjgYYuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpMThuZXh0Lm9wdGlvbnMucmVzb3VyY2VzICYmIGkxOG5leHQub3B0aW9ucy5wcmVsb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvcHRpb25zIOOBi+OCieODl+ODreODkeODhuOCo+OCkuS4gOaXpuWJiumZpC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IF9wcmVsb2FkID0gaTE4bmV4dC5vcHRpb25zLnByZWxvYWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBfcmVzb3VyY2VzID0gaTE4bmV4dC5vcHRpb25zLnJlc291cmNlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBpMThuZXh0Lm9wdGlvbnMucmVzb3VyY2VzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGkxOG5leHQub3B0aW9ucy5wcmVsb2FkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaTE4bmV4dC5sb2FkTGFuZ3VhZ2VzKF9wcmVsb2FkLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3B0aW9ucyDjgpLlhYPjgavmiLvjgZlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMThuZXh0Lm9wdGlvbnMucmVzb3VyY2VzID0gX3Jlc291cmNlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpMThuZXh0Lm9wdGlvbnMucHJlbG9hZCA9IF9wcmVsb2FkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENEUC5pMThuID0gaTE4bmV4dDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENEUC5pMThuID0gaTE4bmV4dDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZXMgZ2V0IHN0cmluZyByZXNvdXJjZSBmb3IgZmFsbGJhY2suXHJcbiAgICAgKiBAanMgRmFsbGJhY2sg55So44Ot44O844Kr44Op44Kk44K644Oq44K944O844K544Gu5Y+W5b6XXHJcbiAgICAgKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKiBAcmV0dXJuc1xyXG4gICAgICogICAtIGBlbmAgZmFsbGJhY2sgcmVzb3VyY2Ugb2JqZWN0XHJcbiAgICAgKiAgIC0gYGphYCBmYWxsYmFjayDjg6rjgr3jg7zjgrnjgqrjg5bjgrjjgqfjgq/jg4hcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZ2V0TG9jYWxlRmFsbGJhY2tSZXNvdXJjZShwYXRoOiBzdHJpbmcpOiBhbnkge1xyXG4gICAgICAgIGxldCBqc29uOiBKU09OO1xyXG4gICAgICAgIGxldCBlcnJvcjogRXJyb3JJbmZvO1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogQ0RQLnRvVXJsKHBhdGgpLFxyXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgIGFzeW5jOiBmYWxzZSxcclxuICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiAoZGF0YTogSlNPTikgPT4ge1xyXG4gICAgICAgICAgICAgICAganNvbiA9IGRhdGE7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiAoeGhyOiBKUXVlcnlYSFIsIHN0YXR1czogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlcnJvciA9IG1ha2VFcnJvckluZm8oXHJcbiAgICAgICAgICAgICAgICAgICAgUkVTVUxUX0NPREUuRVJST1JfQ0RQX0kxOE5fSU5JVElBTElaRV9GQUlMRUQsXHJcbiAgICAgICAgICAgICAgICAgICAgVEFHLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiYWpheCByZXF1ZXN0IGZhaWxlZC4gc3RhdHVzOiBcIiArIHN0YXR1c1xyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAobnVsbCAhPSBlcnJvcikge1xyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBqc29uO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLyBqcXVlcnktaTE4bmV4dCBleHRlbnNpb25zXHJcblxyXG5pbnRlcmZhY2UgSlF1ZXJ5U3RhdGljIHtcclxuICAgIGkxOG46IENEUC5JMThOLkkxOG47XHJcbiAgICB0OiAoa2V5OiBzdHJpbmcsIG9wdGlvbnM/OiBDRFAuSTE4Ti5PcHRpb25zKSA9PiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBKUXVlcnkge1xyXG4gICAgbG9jYWxpemU6IChvcHRpb25zPzogQ0RQLkkxOE4uVHJhbnNsYXRpb25PcHRpb25zKSA9PiBKUXVlcnk7XHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vIGNkcC5pMThuIGRlY2xhcmF0aW9uXHJcblxyXG5kZWNsYXJlIG1vZHVsZSBcImNkcC5pMThuXCIge1xyXG4gICAgZXhwb3J0ID0gQ0RQO1xyXG59XHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBjZHA6Ly8vQ0RQL2kxOG4udHMiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMV9fO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIHtcInJvb3RcIjpcImpRdWVyeVwiLFwiY29tbW9uanNcIjpcImpxdWVyeVwiLFwiY29tbW9uanMyXCI6XCJqcXVlcnlcIixcImFtZFwiOlwianF1ZXJ5XCJ9XG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX187XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwge1wicm9vdFwiOlwiQ0RQXCIsXCJjb21tb25qc1wiOlwiY2RwLmNvcmVcIixcImNvbW1vbmpzMlwiOlwiY2RwLmNvcmVcIixcImFtZFwiOlwiY2RwLmNvcmVcIn1cbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzNfXztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCB7XCJyb290XCI6XCJDRFBcIixcImNvbW1vbmpzXCI6XCJjZHAucHJvbWlzZVwiLFwiY29tbW9uanMyXCI6XCJjZHAucHJvbWlzZVwiLFwiYW1kXCI6XCJjZHAucHJvbWlzZVwifVxuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG4gIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG4gIChnbG9iYWwuanF1ZXJ5STE4bmV4dCA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxudmFyIGRlZmF1bHRzID0ge1xuICB0TmFtZTogJ3QnLFxuICBpMThuTmFtZTogJ2kxOG4nLFxuICBoYW5kbGVOYW1lOiAnbG9jYWxpemUnLFxuICBzZWxlY3RvckF0dHI6ICdkYXRhLWkxOG4nLFxuICB0YXJnZXRBdHRyOiAnaTE4bi10YXJnZXQnLFxuICBvcHRpb25zQXR0cjogJ2kxOG4tb3B0aW9ucycsXG4gIHVzZU9wdGlvbnNBdHRyOiBmYWxzZSxcbiAgcGFyc2VEZWZhdWx0VmFsdWVGcm9tQ29udGVudDogdHJ1ZVxufTtcblxuZnVuY3Rpb24gaW5pdChpMThuZXh0LCAkKSB7XG4gIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcblxuXG4gIG9wdGlvbnMgPSBfZXh0ZW5kcyh7fSwgZGVmYXVsdHMsIG9wdGlvbnMpO1xuXG4gIGZ1bmN0aW9uIHBhcnNlKGVsZSwga2V5LCBvcHRzKSB7XG4gICAgaWYgKGtleS5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIHZhciBhdHRyID0gJ3RleHQnO1xuXG4gICAgaWYgKGtleS5pbmRleE9mKCdbJykgPT09IDApIHtcbiAgICAgIHZhciBwYXJ0cyA9IGtleS5zcGxpdCgnXScpO1xuICAgICAga2V5ID0gcGFydHNbMV07XG4gICAgICBhdHRyID0gcGFydHNbMF0uc3Vic3RyKDEsIHBhcnRzWzBdLmxlbmd0aCAtIDEpO1xuICAgIH1cblxuICAgIGlmIChrZXkuaW5kZXhPZignOycpID09PSBrZXkubGVuZ3RoIC0gMSkge1xuICAgICAga2V5ID0ga2V5LnN1YnN0cigwLCBrZXkubGVuZ3RoIC0gMik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXh0ZW5kRGVmYXVsdChvLCB2YWwpIHtcbiAgICAgIGlmICghb3B0aW9ucy5wYXJzZURlZmF1bHRWYWx1ZUZyb21Db250ZW50KSByZXR1cm4gbztcbiAgICAgIHJldHVybiBfZXh0ZW5kcyh7fSwgbywgeyBkZWZhdWx0VmFsdWU6IHZhbCB9KTtcbiAgICB9XG5cbiAgICBpZiAoYXR0ciA9PT0gJ2h0bWwnKSB7XG4gICAgICBlbGUuaHRtbChpMThuZXh0LnQoa2V5LCBleHRlbmREZWZhdWx0KG9wdHMsIGVsZS5odG1sKCkpKSk7XG4gICAgfSBlbHNlIGlmIChhdHRyID09PSAndGV4dCcpIHtcbiAgICAgIGVsZS50ZXh0KGkxOG5leHQudChrZXksIGV4dGVuZERlZmF1bHQob3B0cywgZWxlLnRleHQoKSkpKTtcbiAgICB9IGVsc2UgaWYgKGF0dHIgPT09ICdwcmVwZW5kJykge1xuICAgICAgZWxlLnByZXBlbmQoaTE4bmV4dC50KGtleSwgZXh0ZW5kRGVmYXVsdChvcHRzLCBlbGUuaHRtbCgpKSkpO1xuICAgIH0gZWxzZSBpZiAoYXR0ciA9PT0gJ2FwcGVuZCcpIHtcbiAgICAgIGVsZS5hcHBlbmQoaTE4bmV4dC50KGtleSwgZXh0ZW5kRGVmYXVsdChvcHRzLCBlbGUuaHRtbCgpKSkpO1xuICAgIH0gZWxzZSBpZiAoYXR0ci5pbmRleE9mKCdkYXRhLScpID09PSAwKSB7XG4gICAgICB2YXIgZGF0YUF0dHIgPSBhdHRyLnN1YnN0cignZGF0YS0nLmxlbmd0aCk7XG4gICAgICB2YXIgdHJhbnNsYXRlZCA9IGkxOG5leHQudChrZXksIGV4dGVuZERlZmF1bHQob3B0cywgZWxlLmRhdGEoZGF0YUF0dHIpKSk7XG5cbiAgICAgIC8vIHdlIGNoYW5nZSBpbnRvIHRoZSBkYXRhIGNhY2hlXG4gICAgICBlbGUuZGF0YShkYXRhQXR0ciwgdHJhbnNsYXRlZCk7XG4gICAgICAvLyB3ZSBjaGFuZ2UgaW50byB0aGUgZG9tXG4gICAgICBlbGUuYXR0cihhdHRyLCB0cmFuc2xhdGVkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWxlLmF0dHIoYXR0ciwgaTE4bmV4dC50KGtleSwgZXh0ZW5kRGVmYXVsdChvcHRzLCBlbGUuYXR0cihhdHRyKSkpKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBsb2NhbGl6ZShlbGUsIG9wdHMpIHtcbiAgICB2YXIga2V5ID0gZWxlLmF0dHIob3B0aW9ucy5zZWxlY3RvckF0dHIpO1xuICAgIGlmICgha2V5ICYmIHR5cGVvZiBrZXkgIT09ICd1bmRlZmluZWQnICYmIGtleSAhPT0gZmFsc2UpIGtleSA9IGVsZS50ZXh0KCkgfHwgZWxlLnZhbCgpO1xuICAgIGlmICgha2V5KSByZXR1cm47XG5cbiAgICB2YXIgdGFyZ2V0ID0gZWxlLFxuICAgICAgICB0YXJnZXRTZWxlY3RvciA9IGVsZS5kYXRhKG9wdGlvbnMudGFyZ2V0QXR0cik7XG5cbiAgICBpZiAodGFyZ2V0U2VsZWN0b3IpIHRhcmdldCA9IGVsZS5maW5kKHRhcmdldFNlbGVjdG9yKSB8fCBlbGU7XG5cbiAgICBpZiAoIW9wdHMgJiYgb3B0aW9ucy51c2VPcHRpb25zQXR0ciA9PT0gdHJ1ZSkgb3B0cyA9IGVsZS5kYXRhKG9wdGlvbnMub3B0aW9uc0F0dHIpO1xuXG4gICAgb3B0cyA9IG9wdHMgfHwge307XG5cbiAgICBpZiAoa2V5LmluZGV4T2YoJzsnKSA+PSAwKSB7XG4gICAgICB2YXIga2V5cyA9IGtleS5zcGxpdCgnOycpO1xuXG4gICAgICAkLmVhY2goa2V5cywgZnVuY3Rpb24gKG0sIGspIHtcbiAgICAgICAgLy8gLnRyaW0oKTogVHJpbSB0aGUgY29tbWEtc2VwYXJhdGVkIHBhcmFtZXRlcnMgb24gdGhlIGRhdGEtaTE4biBhdHRyaWJ1dGUuXG4gICAgICAgIGlmIChrICE9PSAnJykgcGFyc2UodGFyZ2V0LCBrLnRyaW0oKSwgb3B0cyk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGFyc2UodGFyZ2V0LCBrZXksIG9wdHMpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb25zLnVzZU9wdGlvbnNBdHRyID09PSB0cnVlKSB7XG4gICAgICB2YXIgY2xvbmUgPSB7fTtcbiAgICAgIGNsb25lID0gX2V4dGVuZHMoeyBjbG9uZTogY2xvbmUgfSwgb3B0cyk7XG5cbiAgICAgIGRlbGV0ZSBjbG9uZS5sbmc7XG4gICAgICBlbGUuZGF0YShvcHRpb25zLm9wdGlvbnNBdHRyLCBjbG9uZSk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlKG9wdHMpIHtcbiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIGxvY2FsaXplIGVsZW1lbnQgaXRzZWxmXG4gICAgICBsb2NhbGl6ZSgkKHRoaXMpLCBvcHRzKTtcblxuICAgICAgLy8gbG9jYWxpemUgY2hpbGRyZW5cbiAgICAgIHZhciBlbGVtZW50cyA9ICQodGhpcykuZmluZCgnWycgKyBvcHRpb25zLnNlbGVjdG9yQXR0ciArICddJyk7XG4gICAgICBlbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbG9jYWxpemUoJCh0aGlzKSwgb3B0cyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyAkLnQgJC5pMThuIHNob3J0Y3V0XG4gICRbb3B0aW9ucy50TmFtZV0gPSBpMThuZXh0LnQuYmluZChpMThuZXh0KTtcbiAgJFtvcHRpb25zLmkxOG5OYW1lXSA9IGkxOG5leHQ7XG5cbiAgLy8gc2VsZWN0b3IgZnVuY3Rpb24gJChteVNlbGVjdG9yKS5sb2NhbGl6ZShvcHRzKTtcbiAgJC5mbltvcHRpb25zLmhhbmRsZU5hbWVdID0gaGFuZGxlO1xufVxuXG52YXIgaW5kZXggPSB7XG4gIGluaXQ6IGluaXRcbn07XG5cbnJldHVybiBpbmRleDtcblxufSkpKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2V4dGVybmFsL2kxOG5leHQvc2NyaXB0cy9qcXVlcnktaTE4bmV4dC5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuaTE4bmV4dCA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmo7XG59IDogZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajtcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIGNsYXNzQ2FsbENoZWNrID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cbn07XG5cblxuXG5cblxuXG5cblxuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuXG4gICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHtcbiAgICAgICAgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGFyZ2V0O1xufTtcblxuXG5cbnZhciBpbmhlcml0cyA9IGZ1bmN0aW9uIChzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7XG4gIH1cblxuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHtcbiAgICBjb25zdHJ1Y3Rvcjoge1xuICAgICAgdmFsdWU6IHN1YkNsYXNzLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gIGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzcztcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gPSBmdW5jdGlvbiAoc2VsZiwgY2FsbCkge1xuICBpZiAoIXNlbGYpIHtcbiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gIH1cblxuICByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjtcbn07XG5cblxuXG5cblxudmFyIHNsaWNlZFRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIHNsaWNlSXRlcmF0b3IoYXJyLCBpKSB7XG4gICAgdmFyIF9hcnIgPSBbXTtcbiAgICB2YXIgX24gPSB0cnVlO1xuICAgIHZhciBfZCA9IGZhbHNlO1xuICAgIHZhciBfZSA9IHVuZGVmaW5lZDtcblxuICAgIHRyeSB7XG4gICAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7XG4gICAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7XG5cbiAgICAgICAgaWYgKGkgJiYgX2Fyci5sZW5ndGggPT09IGkpIGJyZWFrO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgX2QgPSB0cnVlO1xuICAgICAgX2UgPSBlcnI7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0pIF9pW1wicmV0dXJuXCJdKCk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBpZiAoX2QpIHRocm93IF9lO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBfYXJyO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChhcnIsIGkpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7XG4gICAgICByZXR1cm4gYXJyO1xuICAgIH0gZWxzZSBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSB7XG4gICAgICByZXR1cm4gc2xpY2VJdGVyYXRvcihhcnIsIGkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZVwiKTtcbiAgICB9XG4gIH07XG59KCk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbnZhciB0b0NvbnN1bWFibGVBcnJheSA9IGZ1bmN0aW9uIChhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkge1xuICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIGFycjJbaV0gPSBhcnJbaV07XG5cbiAgICByZXR1cm4gYXJyMjtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShhcnIpO1xuICB9XG59O1xuXG52YXIgY29uc29sZUxvZ2dlciA9IHtcbiAgdHlwZTogJ2xvZ2dlcicsXG5cbiAgbG9nOiBmdW5jdGlvbiBsb2coYXJncykge1xuICAgIHRoaXMub3V0cHV0KCdsb2cnLCBhcmdzKTtcbiAgfSxcbiAgd2FybjogZnVuY3Rpb24gd2FybihhcmdzKSB7XG4gICAgdGhpcy5vdXRwdXQoJ3dhcm4nLCBhcmdzKTtcbiAgfSxcbiAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKGFyZ3MpIHtcbiAgICB0aGlzLm91dHB1dCgnZXJyb3InLCBhcmdzKTtcbiAgfSxcbiAgb3V0cHV0OiBmdW5jdGlvbiBvdXRwdXQodHlwZSwgYXJncykge1xuICAgIHZhciBfY29uc29sZTtcblxuICAgIC8qIGVzbGludCBuby1jb25zb2xlOiAwICovXG4gICAgaWYgKGNvbnNvbGUgJiYgY29uc29sZVt0eXBlXSkgKF9jb25zb2xlID0gY29uc29sZSlbdHlwZV0uYXBwbHkoX2NvbnNvbGUsIHRvQ29uc3VtYWJsZUFycmF5KGFyZ3MpKTtcbiAgfVxufTtcblxudmFyIExvZ2dlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTG9nZ2VyKGNvbmNyZXRlTG9nZ2VyKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuICAgIGNsYXNzQ2FsbENoZWNrKHRoaXMsIExvZ2dlcik7XG5cbiAgICB0aGlzLmluaXQoY29uY3JldGVMb2dnZXIsIG9wdGlvbnMpO1xuICB9XG5cbiAgTG9nZ2VyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gaW5pdChjb25jcmV0ZUxvZ2dlcikge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgIHRoaXMucHJlZml4ID0gb3B0aW9ucy5wcmVmaXggfHwgJ2kxOG5leHQ6JztcbiAgICB0aGlzLmxvZ2dlciA9IGNvbmNyZXRlTG9nZ2VyIHx8IGNvbnNvbGVMb2dnZXI7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLmRlYnVnID0gb3B0aW9ucy5kZWJ1ZztcbiAgfTtcblxuICBMb2dnZXIucHJvdG90eXBlLnNldERlYnVnID0gZnVuY3Rpb24gc2V0RGVidWcoYm9vbCkge1xuICAgIHRoaXMuZGVidWcgPSBib29sO1xuICB9O1xuXG4gIExvZ2dlci5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gbG9nKCkge1xuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmZvcndhcmQoYXJncywgJ2xvZycsICcnLCB0cnVlKTtcbiAgfTtcblxuICBMb2dnZXIucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbiB3YXJuKCkge1xuICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZm9yd2FyZChhcmdzLCAnd2FybicsICcnLCB0cnVlKTtcbiAgfTtcblxuICBMb2dnZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gZXJyb3IoKSB7XG4gICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbjMpLCBfa2V5MyA9IDA7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgIGFyZ3NbX2tleTNdID0gYXJndW1lbnRzW19rZXkzXTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5mb3J3YXJkKGFyZ3MsICdlcnJvcicsICcnKTtcbiAgfTtcblxuICBMb2dnZXIucHJvdG90eXBlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uIGRlcHJlY2F0ZSgpIHtcbiAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuNCksIF9rZXk0ID0gMDsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykge1xuICAgICAgYXJnc1tfa2V5NF0gPSBhcmd1bWVudHNbX2tleTRdO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmZvcndhcmQoYXJncywgJ3dhcm4nLCAnV0FSTklORyBERVBSRUNBVEVEOiAnLCB0cnVlKTtcbiAgfTtcblxuICBMb2dnZXIucHJvdG90eXBlLmZvcndhcmQgPSBmdW5jdGlvbiBmb3J3YXJkKGFyZ3MsIGx2bCwgcHJlZml4LCBkZWJ1Z09ubHkpIHtcbiAgICBpZiAoZGVidWdPbmx5ICYmICF0aGlzLmRlYnVnKSByZXR1cm4gbnVsbDtcbiAgICBpZiAodHlwZW9mIGFyZ3NbMF0gPT09ICdzdHJpbmcnKSBhcmdzWzBdID0gJycgKyBwcmVmaXggKyB0aGlzLnByZWZpeCArICcgJyArIGFyZ3NbMF07XG4gICAgcmV0dXJuIHRoaXMubG9nZ2VyW2x2bF0oYXJncyk7XG4gIH07XG5cbiAgTG9nZ2VyLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUobW9kdWxlTmFtZSkge1xuICAgIHJldHVybiBuZXcgTG9nZ2VyKHRoaXMubG9nZ2VyLCBfZXh0ZW5kcyh7IHByZWZpeDogdGhpcy5wcmVmaXggKyAnOicgKyBtb2R1bGVOYW1lICsgJzonIH0sIHRoaXMub3B0aW9ucykpO1xuICB9O1xuXG4gIHJldHVybiBMb2dnZXI7XG59KCk7XG5cbnZhciBiYXNlTG9nZ2VyID0gbmV3IExvZ2dlcigpO1xuXG52YXIgRXZlbnRFbWl0dGVyID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRFbWl0dGVyKTtcblxuICAgIHRoaXMub2JzZXJ2ZXJzID0ge307XG4gIH1cblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gZnVuY3Rpb24gb24oZXZlbnRzLCBsaXN0ZW5lcikge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBldmVudHMuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgX3RoaXMub2JzZXJ2ZXJzW2V2ZW50XSA9IF90aGlzLm9ic2VydmVyc1tldmVudF0gfHwgW107XG4gICAgICBfdGhpcy5vYnNlcnZlcnNbZXZlbnRdLnB1c2gobGlzdGVuZXIpO1xuICAgIH0pO1xuICB9O1xuXG4gIEV2ZW50RW1pdHRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gb2ZmKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLm9ic2VydmVyc1tldmVudF0pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLm9ic2VydmVyc1tldmVudF0uZm9yRWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIWxpc3RlbmVyKSB7XG4gICAgICAgIGRlbGV0ZSBfdGhpczIub2JzZXJ2ZXJzW2V2ZW50XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBpbmRleCA9IF90aGlzMi5vYnNlcnZlcnNbZXZlbnRdLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgIF90aGlzMi5vYnNlcnZlcnNbZXZlbnRdLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbiBlbWl0KGV2ZW50KSB7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vYnNlcnZlcnNbZXZlbnRdKSB7XG4gICAgICB2YXIgY2xvbmVkID0gW10uY29uY2F0KHRoaXMub2JzZXJ2ZXJzW2V2ZW50XSk7XG4gICAgICBjbG9uZWQuZm9yRWFjaChmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgb2JzZXJ2ZXIuYXBwbHkodW5kZWZpbmVkLCBhcmdzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLm9ic2VydmVyc1snKiddKSB7XG4gICAgICB2YXIgX2Nsb25lZCA9IFtdLmNvbmNhdCh0aGlzLm9ic2VydmVyc1snKiddKTtcbiAgICAgIF9jbG9uZWQuZm9yRWFjaChmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgdmFyIF9yZWY7XG5cbiAgICAgICAgb2JzZXJ2ZXIuYXBwbHkob2JzZXJ2ZXIsIChfcmVmID0gW2V2ZW50XSkuY29uY2F0LmFwcGx5KF9yZWYsIGFyZ3MpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gRXZlbnRFbWl0dGVyO1xufSgpO1xuXG5mdW5jdGlvbiBtYWtlU3RyaW5nKG9iamVjdCkge1xuICBpZiAob2JqZWN0ID09IG51bGwpIHJldHVybiAnJztcbiAgLyogZXNsaW50IHByZWZlci10ZW1wbGF0ZTogMCAqL1xuICByZXR1cm4gJycgKyBvYmplY3Q7XG59XG5cbmZ1bmN0aW9uIGNvcHkoYSwgcywgdCkge1xuICBhLmZvckVhY2goZnVuY3Rpb24gKG0pIHtcbiAgICBpZiAoc1ttXSkgdFttXSA9IHNbbV07XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRMYXN0T2ZQYXRoKG9iamVjdCwgcGF0aCwgRW1wdHkpIHtcbiAgZnVuY3Rpb24gY2xlYW5LZXkoa2V5KSB7XG4gICAgcmV0dXJuIGtleSAmJiBrZXkuaW5kZXhPZignIyMjJykgPiAtMSA/IGtleS5yZXBsYWNlKC8jIyMvZywgJy4nKSA6IGtleTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbk5vdFRyYXZlcnNlRGVlcGVyKCkge1xuICAgIHJldHVybiAhb2JqZWN0IHx8IHR5cGVvZiBvYmplY3QgPT09ICdzdHJpbmcnO1xuICB9XG5cbiAgdmFyIHN0YWNrID0gdHlwZW9mIHBhdGggIT09ICdzdHJpbmcnID8gW10uY29uY2F0KHBhdGgpIDogcGF0aC5zcGxpdCgnLicpO1xuICB3aGlsZSAoc3RhY2subGVuZ3RoID4gMSkge1xuICAgIGlmIChjYW5Ob3RUcmF2ZXJzZURlZXBlcigpKSByZXR1cm4ge307XG5cbiAgICB2YXIga2V5ID0gY2xlYW5LZXkoc3RhY2suc2hpZnQoKSk7XG4gICAgaWYgKCFvYmplY3Rba2V5XSAmJiBFbXB0eSkgb2JqZWN0W2tleV0gPSBuZXcgRW1wdHkoKTtcbiAgICBvYmplY3QgPSBvYmplY3Rba2V5XTtcbiAgfVxuXG4gIGlmIChjYW5Ob3RUcmF2ZXJzZURlZXBlcigpKSByZXR1cm4ge307XG4gIHJldHVybiB7XG4gICAgb2JqOiBvYmplY3QsXG4gICAgazogY2xlYW5LZXkoc3RhY2suc2hpZnQoKSlcbiAgfTtcbn1cblxuZnVuY3Rpb24gc2V0UGF0aChvYmplY3QsIHBhdGgsIG5ld1ZhbHVlKSB7XG4gIHZhciBfZ2V0TGFzdE9mUGF0aCA9IGdldExhc3RPZlBhdGgob2JqZWN0LCBwYXRoLCBPYmplY3QpLFxuICAgICAgb2JqID0gX2dldExhc3RPZlBhdGgub2JqLFxuICAgICAgayA9IF9nZXRMYXN0T2ZQYXRoLms7XG5cbiAgb2JqW2tdID0gbmV3VmFsdWU7XG59XG5cbmZ1bmN0aW9uIHB1c2hQYXRoKG9iamVjdCwgcGF0aCwgbmV3VmFsdWUsIGNvbmNhdCkge1xuICB2YXIgX2dldExhc3RPZlBhdGgyID0gZ2V0TGFzdE9mUGF0aChvYmplY3QsIHBhdGgsIE9iamVjdCksXG4gICAgICBvYmogPSBfZ2V0TGFzdE9mUGF0aDIub2JqLFxuICAgICAgayA9IF9nZXRMYXN0T2ZQYXRoMi5rO1xuXG4gIG9ialtrXSA9IG9ialtrXSB8fCBbXTtcbiAgaWYgKGNvbmNhdCkgb2JqW2tdID0gb2JqW2tdLmNvbmNhdChuZXdWYWx1ZSk7XG4gIGlmICghY29uY2F0KSBvYmpba10ucHVzaChuZXdWYWx1ZSk7XG59XG5cbmZ1bmN0aW9uIGdldFBhdGgob2JqZWN0LCBwYXRoKSB7XG4gIHZhciBfZ2V0TGFzdE9mUGF0aDMgPSBnZXRMYXN0T2ZQYXRoKG9iamVjdCwgcGF0aCksXG4gICAgICBvYmogPSBfZ2V0TGFzdE9mUGF0aDMub2JqLFxuICAgICAgayA9IF9nZXRMYXN0T2ZQYXRoMy5rO1xuXG4gIGlmICghb2JqKSByZXR1cm4gdW5kZWZpbmVkO1xuICByZXR1cm4gb2JqW2tdO1xufVxuXG5mdW5jdGlvbiBkZWVwRXh0ZW5kKHRhcmdldCwgc291cmNlLCBvdmVyd3JpdGUpIHtcbiAgLyogZXNsaW50IG5vLXJlc3RyaWN0ZWQtc3ludGF4OiAwICovXG4gIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG4gICAgaWYgKHByb3AgaW4gdGFyZ2V0KSB7XG4gICAgICAvLyBJZiB3ZSByZWFjaGVkIGEgbGVhZiBzdHJpbmcgaW4gdGFyZ2V0IG9yIHNvdXJjZSB0aGVuIHJlcGxhY2Ugd2l0aCBzb3VyY2Ugb3Igc2tpcCBkZXBlbmRpbmcgb24gdGhlICdvdmVyd3JpdGUnIHN3aXRjaFxuICAgICAgaWYgKHR5cGVvZiB0YXJnZXRbcHJvcF0gPT09ICdzdHJpbmcnIHx8IHRhcmdldFtwcm9wXSBpbnN0YW5jZW9mIFN0cmluZyB8fCB0eXBlb2Ygc291cmNlW3Byb3BdID09PSAnc3RyaW5nJyB8fCBzb3VyY2VbcHJvcF0gaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICAgICAgaWYgKG92ZXJ3cml0ZSkgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVlcEV4dGVuZCh0YXJnZXRbcHJvcF0sIHNvdXJjZVtwcm9wXSwgb3ZlcndyaXRlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdGFyZ2V0O1xufVxuXG5mdW5jdGlvbiByZWdleEVzY2FwZShzdHIpIHtcbiAgLyogZXNsaW50IG5vLXVzZWxlc3MtZXNjYXBlOiAwICovXG4gIHJldHVybiBzdHIucmVwbGFjZSgvW1xcLVxcW1xcXVxcL1xce1xcfVxcKFxcKVxcKlxcK1xcP1xcLlxcXFxcXF5cXCRcXHxdL2csICdcXFxcJCYnKTtcbn1cblxuLyogZXNsaW50LWRpc2FibGUgKi9cbnZhciBfZW50aXR5TWFwID0ge1xuICBcIiZcIjogXCImYW1wO1wiLFxuICBcIjxcIjogXCImbHQ7XCIsXG4gIFwiPlwiOiBcIiZndDtcIixcbiAgJ1wiJzogJyZxdW90OycsXG4gIFwiJ1wiOiAnJiMzOTsnLFxuICBcIi9cIjogJyYjeDJGOydcbn07XG4vKiBlc2xpbnQtZW5hYmxlICovXG5cbmZ1bmN0aW9uIGVzY2FwZShkYXRhKSB7XG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZGF0YS5yZXBsYWNlKC9bJjw+XCInXFwvXS9nLCBmdW5jdGlvbiAocykge1xuICAgICAgcmV0dXJuIF9lbnRpdHlNYXBbc107XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gZGF0YTtcbn1cblxudmFyIFJlc291cmNlU3RvcmUgPSBmdW5jdGlvbiAoX0V2ZW50RW1pdHRlcikge1xuICBpbmhlcml0cyhSZXNvdXJjZVN0b3JlLCBfRXZlbnRFbWl0dGVyKTtcblxuICBmdW5jdGlvbiBSZXNvdXJjZVN0b3JlKGRhdGEpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogeyBuczogWyd0cmFuc2xhdGlvbiddLCBkZWZhdWx0TlM6ICd0cmFuc2xhdGlvbicgfTtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBSZXNvdXJjZVN0b3JlKTtcblxuICAgIHZhciBfdGhpcyA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V2ZW50RW1pdHRlci5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzLmRhdGEgPSBkYXRhIHx8IHt9O1xuICAgIF90aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIFJlc291cmNlU3RvcmUucHJvdG90eXBlLmFkZE5hbWVzcGFjZXMgPSBmdW5jdGlvbiBhZGROYW1lc3BhY2VzKG5zKSB7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5ucy5pbmRleE9mKG5zKSA8IDApIHtcbiAgICAgIHRoaXMub3B0aW9ucy5ucy5wdXNoKG5zKTtcbiAgICB9XG4gIH07XG5cbiAgUmVzb3VyY2VTdG9yZS5wcm90b3R5cGUucmVtb3ZlTmFtZXNwYWNlcyA9IGZ1bmN0aW9uIHJlbW92ZU5hbWVzcGFjZXMobnMpIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLm9wdGlvbnMubnMuaW5kZXhPZihucyk7XG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5ucy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgfTtcblxuICBSZXNvdXJjZVN0b3JlLnByb3RvdHlwZS5nZXRSZXNvdXJjZSA9IGZ1bmN0aW9uIGdldFJlc291cmNlKGxuZywgbnMsIGtleSkge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB7fTtcblxuICAgIHZhciBrZXlTZXBhcmF0b3IgPSBvcHRpb25zLmtleVNlcGFyYXRvciB8fCB0aGlzLm9wdGlvbnMua2V5U2VwYXJhdG9yO1xuICAgIGlmIChrZXlTZXBhcmF0b3IgPT09IHVuZGVmaW5lZCkga2V5U2VwYXJhdG9yID0gJy4nO1xuXG4gICAgdmFyIHBhdGggPSBbbG5nLCBuc107XG4gICAgaWYgKGtleSAmJiB0eXBlb2Yga2V5ICE9PSAnc3RyaW5nJykgcGF0aCA9IHBhdGguY29uY2F0KGtleSk7XG4gICAgaWYgKGtleSAmJiB0eXBlb2Yga2V5ID09PSAnc3RyaW5nJykgcGF0aCA9IHBhdGguY29uY2F0KGtleVNlcGFyYXRvciA/IGtleS5zcGxpdChrZXlTZXBhcmF0b3IpIDoga2V5KTtcblxuICAgIGlmIChsbmcuaW5kZXhPZignLicpID4gLTEpIHtcbiAgICAgIHBhdGggPSBsbmcuc3BsaXQoJy4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0UGF0aCh0aGlzLmRhdGEsIHBhdGgpO1xuICB9O1xuXG4gIFJlc291cmNlU3RvcmUucHJvdG90eXBlLmFkZFJlc291cmNlID0gZnVuY3Rpb24gYWRkUmVzb3VyY2UobG5nLCBucywga2V5LCB2YWx1ZSkge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDQgJiYgYXJndW1lbnRzWzRdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNF0gOiB7IHNpbGVudDogZmFsc2UgfTtcblxuICAgIHZhciBrZXlTZXBhcmF0b3IgPSB0aGlzLm9wdGlvbnMua2V5U2VwYXJhdG9yO1xuICAgIGlmIChrZXlTZXBhcmF0b3IgPT09IHVuZGVmaW5lZCkga2V5U2VwYXJhdG9yID0gJy4nO1xuXG4gICAgdmFyIHBhdGggPSBbbG5nLCBuc107XG4gICAgaWYgKGtleSkgcGF0aCA9IHBhdGguY29uY2F0KGtleVNlcGFyYXRvciA/IGtleS5zcGxpdChrZXlTZXBhcmF0b3IpIDoga2V5KTtcblxuICAgIGlmIChsbmcuaW5kZXhPZignLicpID4gLTEpIHtcbiAgICAgIHBhdGggPSBsbmcuc3BsaXQoJy4nKTtcbiAgICAgIHZhbHVlID0gbnM7XG4gICAgICBucyA9IHBhdGhbMV07XG4gICAgfVxuXG4gICAgdGhpcy5hZGROYW1lc3BhY2VzKG5zKTtcblxuICAgIHNldFBhdGgodGhpcy5kYXRhLCBwYXRoLCB2YWx1ZSk7XG5cbiAgICBpZiAoIW9wdGlvbnMuc2lsZW50KSB0aGlzLmVtaXQoJ2FkZGVkJywgbG5nLCBucywga2V5LCB2YWx1ZSk7XG4gIH07XG5cbiAgUmVzb3VyY2VTdG9yZS5wcm90b3R5cGUuYWRkUmVzb3VyY2VzID0gZnVuY3Rpb24gYWRkUmVzb3VyY2VzKGxuZywgbnMsIHJlc291cmNlcykge1xuICAgIC8qIGVzbGludCBuby1yZXN0cmljdGVkLXN5bnRheDogMCAqL1xuICAgIGZvciAodmFyIG0gaW4gcmVzb3VyY2VzKSB7XG4gICAgICBpZiAodHlwZW9mIHJlc291cmNlc1ttXSA9PT0gJ3N0cmluZycpIHRoaXMuYWRkUmVzb3VyY2UobG5nLCBucywgbSwgcmVzb3VyY2VzW21dLCB7IHNpbGVudDogdHJ1ZSB9KTtcbiAgICB9XG4gICAgdGhpcy5lbWl0KCdhZGRlZCcsIGxuZywgbnMsIHJlc291cmNlcyk7XG4gIH07XG5cbiAgUmVzb3VyY2VTdG9yZS5wcm90b3R5cGUuYWRkUmVzb3VyY2VCdW5kbGUgPSBmdW5jdGlvbiBhZGRSZXNvdXJjZUJ1bmRsZShsbmcsIG5zLCByZXNvdXJjZXMsIGRlZXAsIG92ZXJ3cml0ZSkge1xuICAgIHZhciBwYXRoID0gW2xuZywgbnNdO1xuICAgIGlmIChsbmcuaW5kZXhPZignLicpID4gLTEpIHtcbiAgICAgIHBhdGggPSBsbmcuc3BsaXQoJy4nKTtcbiAgICAgIGRlZXAgPSByZXNvdXJjZXM7XG4gICAgICByZXNvdXJjZXMgPSBucztcbiAgICAgIG5zID0gcGF0aFsxXTtcbiAgICB9XG5cbiAgICB0aGlzLmFkZE5hbWVzcGFjZXMobnMpO1xuXG4gICAgdmFyIHBhY2sgPSBnZXRQYXRoKHRoaXMuZGF0YSwgcGF0aCkgfHwge307XG5cbiAgICBpZiAoZGVlcCkge1xuICAgICAgZGVlcEV4dGVuZChwYWNrLCByZXNvdXJjZXMsIG92ZXJ3cml0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhY2sgPSBfZXh0ZW5kcyh7fSwgcGFjaywgcmVzb3VyY2VzKTtcbiAgICB9XG5cbiAgICBzZXRQYXRoKHRoaXMuZGF0YSwgcGF0aCwgcGFjayk7XG5cbiAgICB0aGlzLmVtaXQoJ2FkZGVkJywgbG5nLCBucywgcmVzb3VyY2VzKTtcbiAgfTtcblxuICBSZXNvdXJjZVN0b3JlLnByb3RvdHlwZS5yZW1vdmVSZXNvdXJjZUJ1bmRsZSA9IGZ1bmN0aW9uIHJlbW92ZVJlc291cmNlQnVuZGxlKGxuZywgbnMpIHtcbiAgICBpZiAodGhpcy5oYXNSZXNvdXJjZUJ1bmRsZShsbmcsIG5zKSkge1xuICAgICAgZGVsZXRlIHRoaXMuZGF0YVtsbmddW25zXTtcbiAgICB9XG4gICAgdGhpcy5yZW1vdmVOYW1lc3BhY2VzKG5zKTtcblxuICAgIHRoaXMuZW1pdCgncmVtb3ZlZCcsIGxuZywgbnMpO1xuICB9O1xuXG4gIFJlc291cmNlU3RvcmUucHJvdG90eXBlLmhhc1Jlc291cmNlQnVuZGxlID0gZnVuY3Rpb24gaGFzUmVzb3VyY2VCdW5kbGUobG5nLCBucykge1xuICAgIHJldHVybiB0aGlzLmdldFJlc291cmNlKGxuZywgbnMpICE9PSB1bmRlZmluZWQ7XG4gIH07XG5cbiAgUmVzb3VyY2VTdG9yZS5wcm90b3R5cGUuZ2V0UmVzb3VyY2VCdW5kbGUgPSBmdW5jdGlvbiBnZXRSZXNvdXJjZUJ1bmRsZShsbmcsIG5zKSB7XG4gICAgaWYgKCFucykgbnMgPSB0aGlzLm9wdGlvbnMuZGVmYXVsdE5TO1xuXG4gICAgLy8gQ09NUEFUSUJJTElUWTogcmVtb3ZlIGV4dGVuZCBpbiB2Mi4xLjBcbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhdGliaWxpdHlBUEkgPT09ICd2MScpIHJldHVybiBfZXh0ZW5kcyh7fSwgdGhpcy5nZXRSZXNvdXJjZShsbmcsIG5zKSk7XG5cbiAgICByZXR1cm4gdGhpcy5nZXRSZXNvdXJjZShsbmcsIG5zKTtcbiAgfTtcblxuICBSZXNvdXJjZVN0b3JlLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgfTtcblxuICByZXR1cm4gUmVzb3VyY2VTdG9yZTtcbn0oRXZlbnRFbWl0dGVyKTtcblxudmFyIHBvc3RQcm9jZXNzb3IgPSB7XG5cbiAgcHJvY2Vzc29yczoge30sXG5cbiAgYWRkUG9zdFByb2Nlc3NvcjogZnVuY3Rpb24gYWRkUG9zdFByb2Nlc3Nvcihtb2R1bGUpIHtcbiAgICB0aGlzLnByb2Nlc3NvcnNbbW9kdWxlLm5hbWVdID0gbW9kdWxlO1xuICB9LFxuICBoYW5kbGU6IGZ1bmN0aW9uIGhhbmRsZShwcm9jZXNzb3JzLCB2YWx1ZSwga2V5LCBvcHRpb25zLCB0cmFuc2xhdG9yKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHByb2Nlc3NvcnMuZm9yRWFjaChmdW5jdGlvbiAocHJvY2Vzc29yKSB7XG4gICAgICBpZiAoX3RoaXMucHJvY2Vzc29yc1twcm9jZXNzb3JdKSB2YWx1ZSA9IF90aGlzLnByb2Nlc3NvcnNbcHJvY2Vzc29yXS5wcm9jZXNzKHZhbHVlLCBrZXksIG9wdGlvbnMsIHRyYW5zbGF0b3IpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59O1xuXG52YXIgVHJhbnNsYXRvciA9IGZ1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7XG4gIGluaGVyaXRzKFRyYW5zbGF0b3IsIF9FdmVudEVtaXR0ZXIpO1xuXG4gIGZ1bmN0aW9uIFRyYW5zbGF0b3Ioc2VydmljZXMpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJhbnNsYXRvcik7XG5cbiAgICB2YXIgX3RoaXMgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FdmVudEVtaXR0ZXIuY2FsbCh0aGlzKSk7XG5cbiAgICBjb3B5KFsncmVzb3VyY2VTdG9yZScsICdsYW5ndWFnZVV0aWxzJywgJ3BsdXJhbFJlc29sdmVyJywgJ2ludGVycG9sYXRvcicsICdiYWNrZW5kQ29ubmVjdG9yJ10sIHNlcnZpY2VzLCBfdGhpcyk7XG5cbiAgICBfdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBfdGhpcy5sb2dnZXIgPSBiYXNlTG9nZ2VyLmNyZWF0ZSgndHJhbnNsYXRvcicpO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIFRyYW5zbGF0b3IucHJvdG90eXBlLmNoYW5nZUxhbmd1YWdlID0gZnVuY3Rpb24gY2hhbmdlTGFuZ3VhZ2UobG5nKSB7XG4gICAgaWYgKGxuZykgdGhpcy5sYW5ndWFnZSA9IGxuZztcbiAgfTtcblxuICBUcmFuc2xhdG9yLnByb3RvdHlwZS5leGlzdHMgPSBmdW5jdGlvbiBleGlzdHMoa2V5KSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHsgaW50ZXJwb2xhdGlvbjoge30gfTtcblxuICAgIHZhciByZXNvbHZlZCA9IHRoaXMucmVzb2x2ZShrZXksIG9wdGlvbnMpO1xuICAgIHJldHVybiByZXNvbHZlZCAmJiByZXNvbHZlZC5yZXMgIT09IHVuZGVmaW5lZDtcbiAgfTtcblxuICBUcmFuc2xhdG9yLnByb3RvdHlwZS5leHRyYWN0RnJvbUtleSA9IGZ1bmN0aW9uIGV4dHJhY3RGcm9tS2V5KGtleSwgb3B0aW9ucykge1xuICAgIHZhciBuc1NlcGFyYXRvciA9IG9wdGlvbnMubnNTZXBhcmF0b3IgfHwgdGhpcy5vcHRpb25zLm5zU2VwYXJhdG9yO1xuICAgIGlmIChuc1NlcGFyYXRvciA9PT0gdW5kZWZpbmVkKSBuc1NlcGFyYXRvciA9ICc6JztcbiAgICB2YXIga2V5U2VwYXJhdG9yID0gb3B0aW9ucy5rZXlTZXBhcmF0b3IgfHwgdGhpcy5vcHRpb25zLmtleVNlcGFyYXRvciB8fCAnLic7XG5cbiAgICB2YXIgbmFtZXNwYWNlcyA9IG9wdGlvbnMubnMgfHwgdGhpcy5vcHRpb25zLmRlZmF1bHROUztcbiAgICBpZiAobnNTZXBhcmF0b3IgJiYga2V5LmluZGV4T2YobnNTZXBhcmF0b3IpID4gLTEpIHtcbiAgICAgIHZhciBwYXJ0cyA9IGtleS5zcGxpdChuc1NlcGFyYXRvcik7XG4gICAgICBpZiAobnNTZXBhcmF0b3IgIT09IGtleVNlcGFyYXRvciB8fCBuc1NlcGFyYXRvciA9PT0ga2V5U2VwYXJhdG9yICYmIHRoaXMub3B0aW9ucy5ucy5pbmRleE9mKHBhcnRzWzBdKSA+IC0xKSBuYW1lc3BhY2VzID0gcGFydHMuc2hpZnQoKTtcbiAgICAgIGtleSA9IHBhcnRzLmpvaW4oa2V5U2VwYXJhdG9yKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2VzID09PSAnc3RyaW5nJykgbmFtZXNwYWNlcyA9IFtuYW1lc3BhY2VzXTtcblxuICAgIHJldHVybiB7XG4gICAgICBrZXk6IGtleSxcbiAgICAgIG5hbWVzcGFjZXM6IG5hbWVzcGFjZXNcbiAgICB9O1xuICB9O1xuXG4gIFRyYW5zbGF0b3IucHJvdG90eXBlLnRyYW5zbGF0ZSA9IGZ1bmN0aW9uIHRyYW5zbGF0ZShrZXlzKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgaWYgKCh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2Yob3B0aW9ucykpICE9PSAnb2JqZWN0Jykge1xuICAgICAgLyogZXNsaW50IHByZWZlci1yZXN0LXBhcmFtczogMCAqL1xuICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucy5vdmVybG9hZFRyYW5zbGF0aW9uT3B0aW9uSGFuZGxlcihhcmd1bWVudHMpO1xuICAgIH1cblxuICAgIC8vIG5vbiB2YWxpZCBrZXlzIGhhbmRsaW5nXG4gICAgaWYgKGtleXMgPT09IHVuZGVmaW5lZCB8fCBrZXlzID09PSBudWxsIHx8IGtleXMgPT09ICcnKSByZXR1cm4gJyc7XG4gICAgaWYgKHR5cGVvZiBrZXlzID09PSAnbnVtYmVyJykga2V5cyA9IFN0cmluZyhrZXlzKTtcbiAgICBpZiAodHlwZW9mIGtleXMgPT09ICdzdHJpbmcnKSBrZXlzID0gW2tleXNdO1xuXG4gICAgLy8gc2VwYXJhdG9yc1xuICAgIHZhciBrZXlTZXBhcmF0b3IgPSBvcHRpb25zLmtleVNlcGFyYXRvciB8fCB0aGlzLm9wdGlvbnMua2V5U2VwYXJhdG9yIHx8ICcuJztcblxuICAgIC8vIGdldCBuYW1lc3BhY2UocylcblxuICAgIHZhciBfZXh0cmFjdEZyb21LZXkgPSB0aGlzLmV4dHJhY3RGcm9tS2V5KGtleXNba2V5cy5sZW5ndGggLSAxXSwgb3B0aW9ucyksXG4gICAgICAgIGtleSA9IF9leHRyYWN0RnJvbUtleS5rZXksXG4gICAgICAgIG5hbWVzcGFjZXMgPSBfZXh0cmFjdEZyb21LZXkubmFtZXNwYWNlcztcblxuICAgIHZhciBuYW1lc3BhY2UgPSBuYW1lc3BhY2VzW25hbWVzcGFjZXMubGVuZ3RoIC0gMV07XG5cbiAgICAvLyByZXR1cm4ga2V5IG9uIENJTW9kZVxuICAgIHZhciBsbmcgPSBvcHRpb25zLmxuZyB8fCB0aGlzLmxhbmd1YWdlO1xuICAgIHZhciBhcHBlbmROYW1lc3BhY2VUb0NJTW9kZSA9IG9wdGlvbnMuYXBwZW5kTmFtZXNwYWNlVG9DSU1vZGUgfHwgdGhpcy5vcHRpb25zLmFwcGVuZE5hbWVzcGFjZVRvQ0lNb2RlO1xuICAgIGlmIChsbmcgJiYgbG5nLnRvTG93ZXJDYXNlKCkgPT09ICdjaW1vZGUnKSB7XG4gICAgICBpZiAoYXBwZW5kTmFtZXNwYWNlVG9DSU1vZGUpIHtcbiAgICAgICAgdmFyIG5zU2VwYXJhdG9yID0gb3B0aW9ucy5uc1NlcGFyYXRvciB8fCB0aGlzLm9wdGlvbnMubnNTZXBhcmF0b3I7XG4gICAgICAgIHJldHVybiBuYW1lc3BhY2UgKyBuc1NlcGFyYXRvciArIGtleTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9XG5cbiAgICAvLyByZXNvbHZlIGZyb20gc3RvcmVcbiAgICB2YXIgcmVzb2x2ZWQgPSB0aGlzLnJlc29sdmUoa2V5cywgb3B0aW9ucyk7XG4gICAgdmFyIHJlcyA9IHJlc29sdmVkICYmIHJlc29sdmVkLnJlcztcbiAgICB2YXIgdXNlZEtleSA9IHJlc29sdmVkICYmIHJlc29sdmVkLnVzZWRLZXkgfHwga2V5O1xuXG4gICAgdmFyIHJlc1R5cGUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KHJlcyk7XG4gICAgdmFyIG5vT2JqZWN0ID0gWydbb2JqZWN0IE51bWJlcl0nLCAnW29iamVjdCBGdW5jdGlvbl0nLCAnW29iamVjdCBSZWdFeHBdJ107XG4gICAgdmFyIGpvaW5BcnJheXMgPSBvcHRpb25zLmpvaW5BcnJheXMgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuam9pbkFycmF5cyA6IHRoaXMub3B0aW9ucy5qb2luQXJyYXlzO1xuXG4gICAgLy8gb2JqZWN0XG4gICAgaWYgKHJlcyAmJiB0eXBlb2YgcmVzICE9PSAnc3RyaW5nJyAmJiBub09iamVjdC5pbmRleE9mKHJlc1R5cGUpIDwgMCAmJiAhKGpvaW5BcnJheXMgJiYgcmVzVHlwZSA9PT0gJ1tvYmplY3QgQXJyYXldJykpIHtcbiAgICAgIGlmICghb3B0aW9ucy5yZXR1cm5PYmplY3RzICYmICF0aGlzLm9wdGlvbnMucmV0dXJuT2JqZWN0cykge1xuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdhY2Nlc3NpbmcgYW4gb2JqZWN0IC0gYnV0IHJldHVybk9iamVjdHMgb3B0aW9ucyBpcyBub3QgZW5hYmxlZCEnKTtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5yZXR1cm5lZE9iamVjdEhhbmRsZXIgPyB0aGlzLm9wdGlvbnMucmV0dXJuZWRPYmplY3RIYW5kbGVyKHVzZWRLZXksIHJlcywgb3B0aW9ucykgOiAna2V5IFxcJycgKyBrZXkgKyAnICgnICsgdGhpcy5sYW5ndWFnZSArICcpXFwnIHJldHVybmVkIGFuIG9iamVjdCBpbnN0ZWFkIG9mIHN0cmluZy4nO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiB3ZSBnb3QgYSBzZXBhcmF0b3Igd2UgbG9vcCBvdmVyIGNoaWxkcmVuIC0gZWxzZSB3ZSBqdXN0IHJldHVybiBvYmplY3QgYXMgaXNcbiAgICAgIC8vIGFzIGhhdmluZyBpdCBzZXQgdG8gZmFsc2UgbWVhbnMgbm8gaGllcmFyY2h5IHNvIG5vIGxvb2t1cCBmb3IgbmVzdGVkIHZhbHVlc1xuICAgICAgaWYgKG9wdGlvbnMua2V5U2VwYXJhdG9yIHx8IHRoaXMub3B0aW9ucy5rZXlTZXBhcmF0b3IpIHtcbiAgICAgICAgdmFyIGNvcHkkJDEgPSByZXNUeXBlID09PSAnW29iamVjdCBBcnJheV0nID8gW10gOiB7fTsgLy8gYXBwbHkgY2hpbGQgdHJhbnNsYXRpb24gb24gYSBjb3B5XG5cbiAgICAgICAgLyogZXNsaW50IG5vLXJlc3RyaWN0ZWQtc3ludGF4OiAwICovXG4gICAgICAgIGZvciAodmFyIG0gaW4gcmVzKSB7XG4gICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChyZXMsIG0pKSB7XG4gICAgICAgICAgICBjb3B5JCQxW21dID0gdGhpcy50cmFuc2xhdGUoJycgKyB1c2VkS2V5ICsga2V5U2VwYXJhdG9yICsgbSwgX2V4dGVuZHMoe30sIG9wdGlvbnMsIHsgam9pbkFycmF5czogZmFsc2UsIG5zOiBuYW1lc3BhY2VzIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVzID0gY29weSQkMTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGpvaW5BcnJheXMgJiYgcmVzVHlwZSA9PT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgLy8gYXJyYXkgc3BlY2lhbCB0cmVhdG1lbnRcbiAgICAgIHJlcyA9IHJlcy5qb2luKGpvaW5BcnJheXMpO1xuICAgICAgaWYgKHJlcykgcmVzID0gdGhpcy5leHRlbmRUcmFuc2xhdGlvbihyZXMsIGtleXMsIG9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzdHJpbmcsIGVtcHR5IG9yIG51bGxcbiAgICAgIHZhciB1c2VkRGVmYXVsdCA9IGZhbHNlO1xuICAgICAgdmFyIF91c2VkS2V5ID0gZmFsc2U7XG5cbiAgICAgIC8vIGZhbGxiYWNrIHZhbHVlXG4gICAgICBpZiAoIXRoaXMuaXNWYWxpZExvb2t1cChyZXMpICYmIG9wdGlvbnMuZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXNlZERlZmF1bHQgPSB0cnVlO1xuICAgICAgICByZXMgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5pc1ZhbGlkTG9va3VwKHJlcykpIHtcbiAgICAgICAgX3VzZWRLZXkgPSB0cnVlO1xuICAgICAgICByZXMgPSBrZXk7XG4gICAgICB9XG5cbiAgICAgIC8vIHNhdmUgbWlzc2luZ1xuICAgICAgaWYgKF91c2VkS2V5IHx8IHVzZWREZWZhdWx0KSB7XG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZygnbWlzc2luZ0tleScsIGxuZywgbmFtZXNwYWNlLCBrZXksIHJlcyk7XG5cbiAgICAgICAgdmFyIGxuZ3MgPSBbXTtcbiAgICAgICAgdmFyIGZhbGxiYWNrTG5ncyA9IHRoaXMubGFuZ3VhZ2VVdGlscy5nZXRGYWxsYmFja0NvZGVzKHRoaXMub3B0aW9ucy5mYWxsYmFja0xuZywgb3B0aW9ucy5sbmcgfHwgdGhpcy5sYW5ndWFnZSk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2F2ZU1pc3NpbmdUbyA9PT0gJ2ZhbGxiYWNrJyAmJiBmYWxsYmFja0xuZ3MgJiYgZmFsbGJhY2tMbmdzWzBdKSB7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYWxsYmFja0xuZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxuZ3MucHVzaChmYWxsYmFja0xuZ3NbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuc2F2ZU1pc3NpbmdUbyA9PT0gJ2FsbCcpIHtcbiAgICAgICAgICBsbmdzID0gdGhpcy5sYW5ndWFnZVV0aWxzLnRvUmVzb2x2ZUhpZXJhcmNoeShvcHRpb25zLmxuZyB8fCB0aGlzLmxhbmd1YWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsbmdzLnB1c2gob3B0aW9ucy5sbmcgfHwgdGhpcy5sYW5ndWFnZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnNhdmVNaXNzaW5nKSB7XG4gICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5taXNzaW5nS2V5SGFuZGxlcikge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm1pc3NpbmdLZXlIYW5kbGVyKGxuZ3MsIG5hbWVzcGFjZSwga2V5LCByZXMpO1xuICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5iYWNrZW5kQ29ubmVjdG9yICYmIHRoaXMuYmFja2VuZENvbm5lY3Rvci5zYXZlTWlzc2luZykge1xuICAgICAgICAgICAgdGhpcy5iYWNrZW5kQ29ubmVjdG9yLnNhdmVNaXNzaW5nKGxuZ3MsIG5hbWVzcGFjZSwga2V5LCByZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZW1pdCgnbWlzc2luZ0tleScsIGxuZ3MsIG5hbWVzcGFjZSwga2V5LCByZXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBleHRlbmRcbiAgICAgIHJlcyA9IHRoaXMuZXh0ZW5kVHJhbnNsYXRpb24ocmVzLCBrZXlzLCBvcHRpb25zKTtcblxuICAgICAgLy8gYXBwZW5kIG5hbWVzcGFjZSBpZiBzdGlsbCBrZXlcbiAgICAgIGlmIChfdXNlZEtleSAmJiByZXMgPT09IGtleSAmJiB0aGlzLm9wdGlvbnMuYXBwZW5kTmFtZXNwYWNlVG9NaXNzaW5nS2V5KSByZXMgPSBuYW1lc3BhY2UgKyAnOicgKyBrZXk7XG5cbiAgICAgIC8vIHBhcnNlTWlzc2luZ0tleUhhbmRsZXJcbiAgICAgIGlmIChfdXNlZEtleSAmJiB0aGlzLm9wdGlvbnMucGFyc2VNaXNzaW5nS2V5SGFuZGxlcikgcmVzID0gdGhpcy5vcHRpb25zLnBhcnNlTWlzc2luZ0tleUhhbmRsZXIocmVzKTtcbiAgICB9XG5cbiAgICAvLyByZXR1cm5cbiAgICByZXR1cm4gcmVzO1xuICB9O1xuXG4gIFRyYW5zbGF0b3IucHJvdG90eXBlLmV4dGVuZFRyYW5zbGF0aW9uID0gZnVuY3Rpb24gZXh0ZW5kVHJhbnNsYXRpb24ocmVzLCBrZXksIG9wdGlvbnMpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIGlmIChvcHRpb25zLmludGVycG9sYXRpb24pIHRoaXMuaW50ZXJwb2xhdG9yLmluaXQoX2V4dGVuZHMoe30sIG9wdGlvbnMsIHsgaW50ZXJwb2xhdGlvbjogX2V4dGVuZHMoe30sIHRoaXMub3B0aW9ucy5pbnRlcnBvbGF0aW9uLCBvcHRpb25zLmludGVycG9sYXRpb24pIH0pKTtcblxuICAgIC8vIGludGVycG9sYXRlXG4gICAgdmFyIGRhdGEgPSBvcHRpb25zLnJlcGxhY2UgJiYgdHlwZW9mIG9wdGlvbnMucmVwbGFjZSAhPT0gJ3N0cmluZycgPyBvcHRpb25zLnJlcGxhY2UgOiBvcHRpb25zO1xuICAgIGlmICh0aGlzLm9wdGlvbnMuaW50ZXJwb2xhdGlvbi5kZWZhdWx0VmFyaWFibGVzKSBkYXRhID0gX2V4dGVuZHMoe30sIHRoaXMub3B0aW9ucy5pbnRlcnBvbGF0aW9uLmRlZmF1bHRWYXJpYWJsZXMsIGRhdGEpO1xuICAgIHJlcyA9IHRoaXMuaW50ZXJwb2xhdG9yLmludGVycG9sYXRlKHJlcywgZGF0YSwgb3B0aW9ucy5sbmcgfHwgdGhpcy5sYW5ndWFnZSk7XG5cbiAgICAvLyBuZXN0aW5nXG4gICAgaWYgKG9wdGlvbnMubmVzdCAhPT0gZmFsc2UpIHJlcyA9IHRoaXMuaW50ZXJwb2xhdG9yLm5lc3QocmVzLCBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gX3RoaXMyLnRyYW5zbGF0ZS5hcHBseShfdGhpczIsIGFyZ3VtZW50cyk7XG4gICAgfSwgb3B0aW9ucyk7XG5cbiAgICBpZiAob3B0aW9ucy5pbnRlcnBvbGF0aW9uKSB0aGlzLmludGVycG9sYXRvci5yZXNldCgpO1xuXG4gICAgLy8gcG9zdCBwcm9jZXNzXG4gICAgdmFyIHBvc3RQcm9jZXNzID0gb3B0aW9ucy5wb3N0UHJvY2VzcyB8fCB0aGlzLm9wdGlvbnMucG9zdFByb2Nlc3M7XG4gICAgdmFyIHBvc3RQcm9jZXNzb3JOYW1lcyA9IHR5cGVvZiBwb3N0UHJvY2VzcyA9PT0gJ3N0cmluZycgPyBbcG9zdFByb2Nlc3NdIDogcG9zdFByb2Nlc3M7XG5cbiAgICBpZiAocmVzICE9PSB1bmRlZmluZWQgJiYgcG9zdFByb2Nlc3Nvck5hbWVzICYmIHBvc3RQcm9jZXNzb3JOYW1lcy5sZW5ndGggJiYgb3B0aW9ucy5hcHBseVBvc3RQcm9jZXNzb3IgIT09IGZhbHNlKSB7XG4gICAgICByZXMgPSBwb3N0UHJvY2Vzc29yLmhhbmRsZShwb3N0UHJvY2Vzc29yTmFtZXMsIHJlcywga2V5LCBvcHRpb25zLCB0aGlzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzO1xuICB9O1xuXG4gIFRyYW5zbGF0b3IucHJvdG90eXBlLnJlc29sdmUgPSBmdW5jdGlvbiByZXNvbHZlKGtleXMpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgIHZhciBmb3VuZCA9IHZvaWQgMDtcbiAgICB2YXIgdXNlZEtleSA9IHZvaWQgMDtcblxuICAgIGlmICh0eXBlb2Yga2V5cyA9PT0gJ3N0cmluZycpIGtleXMgPSBba2V5c107XG5cbiAgICAvLyBmb3JFYWNoIHBvc3NpYmxlIGtleVxuICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgICAgaWYgKF90aGlzMy5pc1ZhbGlkTG9va3VwKGZvdW5kKSkgcmV0dXJuO1xuICAgICAgdmFyIGV4dHJhY3RlZCA9IF90aGlzMy5leHRyYWN0RnJvbUtleShrLCBvcHRpb25zKTtcbiAgICAgIHZhciBrZXkgPSBleHRyYWN0ZWQua2V5O1xuICAgICAgdXNlZEtleSA9IGtleTtcbiAgICAgIHZhciBuYW1lc3BhY2VzID0gZXh0cmFjdGVkLm5hbWVzcGFjZXM7XG4gICAgICBpZiAoX3RoaXMzLm9wdGlvbnMuZmFsbGJhY2tOUykgbmFtZXNwYWNlcyA9IG5hbWVzcGFjZXMuY29uY2F0KF90aGlzMy5vcHRpb25zLmZhbGxiYWNrTlMpO1xuXG4gICAgICB2YXIgbmVlZHNQbHVyYWxIYW5kbGluZyA9IG9wdGlvbnMuY291bnQgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb3B0aW9ucy5jb3VudCAhPT0gJ3N0cmluZyc7XG4gICAgICB2YXIgbmVlZHNDb250ZXh0SGFuZGxpbmcgPSBvcHRpb25zLmNvbnRleHQgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2Ygb3B0aW9ucy5jb250ZXh0ID09PSAnc3RyaW5nJyAmJiBvcHRpb25zLmNvbnRleHQgIT09ICcnO1xuXG4gICAgICB2YXIgY29kZXMgPSBvcHRpb25zLmxuZ3MgPyBvcHRpb25zLmxuZ3MgOiBfdGhpczMubGFuZ3VhZ2VVdGlscy50b1Jlc29sdmVIaWVyYXJjaHkob3B0aW9ucy5sbmcgfHwgX3RoaXMzLmxhbmd1YWdlKTtcblxuICAgICAgbmFtZXNwYWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChucykge1xuICAgICAgICBpZiAoX3RoaXMzLmlzVmFsaWRMb29rdXAoZm91bmQpKSByZXR1cm47XG5cbiAgICAgICAgY29kZXMuZm9yRWFjaChmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICAgIGlmIChfdGhpczMuaXNWYWxpZExvb2t1cChmb3VuZCkpIHJldHVybjtcblxuICAgICAgICAgIHZhciBmaW5hbEtleSA9IGtleTtcbiAgICAgICAgICB2YXIgZmluYWxLZXlzID0gW2ZpbmFsS2V5XTtcblxuICAgICAgICAgIHZhciBwbHVyYWxTdWZmaXggPSB2b2lkIDA7XG4gICAgICAgICAgaWYgKG5lZWRzUGx1cmFsSGFuZGxpbmcpIHBsdXJhbFN1ZmZpeCA9IF90aGlzMy5wbHVyYWxSZXNvbHZlci5nZXRTdWZmaXgoY29kZSwgb3B0aW9ucy5jb3VudCk7XG5cbiAgICAgICAgICAvLyBmYWxsYmFjayBmb3IgcGx1cmFsIGlmIGNvbnRleHQgbm90IGZvdW5kXG4gICAgICAgICAgaWYgKG5lZWRzUGx1cmFsSGFuZGxpbmcgJiYgbmVlZHNDb250ZXh0SGFuZGxpbmcpIGZpbmFsS2V5cy5wdXNoKGZpbmFsS2V5ICsgcGx1cmFsU3VmZml4KTtcblxuICAgICAgICAgIC8vIGdldCBrZXkgZm9yIGNvbnRleHQgaWYgbmVlZGVkXG4gICAgICAgICAgaWYgKG5lZWRzQ29udGV4dEhhbmRsaW5nKSBmaW5hbEtleXMucHVzaChmaW5hbEtleSArPSAnJyArIF90aGlzMy5vcHRpb25zLmNvbnRleHRTZXBhcmF0b3IgKyBvcHRpb25zLmNvbnRleHQpO1xuXG4gICAgICAgICAgLy8gZ2V0IGtleSBmb3IgcGx1cmFsIGlmIG5lZWRlZFxuICAgICAgICAgIGlmIChuZWVkc1BsdXJhbEhhbmRsaW5nKSBmaW5hbEtleXMucHVzaChmaW5hbEtleSArPSBwbHVyYWxTdWZmaXgpO1xuXG4gICAgICAgICAgLy8gaXRlcmF0ZSBvdmVyIGZpbmFsS2V5cyBzdGFydGluZyB3aXRoIG1vc3Qgc3BlY2lmaWMgcGx1cmFsa2V5ICgtPiBjb250ZXh0a2V5IG9ubHkpIC0+IHNpbmd1bGFya2V5IG9ubHlcbiAgICAgICAgICB2YXIgcG9zc2libGVLZXkgPSB2b2lkIDA7XG4gICAgICAgICAgLyogZXNsaW50IG5vLWNvbmQtYXNzaWduOiAwICovXG4gICAgICAgICAgd2hpbGUgKHBvc3NpYmxlS2V5ID0gZmluYWxLZXlzLnBvcCgpKSB7XG4gICAgICAgICAgICBpZiAoIV90aGlzMy5pc1ZhbGlkTG9va3VwKGZvdW5kKSkge1xuICAgICAgICAgICAgICBmb3VuZCA9IF90aGlzMy5nZXRSZXNvdXJjZShjb2RlLCBucywgcG9zc2libGVLZXksIG9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7IHJlczogZm91bmQsIHVzZWRLZXk6IHVzZWRLZXkgfTtcbiAgfTtcblxuICBUcmFuc2xhdG9yLnByb3RvdHlwZS5pc1ZhbGlkTG9va3VwID0gZnVuY3Rpb24gaXNWYWxpZExvb2t1cChyZXMpIHtcbiAgICByZXR1cm4gcmVzICE9PSB1bmRlZmluZWQgJiYgISghdGhpcy5vcHRpb25zLnJldHVybk51bGwgJiYgcmVzID09PSBudWxsKSAmJiAhKCF0aGlzLm9wdGlvbnMucmV0dXJuRW1wdHlTdHJpbmcgJiYgcmVzID09PSAnJyk7XG4gIH07XG5cbiAgVHJhbnNsYXRvci5wcm90b3R5cGUuZ2V0UmVzb3VyY2UgPSBmdW5jdGlvbiBnZXRSZXNvdXJjZShjb2RlLCBucywga2V5KSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IHt9O1xuXG4gICAgcmV0dXJuIHRoaXMucmVzb3VyY2VTdG9yZS5nZXRSZXNvdXJjZShjb2RlLCBucywga2V5LCBvcHRpb25zKTtcbiAgfTtcblxuICByZXR1cm4gVHJhbnNsYXRvcjtcbn0oRXZlbnRFbWl0dGVyKTtcblxuZnVuY3Rpb24gY2FwaXRhbGl6ZShzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcbn1cblxudmFyIExhbmd1YWdlVXRpbCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gTGFuZ3VhZ2VVdGlsKG9wdGlvbnMpIHtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBMYW5ndWFnZVV0aWwpO1xuXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICAgIHRoaXMud2hpdGVsaXN0ID0gdGhpcy5vcHRpb25zLndoaXRlbGlzdCB8fCBmYWxzZTtcbiAgICB0aGlzLmxvZ2dlciA9IGJhc2VMb2dnZXIuY3JlYXRlKCdsYW5ndWFnZVV0aWxzJyk7XG4gIH1cblxuICBMYW5ndWFnZVV0aWwucHJvdG90eXBlLmdldFNjcmlwdFBhcnRGcm9tQ29kZSA9IGZ1bmN0aW9uIGdldFNjcmlwdFBhcnRGcm9tQ29kZShjb2RlKSB7XG4gICAgaWYgKCFjb2RlIHx8IGNvZGUuaW5kZXhPZignLScpIDwgMCkgcmV0dXJuIG51bGw7XG5cbiAgICB2YXIgcCA9IGNvZGUuc3BsaXQoJy0nKTtcbiAgICBpZiAocC5sZW5ndGggPT09IDIpIHJldHVybiBudWxsO1xuICAgIHAucG9wKCk7XG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0TGFuZ3VhZ2VDb2RlKHAuam9pbignLScpKTtcbiAgfTtcblxuICBMYW5ndWFnZVV0aWwucHJvdG90eXBlLmdldExhbmd1YWdlUGFydEZyb21Db2RlID0gZnVuY3Rpb24gZ2V0TGFuZ3VhZ2VQYXJ0RnJvbUNvZGUoY29kZSkge1xuICAgIGlmICghY29kZSB8fCBjb2RlLmluZGV4T2YoJy0nKSA8IDApIHJldHVybiBjb2RlO1xuXG4gICAgdmFyIHAgPSBjb2RlLnNwbGl0KCctJyk7XG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0TGFuZ3VhZ2VDb2RlKHBbMF0pO1xuICB9O1xuXG4gIExhbmd1YWdlVXRpbC5wcm90b3R5cGUuZm9ybWF0TGFuZ3VhZ2VDb2RlID0gZnVuY3Rpb24gZm9ybWF0TGFuZ3VhZ2VDb2RlKGNvZGUpIHtcbiAgICAvLyBodHRwOi8vd3d3LmlhbmEub3JnL2Fzc2lnbm1lbnRzL2xhbmd1YWdlLXRhZ3MvbGFuZ3VhZ2UtdGFncy54aHRtbFxuICAgIGlmICh0eXBlb2YgY29kZSA9PT0gJ3N0cmluZycgJiYgY29kZS5pbmRleE9mKCctJykgPiAtMSkge1xuICAgICAgdmFyIHNwZWNpYWxDYXNlcyA9IFsnaGFucycsICdoYW50JywgJ2xhdG4nLCAnY3lybCcsICdjYW5zJywgJ21vbmcnLCAnYXJhYiddO1xuICAgICAgdmFyIHAgPSBjb2RlLnNwbGl0KCctJyk7XG5cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubG93ZXJDYXNlTG5nKSB7XG4gICAgICAgIHAgPSBwLm1hcChmdW5jdGlvbiAocGFydCkge1xuICAgICAgICAgIHJldHVybiBwYXJ0LnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChwLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBwWzBdID0gcFswXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBwWzFdID0gcFsxXS50b1VwcGVyQ2FzZSgpO1xuXG4gICAgICAgIGlmIChzcGVjaWFsQ2FzZXMuaW5kZXhPZihwWzFdLnRvTG93ZXJDYXNlKCkpID4gLTEpIHBbMV0gPSBjYXBpdGFsaXplKHBbMV0udG9Mb3dlckNhc2UoKSk7XG4gICAgICB9IGVsc2UgaWYgKHAubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIHBbMF0gPSBwWzBdLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgLy8gaWYgbGVuZ2h0IDIgZ3Vlc3MgaXQncyBhIGNvdW50cnlcbiAgICAgICAgaWYgKHBbMV0ubGVuZ3RoID09PSAyKSBwWzFdID0gcFsxXS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICBpZiAocFswXSAhPT0gJ3NnbicgJiYgcFsyXS5sZW5ndGggPT09IDIpIHBbMl0gPSBwWzJdLnRvVXBwZXJDYXNlKCk7XG5cbiAgICAgICAgaWYgKHNwZWNpYWxDYXNlcy5pbmRleE9mKHBbMV0udG9Mb3dlckNhc2UoKSkgPiAtMSkgcFsxXSA9IGNhcGl0YWxpemUocFsxXS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgaWYgKHNwZWNpYWxDYXNlcy5pbmRleE9mKHBbMl0udG9Mb3dlckNhc2UoKSkgPiAtMSkgcFsyXSA9IGNhcGl0YWxpemUocFsyXS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHAuam9pbignLScpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY2xlYW5Db2RlIHx8IHRoaXMub3B0aW9ucy5sb3dlckNhc2VMbmcgPyBjb2RlLnRvTG93ZXJDYXNlKCkgOiBjb2RlO1xuICB9O1xuXG4gIExhbmd1YWdlVXRpbC5wcm90b3R5cGUuaXNXaGl0ZWxpc3RlZCA9IGZ1bmN0aW9uIGlzV2hpdGVsaXN0ZWQoY29kZSkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMubG9hZCA9PT0gJ2xhbmd1YWdlT25seScgfHwgdGhpcy5vcHRpb25zLm5vbkV4cGxpY2l0V2hpdGVsaXN0KSB7XG4gICAgICBjb2RlID0gdGhpcy5nZXRMYW5ndWFnZVBhcnRGcm9tQ29kZShjb2RlKTtcbiAgICB9XG4gICAgcmV0dXJuICF0aGlzLndoaXRlbGlzdCB8fCAhdGhpcy53aGl0ZWxpc3QubGVuZ3RoIHx8IHRoaXMud2hpdGVsaXN0LmluZGV4T2YoY29kZSkgPiAtMTtcbiAgfTtcblxuICBMYW5ndWFnZVV0aWwucHJvdG90eXBlLmdldEZhbGxiYWNrQ29kZXMgPSBmdW5jdGlvbiBnZXRGYWxsYmFja0NvZGVzKGZhbGxiYWNrcywgY29kZSkge1xuICAgIGlmICghZmFsbGJhY2tzKSByZXR1cm4gW107XG4gICAgaWYgKHR5cGVvZiBmYWxsYmFja3MgPT09ICdzdHJpbmcnKSBmYWxsYmFja3MgPSBbZmFsbGJhY2tzXTtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5hcHBseShmYWxsYmFja3MpID09PSAnW29iamVjdCBBcnJheV0nKSByZXR1cm4gZmFsbGJhY2tzO1xuXG4gICAgaWYgKCFjb2RlKSByZXR1cm4gZmFsbGJhY2tzLmRlZmF1bHQgfHwgW107XG5cbiAgICAvLyBhc3VtZSB3ZSBoYXZlIGFuIG9iamVjdCBkZWZpbmluZyBmYWxsYmFja3NcbiAgICB2YXIgZm91bmQgPSBmYWxsYmFja3NbY29kZV07XG4gICAgaWYgKCFmb3VuZCkgZm91bmQgPSBmYWxsYmFja3NbdGhpcy5nZXRTY3JpcHRQYXJ0RnJvbUNvZGUoY29kZSldO1xuICAgIGlmICghZm91bmQpIGZvdW5kID0gZmFsbGJhY2tzW3RoaXMuZm9ybWF0TGFuZ3VhZ2VDb2RlKGNvZGUpXTtcbiAgICBpZiAoIWZvdW5kKSBmb3VuZCA9IGZhbGxiYWNrcy5kZWZhdWx0O1xuXG4gICAgcmV0dXJuIGZvdW5kIHx8IFtdO1xuICB9O1xuXG4gIExhbmd1YWdlVXRpbC5wcm90b3R5cGUudG9SZXNvbHZlSGllcmFyY2h5ID0gZnVuY3Rpb24gdG9SZXNvbHZlSGllcmFyY2h5KGNvZGUsIGZhbGxiYWNrQ29kZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgZmFsbGJhY2tDb2RlcyA9IHRoaXMuZ2V0RmFsbGJhY2tDb2RlcyhmYWxsYmFja0NvZGUgfHwgdGhpcy5vcHRpb25zLmZhbGxiYWNrTG5nIHx8IFtdLCBjb2RlKTtcblxuICAgIHZhciBjb2RlcyA9IFtdO1xuICAgIHZhciBhZGRDb2RlID0gZnVuY3Rpb24gYWRkQ29kZShjKSB7XG4gICAgICBpZiAoIWMpIHJldHVybjtcbiAgICAgIGlmIChfdGhpcy5pc1doaXRlbGlzdGVkKGMpKSB7XG4gICAgICAgIGNvZGVzLnB1c2goYyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5sb2dnZXIud2FybigncmVqZWN0aW5nIG5vbi13aGl0ZWxpc3RlZCBsYW5ndWFnZSBjb2RlOiAnICsgYyk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmICh0eXBlb2YgY29kZSA9PT0gJ3N0cmluZycgJiYgY29kZS5pbmRleE9mKCctJykgPiAtMSkge1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5sb2FkICE9PSAnbGFuZ3VhZ2VPbmx5JykgYWRkQ29kZSh0aGlzLmZvcm1hdExhbmd1YWdlQ29kZShjb2RlKSk7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmxvYWQgIT09ICdsYW5ndWFnZU9ubHknICYmIHRoaXMub3B0aW9ucy5sb2FkICE9PSAnY3VycmVudE9ubHknKSBhZGRDb2RlKHRoaXMuZ2V0U2NyaXB0UGFydEZyb21Db2RlKGNvZGUpKTtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubG9hZCAhPT0gJ2N1cnJlbnRPbmx5JykgYWRkQ29kZSh0aGlzLmdldExhbmd1YWdlUGFydEZyb21Db2RlKGNvZGUpKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJykge1xuICAgICAgYWRkQ29kZSh0aGlzLmZvcm1hdExhbmd1YWdlQ29kZShjb2RlKSk7XG4gICAgfVxuXG4gICAgZmFsbGJhY2tDb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChmYykge1xuICAgICAgaWYgKGNvZGVzLmluZGV4T2YoZmMpIDwgMCkgYWRkQ29kZShfdGhpcy5mb3JtYXRMYW5ndWFnZUNvZGUoZmMpKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBjb2RlcztcbiAgfTtcblxuICByZXR1cm4gTGFuZ3VhZ2VVdGlsO1xufSgpO1xuXG4vLyBkZWZpbml0aW9uIGh0dHA6Ly90cmFuc2xhdGUuc291cmNlZm9yZ2UubmV0L3dpa2kvbDEwbi9wbHVyYWxmb3Jtc1xuLyogZXNsaW50LWRpc2FibGUgKi9cbnZhciBzZXRzID0gW3sgbG5nczogWydhY2gnLCAnYWsnLCAnYW0nLCAnYXJuJywgJ2JyJywgJ2ZpbCcsICdndW4nLCAnbG4nLCAnbWZlJywgJ21nJywgJ21pJywgJ29jJywgJ3B0JywgJ3B0LUJSJywgJ3RnJywgJ3RpJywgJ3RyJywgJ3V6JywgJ3dhJ10sIG5yOiBbMSwgMl0sIGZjOiAxIH0sIHsgbG5nczogWydhZicsICdhbicsICdhc3QnLCAnYXonLCAnYmcnLCAnYm4nLCAnY2EnLCAnZGEnLCAnZGUnLCAnZGV2JywgJ2VsJywgJ2VuJywgJ2VvJywgJ2VzJywgJ2V0JywgJ2V1JywgJ2ZpJywgJ2ZvJywgJ2Z1cicsICdmeScsICdnbCcsICdndScsICdoYScsICdoZScsICdoaScsICdodScsICdoeScsICdpYScsICdpdCcsICdrbicsICdrdScsICdsYicsICdtYWknLCAnbWwnLCAnbW4nLCAnbXInLCAnbmFoJywgJ25hcCcsICduYicsICduZScsICdubCcsICdubicsICdubycsICduc28nLCAncGEnLCAncGFwJywgJ3BtcycsICdwcycsICdwdC1QVCcsICdybScsICdzY28nLCAnc2UnLCAnc2knLCAnc28nLCAnc29uJywgJ3NxJywgJ3N2JywgJ3N3JywgJ3RhJywgJ3RlJywgJ3RrJywgJ3VyJywgJ3lvJ10sIG5yOiBbMSwgMl0sIGZjOiAyIH0sIHsgbG5nczogWydheScsICdibycsICdjZ2cnLCAnZmEnLCAnaWQnLCAnamEnLCAnamJvJywgJ2thJywgJ2trJywgJ2ttJywgJ2tvJywgJ2t5JywgJ2xvJywgJ21zJywgJ3NhaCcsICdzdScsICd0aCcsICd0dCcsICd1ZycsICd2aScsICd3bycsICd6aCddLCBucjogWzFdLCBmYzogMyB9LCB7IGxuZ3M6IFsnYmUnLCAnYnMnLCAnZHonLCAnaHInLCAncnUnLCAnc3InLCAndWsnXSwgbnI6IFsxLCAyLCA1XSwgZmM6IDQgfSwgeyBsbmdzOiBbJ2FyJ10sIG5yOiBbMCwgMSwgMiwgMywgMTEsIDEwMF0sIGZjOiA1IH0sIHsgbG5nczogWydjcycsICdzayddLCBucjogWzEsIDIsIDVdLCBmYzogNiB9LCB7IGxuZ3M6IFsnY3NiJywgJ3BsJ10sIG5yOiBbMSwgMiwgNV0sIGZjOiA3IH0sIHsgbG5nczogWydjeSddLCBucjogWzEsIDIsIDMsIDhdLCBmYzogOCB9LCB7IGxuZ3M6IFsnZnInXSwgbnI6IFsxLCAyXSwgZmM6IDkgfSwgeyBsbmdzOiBbJ2dhJ10sIG5yOiBbMSwgMiwgMywgNywgMTFdLCBmYzogMTAgfSwgeyBsbmdzOiBbJ2dkJ10sIG5yOiBbMSwgMiwgMywgMjBdLCBmYzogMTEgfSwgeyBsbmdzOiBbJ2lzJ10sIG5yOiBbMSwgMl0sIGZjOiAxMiB9LCB7IGxuZ3M6IFsnanYnXSwgbnI6IFswLCAxXSwgZmM6IDEzIH0sIHsgbG5nczogWydrdyddLCBucjogWzEsIDIsIDMsIDRdLCBmYzogMTQgfSwgeyBsbmdzOiBbJ2x0J10sIG5yOiBbMSwgMiwgMTBdLCBmYzogMTUgfSwgeyBsbmdzOiBbJ2x2J10sIG5yOiBbMSwgMiwgMF0sIGZjOiAxNiB9LCB7IGxuZ3M6IFsnbWsnXSwgbnI6IFsxLCAyXSwgZmM6IDE3IH0sIHsgbG5nczogWydtbmsnXSwgbnI6IFswLCAxLCAyXSwgZmM6IDE4IH0sIHsgbG5nczogWydtdCddLCBucjogWzEsIDIsIDExLCAyMF0sIGZjOiAxOSB9LCB7IGxuZ3M6IFsnb3InXSwgbnI6IFsyLCAxXSwgZmM6IDIgfSwgeyBsbmdzOiBbJ3JvJ10sIG5yOiBbMSwgMiwgMjBdLCBmYzogMjAgfSwgeyBsbmdzOiBbJ3NsJ10sIG5yOiBbNSwgMSwgMiwgM10sIGZjOiAyMSB9XTtcblxudmFyIF9ydWxlc1BsdXJhbHNUeXBlcyA9IHtcbiAgMTogZnVuY3Rpb24gXyhuKSB7XG4gICAgcmV0dXJuIE51bWJlcihuID4gMSk7XG4gIH0sXG4gIDI6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiAhPSAxKTtcbiAgfSxcbiAgMzogZnVuY3Rpb24gXyhuKSB7XG4gICAgcmV0dXJuIDA7XG4gIH0sXG4gIDQ6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiAlIDEwID09IDEgJiYgbiAlIDEwMCAhPSAxMSA/IDAgOiBuICUgMTAgPj0gMiAmJiBuICUgMTAgPD0gNCAmJiAobiAlIDEwMCA8IDEwIHx8IG4gJSAxMDAgPj0gMjApID8gMSA6IDIpO1xuICB9LFxuICA1OiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT09IDAgPyAwIDogbiA9PSAxID8gMSA6IG4gPT0gMiA/IDIgOiBuICUgMTAwID49IDMgJiYgbiAlIDEwMCA8PSAxMCA/IDMgOiBuICUgMTAwID49IDExID8gNCA6IDUpO1xuICB9LFxuICA2OiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT0gMSA/IDAgOiBuID49IDIgJiYgbiA8PSA0ID8gMSA6IDIpO1xuICB9LFxuICA3OiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT0gMSA/IDAgOiBuICUgMTAgPj0gMiAmJiBuICUgMTAgPD0gNCAmJiAobiAlIDEwMCA8IDEwIHx8IG4gJSAxMDAgPj0gMjApID8gMSA6IDIpO1xuICB9LFxuICA4OiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT0gMSA/IDAgOiBuID09IDIgPyAxIDogbiAhPSA4ICYmIG4gIT0gMTEgPyAyIDogMyk7XG4gIH0sXG4gIDk6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiA+PSAyKTtcbiAgfSxcbiAgMTA6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiA9PSAxID8gMCA6IG4gPT0gMiA/IDEgOiBuIDwgNyA/IDIgOiBuIDwgMTEgPyAzIDogNCk7XG4gIH0sXG4gIDExOiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT0gMSB8fCBuID09IDExID8gMCA6IG4gPT0gMiB8fCBuID09IDEyID8gMSA6IG4gPiAyICYmIG4gPCAyMCA/IDIgOiAzKTtcbiAgfSxcbiAgMTI6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiAlIDEwICE9IDEgfHwgbiAlIDEwMCA9PSAxMSk7XG4gIH0sXG4gIDEzOiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gIT09IDApO1xuICB9LFxuICAxNDogZnVuY3Rpb24gXyhuKSB7XG4gICAgcmV0dXJuIE51bWJlcihuID09IDEgPyAwIDogbiA9PSAyID8gMSA6IG4gPT0gMyA/IDIgOiAzKTtcbiAgfSxcbiAgMTU6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiAlIDEwID09IDEgJiYgbiAlIDEwMCAhPSAxMSA/IDAgOiBuICUgMTAgPj0gMiAmJiAobiAlIDEwMCA8IDEwIHx8IG4gJSAxMDAgPj0gMjApID8gMSA6IDIpO1xuICB9LFxuICAxNjogZnVuY3Rpb24gXyhuKSB7XG4gICAgcmV0dXJuIE51bWJlcihuICUgMTAgPT0gMSAmJiBuICUgMTAwICE9IDExID8gMCA6IG4gIT09IDAgPyAxIDogMik7XG4gIH0sXG4gIDE3OiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT0gMSB8fCBuICUgMTAgPT0gMSA/IDAgOiAxKTtcbiAgfSxcbiAgMTg6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiA9PSAwID8gMCA6IG4gPT0gMSA/IDEgOiAyKTtcbiAgfSxcbiAgMTk6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiA9PSAxID8gMCA6IG4gPT09IDAgfHwgbiAlIDEwMCA+IDEgJiYgbiAlIDEwMCA8IDExID8gMSA6IG4gJSAxMDAgPiAxMCAmJiBuICUgMTAwIDwgMjAgPyAyIDogMyk7XG4gIH0sXG4gIDIwOiBmdW5jdGlvbiBfKG4pIHtcbiAgICByZXR1cm4gTnVtYmVyKG4gPT0gMSA/IDAgOiBuID09PSAwIHx8IG4gJSAxMDAgPiAwICYmIG4gJSAxMDAgPCAyMCA/IDEgOiAyKTtcbiAgfSxcbiAgMjE6IGZ1bmN0aW9uIF8obikge1xuICAgIHJldHVybiBOdW1iZXIobiAlIDEwMCA9PSAxID8gMSA6IG4gJSAxMDAgPT0gMiA/IDIgOiBuICUgMTAwID09IDMgfHwgbiAlIDEwMCA9PSA0ID8gMyA6IDApO1xuICB9XG59O1xuLyogZXNsaW50LWVuYWJsZSAqL1xuXG5mdW5jdGlvbiBjcmVhdGVSdWxlcygpIHtcbiAgdmFyIHJ1bGVzID0ge307XG4gIHNldHMuZm9yRWFjaChmdW5jdGlvbiAoc2V0JCQxKSB7XG4gICAgc2V0JCQxLmxuZ3MuZm9yRWFjaChmdW5jdGlvbiAobCkge1xuICAgICAgcnVsZXNbbF0gPSB7XG4gICAgICAgIG51bWJlcnM6IHNldCQkMS5ucixcbiAgICAgICAgcGx1cmFsczogX3J1bGVzUGx1cmFsc1R5cGVzW3NldCQkMS5mY11cbiAgICAgIH07XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gcnVsZXM7XG59XG5cbnZhciBQbHVyYWxSZXNvbHZlciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUGx1cmFsUmVzb2x2ZXIobGFuZ3VhZ2VVdGlscykge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBQbHVyYWxSZXNvbHZlcik7XG5cbiAgICB0aGlzLmxhbmd1YWdlVXRpbHMgPSBsYW5ndWFnZVV0aWxzO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgICB0aGlzLmxvZ2dlciA9IGJhc2VMb2dnZXIuY3JlYXRlKCdwbHVyYWxSZXNvbHZlcicpO1xuXG4gICAgdGhpcy5ydWxlcyA9IGNyZWF0ZVJ1bGVzKCk7XG4gIH1cblxuICBQbHVyYWxSZXNvbHZlci5wcm90b3R5cGUuYWRkUnVsZSA9IGZ1bmN0aW9uIGFkZFJ1bGUobG5nLCBvYmopIHtcbiAgICB0aGlzLnJ1bGVzW2xuZ10gPSBvYmo7XG4gIH07XG5cbiAgUGx1cmFsUmVzb2x2ZXIucHJvdG90eXBlLmdldFJ1bGUgPSBmdW5jdGlvbiBnZXRSdWxlKGNvZGUpIHtcbiAgICByZXR1cm4gdGhpcy5ydWxlc1tjb2RlXSB8fCB0aGlzLnJ1bGVzW3RoaXMubGFuZ3VhZ2VVdGlscy5nZXRMYW5ndWFnZVBhcnRGcm9tQ29kZShjb2RlKV07XG4gIH07XG5cbiAgUGx1cmFsUmVzb2x2ZXIucHJvdG90eXBlLm5lZWRzUGx1cmFsID0gZnVuY3Rpb24gbmVlZHNQbHVyYWwoY29kZSkge1xuICAgIHZhciBydWxlID0gdGhpcy5nZXRSdWxlKGNvZGUpO1xuXG4gICAgcmV0dXJuIHJ1bGUgJiYgcnVsZS5udW1iZXJzLmxlbmd0aCA+IDE7XG4gIH07XG5cbiAgUGx1cmFsUmVzb2x2ZXIucHJvdG90eXBlLmdldFN1ZmZpeCA9IGZ1bmN0aW9uIGdldFN1ZmZpeChjb2RlLCBjb3VudCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgcnVsZSA9IHRoaXMuZ2V0UnVsZShjb2RlKTtcblxuICAgIGlmIChydWxlKSB7XG4gICAgICAvL2lmIChydWxlLm51bWJlcnMubGVuZ3RoID09PSAxKSByZXR1cm4gJyc7IC8vIG9ubHkgc2luZ3VsYXJcblxuICAgICAgdmFyIGlkeCA9IHJ1bGUubm9BYnMgPyBydWxlLnBsdXJhbHMoY291bnQpIDogcnVsZS5wbHVyYWxzKE1hdGguYWJzKGNvdW50KSk7XG4gICAgICB2YXIgc3VmZml4ID0gcnVsZS5udW1iZXJzW2lkeF07XG5cbiAgICAgIC8vIHNwZWNpYWwgdHJlYXRtZW50IGZvciBsbmdzIG9ubHkgaGF2aW5nIHNpbmd1bGFyIGFuZCBwbHVyYWxcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2ltcGxpZnlQbHVyYWxTdWZmaXggJiYgcnVsZS5udW1iZXJzLmxlbmd0aCA9PT0gMiAmJiBydWxlLm51bWJlcnNbMF0gPT09IDEpIHtcbiAgICAgICAgaWYgKHN1ZmZpeCA9PT0gMikge1xuICAgICAgICAgIHN1ZmZpeCA9ICdwbHVyYWwnO1xuICAgICAgICB9IGVsc2UgaWYgKHN1ZmZpeCA9PT0gMSkge1xuICAgICAgICAgIHN1ZmZpeCA9ICcnO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciByZXR1cm5TdWZmaXggPSBmdW5jdGlvbiByZXR1cm5TdWZmaXgoKSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5vcHRpb25zLnByZXBlbmQgJiYgc3VmZml4LnRvU3RyaW5nKCkgPyBfdGhpcy5vcHRpb25zLnByZXBlbmQgKyBzdWZmaXgudG9TdHJpbmcoKSA6IHN1ZmZpeC50b1N0cmluZygpO1xuICAgICAgfTtcblxuICAgICAgLy8gQ09NUEFUSUJJTElUWSBKU09OXG4gICAgICAvLyB2MVxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5jb21wYXRpYmlsaXR5SlNPTiA9PT0gJ3YxJykge1xuICAgICAgICBpZiAoc3VmZml4ID09PSAxKSByZXR1cm4gJyc7XG4gICAgICAgIGlmICh0eXBlb2Ygc3VmZml4ID09PSAnbnVtYmVyJykgcmV0dXJuICdfcGx1cmFsXycgKyBzdWZmaXgudG9TdHJpbmcoKTtcbiAgICAgICAgcmV0dXJuIHJldHVyblN1ZmZpeCgpO1xuICAgICAgfSBlbHNlIGlmICggLyogdjIgKi90aGlzLm9wdGlvbnMuY29tcGF0aWJpbGl0eUpTT04gPT09ICd2MicgfHwgcnVsZS5udW1iZXJzLmxlbmd0aCA9PT0gMiAmJiBydWxlLm51bWJlcnNbMF0gPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIHJldHVyblN1ZmZpeCgpO1xuICAgICAgfSBlbHNlIGlmICggLyogdjMgLSBnZXR0ZXh0IGluZGV4ICovcnVsZS5udW1iZXJzLmxlbmd0aCA9PT0gMiAmJiBydWxlLm51bWJlcnNbMF0gPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIHJldHVyblN1ZmZpeCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5wcmVwZW5kICYmIGlkeC50b1N0cmluZygpID8gdGhpcy5vcHRpb25zLnByZXBlbmQgKyBpZHgudG9TdHJpbmcoKSA6IGlkeC50b1N0cmluZygpO1xuICAgIH1cblxuICAgIHRoaXMubG9nZ2VyLndhcm4oJ25vIHBsdXJhbCBydWxlIGZvdW5kIGZvcjogJyArIGNvZGUpO1xuICAgIHJldHVybiAnJztcbiAgfTtcblxuICByZXR1cm4gUGx1cmFsUmVzb2x2ZXI7XG59KCk7XG5cbnZhciBJbnRlcnBvbGF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEludGVycG9sYXRvcigpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgSW50ZXJwb2xhdG9yKTtcblxuICAgIHRoaXMubG9nZ2VyID0gYmFzZUxvZ2dlci5jcmVhdGUoJ2ludGVycG9sYXRvcicpO1xuXG4gICAgdGhpcy5pbml0KG9wdGlvbnMsIHRydWUpO1xuICB9XG5cbiAgLyogZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOiAwICovXG5cblxuICBJbnRlcnBvbGF0b3IucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICB2YXIgcmVzZXQgPSBhcmd1bWVudHNbMV07XG5cbiAgICBpZiAocmVzZXQpIHtcbiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICB0aGlzLmZvcm1hdCA9IG9wdGlvbnMuaW50ZXJwb2xhdGlvbiAmJiBvcHRpb25zLmludGVycG9sYXRpb24uZm9ybWF0IHx8IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9O1xuICAgICAgdGhpcy5lc2NhcGUgPSBvcHRpb25zLmludGVycG9sYXRpb24gJiYgb3B0aW9ucy5pbnRlcnBvbGF0aW9uLmVzY2FwZSB8fCBlc2NhcGU7XG4gICAgfVxuICAgIGlmICghb3B0aW9ucy5pbnRlcnBvbGF0aW9uKSBvcHRpb25zLmludGVycG9sYXRpb24gPSB7IGVzY2FwZVZhbHVlOiB0cnVlIH07XG5cbiAgICB2YXIgaU9wdHMgPSBvcHRpb25zLmludGVycG9sYXRpb247XG5cbiAgICB0aGlzLmVzY2FwZVZhbHVlID0gaU9wdHMuZXNjYXBlVmFsdWUgIT09IHVuZGVmaW5lZCA/IGlPcHRzLmVzY2FwZVZhbHVlIDogdHJ1ZTtcblxuICAgIHRoaXMucHJlZml4ID0gaU9wdHMucHJlZml4ID8gcmVnZXhFc2NhcGUoaU9wdHMucHJlZml4KSA6IGlPcHRzLnByZWZpeEVzY2FwZWQgfHwgJ3t7JztcbiAgICB0aGlzLnN1ZmZpeCA9IGlPcHRzLnN1ZmZpeCA/IHJlZ2V4RXNjYXBlKGlPcHRzLnN1ZmZpeCkgOiBpT3B0cy5zdWZmaXhFc2NhcGVkIHx8ICd9fSc7XG5cbiAgICB0aGlzLmZvcm1hdFNlcGFyYXRvciA9IGlPcHRzLmZvcm1hdFNlcGFyYXRvciA/IGlPcHRzLmZvcm1hdFNlcGFyYXRvciA6IGlPcHRzLmZvcm1hdFNlcGFyYXRvciB8fCAnLCc7XG5cbiAgICB0aGlzLnVuZXNjYXBlUHJlZml4ID0gaU9wdHMudW5lc2NhcGVTdWZmaXggPyAnJyA6IGlPcHRzLnVuZXNjYXBlUHJlZml4IHx8ICctJztcbiAgICB0aGlzLnVuZXNjYXBlU3VmZml4ID0gdGhpcy51bmVzY2FwZVByZWZpeCA/ICcnIDogaU9wdHMudW5lc2NhcGVTdWZmaXggfHwgJyc7XG5cbiAgICB0aGlzLm5lc3RpbmdQcmVmaXggPSBpT3B0cy5uZXN0aW5nUHJlZml4ID8gcmVnZXhFc2NhcGUoaU9wdHMubmVzdGluZ1ByZWZpeCkgOiBpT3B0cy5uZXN0aW5nUHJlZml4RXNjYXBlZCB8fCByZWdleEVzY2FwZSgnJHQoJyk7XG4gICAgdGhpcy5uZXN0aW5nU3VmZml4ID0gaU9wdHMubmVzdGluZ1N1ZmZpeCA/IHJlZ2V4RXNjYXBlKGlPcHRzLm5lc3RpbmdTdWZmaXgpIDogaU9wdHMubmVzdGluZ1N1ZmZpeEVzY2FwZWQgfHwgcmVnZXhFc2NhcGUoJyknKTtcblxuICAgIHRoaXMubWF4UmVwbGFjZXMgPSBpT3B0cy5tYXhSZXBsYWNlcyA/IGlPcHRzLm1heFJlcGxhY2VzIDogMTAwMDtcblxuICAgIC8vIHRoZSByZWdleHBcbiAgICB0aGlzLnJlc2V0UmVnRXhwKCk7XG4gIH07XG5cbiAgSW50ZXJwb2xhdG9yLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgIGlmICh0aGlzLm9wdGlvbnMpIHRoaXMuaW5pdCh0aGlzLm9wdGlvbnMpO1xuICB9O1xuXG4gIEludGVycG9sYXRvci5wcm90b3R5cGUucmVzZXRSZWdFeHAgPSBmdW5jdGlvbiByZXNldFJlZ0V4cCgpIHtcbiAgICAvLyB0aGUgcmVnZXhwXG4gICAgdmFyIHJlZ2V4cFN0ciA9IHRoaXMucHJlZml4ICsgJyguKz8pJyArIHRoaXMuc3VmZml4O1xuICAgIHRoaXMucmVnZXhwID0gbmV3IFJlZ0V4cChyZWdleHBTdHIsICdnJyk7XG5cbiAgICB2YXIgcmVnZXhwVW5lc2NhcGVTdHIgPSAnJyArIHRoaXMucHJlZml4ICsgdGhpcy51bmVzY2FwZVByZWZpeCArICcoLis/KScgKyB0aGlzLnVuZXNjYXBlU3VmZml4ICsgdGhpcy5zdWZmaXg7XG4gICAgdGhpcy5yZWdleHBVbmVzY2FwZSA9IG5ldyBSZWdFeHAocmVnZXhwVW5lc2NhcGVTdHIsICdnJyk7XG5cbiAgICB2YXIgbmVzdGluZ1JlZ2V4cFN0ciA9IHRoaXMubmVzdGluZ1ByZWZpeCArICcoLis/KScgKyB0aGlzLm5lc3RpbmdTdWZmaXg7XG4gICAgdGhpcy5uZXN0aW5nUmVnZXhwID0gbmV3IFJlZ0V4cChuZXN0aW5nUmVnZXhwU3RyLCAnZycpO1xuICB9O1xuXG4gIEludGVycG9sYXRvci5wcm90b3R5cGUuaW50ZXJwb2xhdGUgPSBmdW5jdGlvbiBpbnRlcnBvbGF0ZShzdHIsIGRhdGEsIGxuZykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB2YXIgbWF0Y2ggPSB2b2lkIDA7XG4gICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgIHZhciByZXBsYWNlcyA9IHZvaWQgMDtcblxuICAgIGZ1bmN0aW9uIHJlZ2V4U2FmZSh2YWwpIHtcbiAgICAgIHJldHVybiB2YWwucmVwbGFjZSgvXFwkL2csICckJCQkJyk7XG4gICAgfVxuXG4gICAgdmFyIGhhbmRsZUZvcm1hdCA9IGZ1bmN0aW9uIGhhbmRsZUZvcm1hdChrZXkpIHtcbiAgICAgIGlmIChrZXkuaW5kZXhPZihfdGhpcy5mb3JtYXRTZXBhcmF0b3IpIDwgMCkgcmV0dXJuIGdldFBhdGgoZGF0YSwga2V5KTtcblxuICAgICAgdmFyIHAgPSBrZXkuc3BsaXQoX3RoaXMuZm9ybWF0U2VwYXJhdG9yKTtcbiAgICAgIHZhciBrID0gcC5zaGlmdCgpLnRyaW0oKTtcbiAgICAgIHZhciBmID0gcC5qb2luKF90aGlzLmZvcm1hdFNlcGFyYXRvcikudHJpbSgpO1xuXG4gICAgICByZXR1cm4gX3RoaXMuZm9ybWF0KGdldFBhdGgoZGF0YSwgayksIGYsIGxuZyk7XG4gICAgfTtcblxuICAgIHRoaXMucmVzZXRSZWdFeHAoKTtcblxuICAgIHJlcGxhY2VzID0gMDtcbiAgICAvLyB1bmVzY2FwZSBpZiBoYXMgdW5lc2NhcGVQcmVmaXgvU3VmZml4XG4gICAgLyogZXNsaW50IG5vLWNvbmQtYXNzaWduOiAwICovXG4gICAgd2hpbGUgKG1hdGNoID0gdGhpcy5yZWdleHBVbmVzY2FwZS5leGVjKHN0cikpIHtcbiAgICAgIHZhbHVlID0gaGFuZGxlRm9ybWF0KG1hdGNoWzFdLnRyaW0oKSk7XG4gICAgICBzdHIgPSBzdHIucmVwbGFjZShtYXRjaFswXSwgdmFsdWUpO1xuICAgICAgdGhpcy5yZWdleHBVbmVzY2FwZS5sYXN0SW5kZXggPSAwO1xuICAgICAgcmVwbGFjZXMrKztcbiAgICAgIGlmIChyZXBsYWNlcyA+PSB0aGlzLm1heFJlcGxhY2VzKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlcGxhY2VzID0gMDtcbiAgICAvLyByZWd1bGFyIGVzY2FwZSBvbiBkZW1hbmRcbiAgICB3aGlsZSAobWF0Y2ggPSB0aGlzLnJlZ2V4cC5leGVjKHN0cikpIHtcbiAgICAgIHZhbHVlID0gaGFuZGxlRm9ybWF0KG1hdGNoWzFdLnRyaW0oKSk7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykgdmFsdWUgPSBtYWtlU3RyaW5nKHZhbHVlKTtcbiAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIud2FybignbWlzc2VkIHRvIHBhc3MgaW4gdmFyaWFibGUgJyArIG1hdGNoWzFdICsgJyBmb3IgaW50ZXJwb2xhdGluZyAnICsgc3RyKTtcbiAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgIH1cbiAgICAgIHZhbHVlID0gdGhpcy5lc2NhcGVWYWx1ZSA/IHJlZ2V4U2FmZSh0aGlzLmVzY2FwZSh2YWx1ZSkpIDogcmVnZXhTYWZlKHZhbHVlKTtcbiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG1hdGNoWzBdLCB2YWx1ZSk7XG4gICAgICB0aGlzLnJlZ2V4cC5sYXN0SW5kZXggPSAwO1xuICAgICAgcmVwbGFjZXMrKztcbiAgICAgIGlmIChyZXBsYWNlcyA+PSB0aGlzLm1heFJlcGxhY2VzKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RyO1xuICB9O1xuXG4gIEludGVycG9sYXRvci5wcm90b3R5cGUubmVzdCA9IGZ1bmN0aW9uIG5lc3Qoc3RyLCBmYykge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcblxuICAgIHZhciBtYXRjaCA9IHZvaWQgMDtcbiAgICB2YXIgdmFsdWUgPSB2b2lkIDA7XG5cbiAgICB2YXIgY2xvbmVkT3B0aW9ucyA9IF9leHRlbmRzKHt9LCBvcHRpb25zKTtcbiAgICBjbG9uZWRPcHRpb25zLmFwcGx5UG9zdFByb2Nlc3NvciA9IGZhbHNlOyAvLyBhdm9pZCBwb3N0IHByb2Nlc3Npbmcgb24gbmVzdGVkIGxvb2t1cFxuXG4gICAgLy8gaWYgdmFsdWUgaXMgc29tZXRoaW5nIGxpa2UgXCJteUtleVwiOiBcImxvcmVtICQoYW5vdGhlcktleSwgeyBcImNvdW50XCI6IHt7YVZhbHVlSW5PcHRpb25zfX0gfSlcIlxuICAgIGZ1bmN0aW9uIGhhbmRsZUhhc09wdGlvbnMoa2V5KSB7XG4gICAgICBpZiAoa2V5LmluZGV4T2YoJywnKSA8IDApIHJldHVybiBrZXk7XG5cbiAgICAgIHZhciBwID0ga2V5LnNwbGl0KCcsJyk7XG4gICAgICBrZXkgPSBwLnNoaWZ0KCk7XG4gICAgICB2YXIgb3B0aW9uc1N0cmluZyA9IHAuam9pbignLCcpO1xuICAgICAgb3B0aW9uc1N0cmluZyA9IHRoaXMuaW50ZXJwb2xhdGUob3B0aW9uc1N0cmluZywgY2xvbmVkT3B0aW9ucyk7XG4gICAgICBvcHRpb25zU3RyaW5nID0gb3B0aW9uc1N0cmluZy5yZXBsYWNlKC8nL2csICdcIicpO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjbG9uZWRPcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zU3RyaW5nKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ2ZhaWxlZCBwYXJzaW5nIG9wdGlvbnMgc3RyaW5nIGluIG5lc3RpbmcgZm9yIGtleSAnICsga2V5LCBlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGtleTtcbiAgICB9XG5cbiAgICAvLyByZWd1bGFyIGVzY2FwZSBvbiBkZW1hbmRcbiAgICB3aGlsZSAobWF0Y2ggPSB0aGlzLm5lc3RpbmdSZWdleHAuZXhlYyhzdHIpKSB7XG4gICAgICB2YWx1ZSA9IGZjKGhhbmRsZUhhc09wdGlvbnMuY2FsbCh0aGlzLCBtYXRjaFsxXS50cmltKCkpLCBjbG9uZWRPcHRpb25zKTtcblxuICAgICAgLy8gaXMgb25seSB0aGUgbmVzdGluZyBrZXkgKGtleTEgPSAnJChrZXkyKScpIHJldHVybiB0aGUgdmFsdWUgd2l0aG91dCBzdHJpbmdpZnlcbiAgICAgIGlmICh2YWx1ZSAmJiBtYXRjaFswXSA9PT0gc3RyICYmIHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHJldHVybiB2YWx1ZTtcblxuICAgICAgLy8gbm8gc3RyaW5nIHRvIGluY2x1ZGUgb3IgZW1wdHlcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB2YWx1ZSA9IG1ha2VTdHJpbmcodmFsdWUpO1xuICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICB0aGlzLmxvZ2dlci53YXJuKCdtaXNzZWQgdG8gcmVzb2x2ZSAnICsgbWF0Y2hbMV0gKyAnIGZvciBuZXN0aW5nICcgKyBzdHIpO1xuICAgICAgICB2YWx1ZSA9ICcnO1xuICAgICAgfVxuICAgICAgLy8gTmVzdGVkIGtleXMgc2hvdWxkIG5vdCBiZSBlc2NhcGVkIGJ5IGRlZmF1bHQgIzg1NFxuICAgICAgLy8gdmFsdWUgPSB0aGlzLmVzY2FwZVZhbHVlID8gcmVnZXhTYWZlKHV0aWxzLmVzY2FwZSh2YWx1ZSkpIDogcmVnZXhTYWZlKHZhbHVlKTtcbiAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKG1hdGNoWzBdLCB2YWx1ZSk7XG4gICAgICB0aGlzLnJlZ2V4cC5sYXN0SW5kZXggPSAwO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xuICB9O1xuXG4gIHJldHVybiBJbnRlcnBvbGF0b3I7XG59KCk7XG5cbmZ1bmN0aW9uIHJlbW92ZShhcnIsIHdoYXQpIHtcbiAgdmFyIGZvdW5kID0gYXJyLmluZGV4T2Yod2hhdCk7XG5cbiAgd2hpbGUgKGZvdW5kICE9PSAtMSkge1xuICAgIGFyci5zcGxpY2UoZm91bmQsIDEpO1xuICAgIGZvdW5kID0gYXJyLmluZGV4T2Yod2hhdCk7XG4gIH1cbn1cblxudmFyIENvbm5lY3RvciA9IGZ1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7XG4gIGluaGVyaXRzKENvbm5lY3RvciwgX0V2ZW50RW1pdHRlcik7XG5cbiAgZnVuY3Rpb24gQ29ubmVjdG9yKGJhY2tlbmQsIHN0b3JlLCBzZXJ2aWNlcykge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB7fTtcbiAgICBjbGFzc0NhbGxDaGVjayh0aGlzLCBDb25uZWN0b3IpO1xuXG4gICAgdmFyIF90aGlzID0gcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfRXZlbnRFbWl0dGVyLmNhbGwodGhpcykpO1xuXG4gICAgX3RoaXMuYmFja2VuZCA9IGJhY2tlbmQ7XG4gICAgX3RoaXMuc3RvcmUgPSBzdG9yZTtcbiAgICBfdGhpcy5sYW5ndWFnZVV0aWxzID0gc2VydmljZXMubGFuZ3VhZ2VVdGlscztcbiAgICBfdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICBfdGhpcy5sb2dnZXIgPSBiYXNlTG9nZ2VyLmNyZWF0ZSgnYmFja2VuZENvbm5lY3RvcicpO1xuXG4gICAgX3RoaXMuc3RhdGUgPSB7fTtcbiAgICBfdGhpcy5xdWV1ZSA9IFtdO1xuXG4gICAgaWYgKF90aGlzLmJhY2tlbmQgJiYgX3RoaXMuYmFja2VuZC5pbml0KSB7XG4gICAgICBfdGhpcy5iYWNrZW5kLmluaXQoc2VydmljZXMsIG9wdGlvbnMuYmFja2VuZCwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIENvbm5lY3Rvci5wcm90b3R5cGUucXVldWVMb2FkID0gZnVuY3Rpb24gcXVldWVMb2FkKGxhbmd1YWdlcywgbmFtZXNwYWNlcywgY2FsbGJhY2spIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIC8vIGZpbmQgd2hhdCBuZWVkcyB0byBiZSBsb2FkZWRcbiAgICB2YXIgdG9Mb2FkID0gW107XG4gICAgdmFyIHBlbmRpbmcgPSBbXTtcbiAgICB2YXIgdG9Mb2FkTGFuZ3VhZ2VzID0gW107XG4gICAgdmFyIHRvTG9hZE5hbWVzcGFjZXMgPSBbXTtcblxuICAgIGxhbmd1YWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChsbmcpIHtcbiAgICAgIHZhciBoYXNBbGxOYW1lc3BhY2VzID0gdHJ1ZTtcblxuICAgICAgbmFtZXNwYWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChucykge1xuICAgICAgICB2YXIgbmFtZSA9IGxuZyArICd8JyArIG5zO1xuXG4gICAgICAgIGlmIChfdGhpczIuc3RvcmUuaGFzUmVzb3VyY2VCdW5kbGUobG5nLCBucykpIHtcbiAgICAgICAgICBfdGhpczIuc3RhdGVbbmFtZV0gPSAyOyAvLyBsb2FkZWRcbiAgICAgICAgfSBlbHNlIGlmIChfdGhpczIuc3RhdGVbbmFtZV0gPCAwKSB7XG4gICAgICAgICAgLy8gbm90aGluZyB0byBkbyBmb3IgZXJyXG4gICAgICAgIH0gZWxzZSBpZiAoX3RoaXMyLnN0YXRlW25hbWVdID09PSAxKSB7XG4gICAgICAgICAgaWYgKHBlbmRpbmcuaW5kZXhPZihuYW1lKSA8IDApIHBlbmRpbmcucHVzaChuYW1lKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBfdGhpczIuc3RhdGVbbmFtZV0gPSAxOyAvLyBwZW5kaW5nXG5cbiAgICAgICAgICBoYXNBbGxOYW1lc3BhY2VzID0gZmFsc2U7XG5cbiAgICAgICAgICBpZiAocGVuZGluZy5pbmRleE9mKG5hbWUpIDwgMCkgcGVuZGluZy5wdXNoKG5hbWUpO1xuICAgICAgICAgIGlmICh0b0xvYWQuaW5kZXhPZihuYW1lKSA8IDApIHRvTG9hZC5wdXNoKG5hbWUpO1xuICAgICAgICAgIGlmICh0b0xvYWROYW1lc3BhY2VzLmluZGV4T2YobnMpIDwgMCkgdG9Mb2FkTmFtZXNwYWNlcy5wdXNoKG5zKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmICghaGFzQWxsTmFtZXNwYWNlcykgdG9Mb2FkTGFuZ3VhZ2VzLnB1c2gobG5nKTtcbiAgICB9KTtcblxuICAgIGlmICh0b0xvYWQubGVuZ3RoIHx8IHBlbmRpbmcubGVuZ3RoKSB7XG4gICAgICB0aGlzLnF1ZXVlLnB1c2goe1xuICAgICAgICBwZW5kaW5nOiBwZW5kaW5nLFxuICAgICAgICBsb2FkZWQ6IHt9LFxuICAgICAgICBlcnJvcnM6IFtdLFxuICAgICAgICBjYWxsYmFjazogY2FsbGJhY2tcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0b0xvYWQ6IHRvTG9hZCxcbiAgICAgIHBlbmRpbmc6IHBlbmRpbmcsXG4gICAgICB0b0xvYWRMYW5ndWFnZXM6IHRvTG9hZExhbmd1YWdlcyxcbiAgICAgIHRvTG9hZE5hbWVzcGFjZXM6IHRvTG9hZE5hbWVzcGFjZXNcbiAgICB9O1xuICB9O1xuXG4gIENvbm5lY3Rvci5wcm90b3R5cGUubG9hZGVkID0gZnVuY3Rpb24gbG9hZGVkKG5hbWUsIGVyciwgZGF0YSkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIF9uYW1lJHNwbGl0ID0gbmFtZS5zcGxpdCgnfCcpLFxuICAgICAgICBfbmFtZSRzcGxpdDIgPSBzbGljZWRUb0FycmF5KF9uYW1lJHNwbGl0LCAyKSxcbiAgICAgICAgbG5nID0gX25hbWUkc3BsaXQyWzBdLFxuICAgICAgICBucyA9IF9uYW1lJHNwbGl0MlsxXTtcblxuICAgIGlmIChlcnIpIHRoaXMuZW1pdCgnZmFpbGVkTG9hZGluZycsIGxuZywgbnMsIGVycik7XG5cbiAgICBpZiAoZGF0YSkge1xuICAgICAgdGhpcy5zdG9yZS5hZGRSZXNvdXJjZUJ1bmRsZShsbmcsIG5zLCBkYXRhKTtcbiAgICB9XG5cbiAgICAvLyBzZXQgbG9hZGVkXG4gICAgdGhpcy5zdGF0ZVtuYW1lXSA9IGVyciA/IC0xIDogMjtcblxuICAgIC8vIGNhbGxiYWNrIGlmIHJlYWR5XG4gICAgdGhpcy5xdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uIChxKSB7XG4gICAgICBwdXNoUGF0aChxLmxvYWRlZCwgW2xuZ10sIG5zKTtcbiAgICAgIHJlbW92ZShxLnBlbmRpbmcsIG5hbWUpO1xuXG4gICAgICBpZiAoZXJyKSBxLmVycm9ycy5wdXNoKGVycik7XG5cbiAgICAgIGlmIChxLnBlbmRpbmcubGVuZ3RoID09PSAwICYmICFxLmRvbmUpIHtcbiAgICAgICAgX3RoaXMzLmVtaXQoJ2xvYWRlZCcsIHEubG9hZGVkKTtcbiAgICAgICAgLyogZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOiAwICovXG4gICAgICAgIHEuZG9uZSA9IHRydWU7XG4gICAgICAgIGlmIChxLmVycm9ycy5sZW5ndGgpIHtcbiAgICAgICAgICBxLmNhbGxiYWNrKHEuZXJyb3JzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBxLmNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHJlbW92ZSBkb25lIGxvYWQgcmVxdWVzdHNcbiAgICB0aGlzLnF1ZXVlID0gdGhpcy5xdWV1ZS5maWx0ZXIoZnVuY3Rpb24gKHEpIHtcbiAgICAgIHJldHVybiAhcS5kb25lO1xuICAgIH0pO1xuICB9O1xuXG4gIENvbm5lY3Rvci5wcm90b3R5cGUucmVhZCA9IGZ1bmN0aW9uIHJlYWQobG5nLCBucywgZmNOYW1lKSB7XG4gICAgdmFyIHRyaWVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAwO1xuXG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICB2YXIgd2FpdCA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogMjUwO1xuICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1s1XTtcblxuICAgIGlmICghbG5nLmxlbmd0aCkgcmV0dXJuIGNhbGxiYWNrKG51bGwsIHt9KTsgLy8gbm90aW5nIHRvIGxvYWRcblxuICAgIHJldHVybiB0aGlzLmJhY2tlbmRbZmNOYW1lXShsbmcsIG5zLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyICYmIGRhdGEgLyogPSByZXRyeUZsYWcgKi8gJiYgdHJpZWQgPCA1KSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzNC5yZWFkLmNhbGwoX3RoaXM0LCBsbmcsIG5zLCBmY05hbWUsIHRyaWVkICsgMSwgd2FpdCAqIDIsIGNhbGxiYWNrKTtcbiAgICAgICAgfSwgd2FpdCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNhbGxiYWNrKGVyciwgZGF0YSk7XG4gICAgfSk7XG4gIH07XG5cbiAgLyogZXNsaW50IGNvbnNpc3RlbnQtcmV0dXJuOiAwICovXG5cblxuICBDb25uZWN0b3IucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiBsb2FkKGxhbmd1YWdlcywgbmFtZXNwYWNlcywgY2FsbGJhY2spIHtcbiAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgIGlmICghdGhpcy5iYWNrZW5kKSB7XG4gICAgICB0aGlzLmxvZ2dlci53YXJuKCdObyBiYWNrZW5kIHdhcyBhZGRlZCB2aWEgaTE4bmV4dC51c2UuIFdpbGwgbm90IGxvYWQgcmVzb3VyY2VzLicpO1xuICAgICAgcmV0dXJuIGNhbGxiYWNrICYmIGNhbGxiYWNrKCk7XG4gICAgfVxuICAgIHZhciBvcHRpb25zID0gX2V4dGVuZHMoe30sIHRoaXMuYmFja2VuZC5vcHRpb25zLCB0aGlzLm9wdGlvbnMuYmFja2VuZCk7XG5cbiAgICBpZiAodHlwZW9mIGxhbmd1YWdlcyA9PT0gJ3N0cmluZycpIGxhbmd1YWdlcyA9IHRoaXMubGFuZ3VhZ2VVdGlscy50b1Jlc29sdmVIaWVyYXJjaHkobGFuZ3VhZ2VzKTtcbiAgICBpZiAodHlwZW9mIG5hbWVzcGFjZXMgPT09ICdzdHJpbmcnKSBuYW1lc3BhY2VzID0gW25hbWVzcGFjZXNdO1xuXG4gICAgdmFyIHRvTG9hZCA9IHRoaXMucXVldWVMb2FkKGxhbmd1YWdlcywgbmFtZXNwYWNlcywgY2FsbGJhY2spO1xuICAgIGlmICghdG9Mb2FkLnRvTG9hZC5sZW5ndGgpIHtcbiAgICAgIGlmICghdG9Mb2FkLnBlbmRpbmcubGVuZ3RoKSBjYWxsYmFjaygpOyAvLyBub3RoaW5nIHRvIGxvYWQgYW5kIG5vIHBlbmRpbmdzLi4uY2FsbGJhY2sgbm93XG4gICAgICByZXR1cm4gbnVsbDsgLy8gcGVuZGluZ3Mgd2lsbCB0cmlnZ2VyIGNhbGxiYWNrXG4gICAgfVxuXG4gICAgLy8gbG9hZCB3aXRoIG11bHRpLWxvYWRcbiAgICBpZiAob3B0aW9ucy5hbGxvd011bHRpTG9hZGluZyAmJiB0aGlzLmJhY2tlbmQucmVhZE11bHRpKSB7XG4gICAgICB0aGlzLnJlYWQodG9Mb2FkLnRvTG9hZExhbmd1YWdlcywgdG9Mb2FkLnRvTG9hZE5hbWVzcGFjZXMsICdyZWFkTXVsdGknLCBudWxsLCBudWxsLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgIGlmIChlcnIpIF90aGlzNS5sb2dnZXIud2FybignbG9hZGluZyBuYW1lc3BhY2VzICcgKyB0b0xvYWQudG9Mb2FkTmFtZXNwYWNlcy5qb2luKCcsICcpICsgJyBmb3IgbGFuZ3VhZ2VzICcgKyB0b0xvYWQudG9Mb2FkTGFuZ3VhZ2VzLmpvaW4oJywgJykgKyAnIHZpYSBtdWx0aWxvYWRpbmcgZmFpbGVkJywgZXJyKTtcbiAgICAgICAgaWYgKCFlcnIgJiYgZGF0YSkgX3RoaXM1LmxvZ2dlci5sb2coJ3N1Y2Nlc3NmdWxseSBsb2FkZWQgbmFtZXNwYWNlcyAnICsgdG9Mb2FkLnRvTG9hZE5hbWVzcGFjZXMuam9pbignLCAnKSArICcgZm9yIGxhbmd1YWdlcyAnICsgdG9Mb2FkLnRvTG9hZExhbmd1YWdlcy5qb2luKCcsICcpICsgJyB2aWEgbXVsdGlsb2FkaW5nJywgZGF0YSk7XG5cbiAgICAgICAgdG9Mb2FkLnRvTG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgdmFyIF9uYW1lJHNwbGl0MyA9IG5hbWUuc3BsaXQoJ3wnKSxcbiAgICAgICAgICAgICAgX25hbWUkc3BsaXQ0ID0gc2xpY2VkVG9BcnJheShfbmFtZSRzcGxpdDMsIDIpLFxuICAgICAgICAgICAgICBsID0gX25hbWUkc3BsaXQ0WzBdLFxuICAgICAgICAgICAgICBuID0gX25hbWUkc3BsaXQ0WzFdO1xuXG4gICAgICAgICAgdmFyIGJ1bmRsZSA9IGdldFBhdGgoZGF0YSwgW2wsIG5dKTtcbiAgICAgICAgICBpZiAoYnVuZGxlKSB7XG4gICAgICAgICAgICBfdGhpczUubG9hZGVkKG5hbWUsIGVyciwgYnVuZGxlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGVycm9yID0gJ2xvYWRpbmcgbmFtZXNwYWNlICcgKyBuICsgJyBmb3IgbGFuZ3VhZ2UgJyArIGwgKyAnIHZpYSBtdWx0aWxvYWRpbmcgZmFpbGVkJztcbiAgICAgICAgICAgIF90aGlzNS5sb2FkZWQobmFtZSwgZXJyb3IpO1xuICAgICAgICAgICAgX3RoaXM1LmxvZ2dlci5lcnJvcihlcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0b0xvYWQudG9Mb2FkLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgX3RoaXM1LmxvYWRPbmUobmFtZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgQ29ubmVjdG9yLnByb3RvdHlwZS5yZWxvYWQgPSBmdW5jdGlvbiByZWxvYWQobGFuZ3VhZ2VzLCBuYW1lc3BhY2VzKSB7XG4gICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMuYmFja2VuZCkge1xuICAgICAgdGhpcy5sb2dnZXIud2FybignTm8gYmFja2VuZCB3YXMgYWRkZWQgdmlhIGkxOG5leHQudXNlLiBXaWxsIG5vdCBsb2FkIHJlc291cmNlcy4nKTtcbiAgICB9XG4gICAgdmFyIG9wdGlvbnMgPSBfZXh0ZW5kcyh7fSwgdGhpcy5iYWNrZW5kLm9wdGlvbnMsIHRoaXMub3B0aW9ucy5iYWNrZW5kKTtcblxuICAgIGlmICh0eXBlb2YgbGFuZ3VhZ2VzID09PSAnc3RyaW5nJykgbGFuZ3VhZ2VzID0gdGhpcy5sYW5ndWFnZVV0aWxzLnRvUmVzb2x2ZUhpZXJhcmNoeShsYW5ndWFnZXMpO1xuICAgIGlmICh0eXBlb2YgbmFtZXNwYWNlcyA9PT0gJ3N0cmluZycpIG5hbWVzcGFjZXMgPSBbbmFtZXNwYWNlc107XG5cbiAgICAvLyBsb2FkIHdpdGggbXVsdGktbG9hZFxuICAgIGlmIChvcHRpb25zLmFsbG93TXVsdGlMb2FkaW5nICYmIHRoaXMuYmFja2VuZC5yZWFkTXVsdGkpIHtcbiAgICAgIHRoaXMucmVhZChsYW5ndWFnZXMsIG5hbWVzcGFjZXMsICdyZWFkTXVsdGknLCBudWxsLCBudWxsLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgIGlmIChlcnIpIF90aGlzNi5sb2dnZXIud2FybigncmVsb2FkaW5nIG5hbWVzcGFjZXMgJyArIG5hbWVzcGFjZXMuam9pbignLCAnKSArICcgZm9yIGxhbmd1YWdlcyAnICsgbGFuZ3VhZ2VzLmpvaW4oJywgJykgKyAnIHZpYSBtdWx0aWxvYWRpbmcgZmFpbGVkJywgZXJyKTtcbiAgICAgICAgaWYgKCFlcnIgJiYgZGF0YSkgX3RoaXM2LmxvZ2dlci5sb2coJ3N1Y2Nlc3NmdWxseSByZWxvYWRlZCBuYW1lc3BhY2VzICcgKyBuYW1lc3BhY2VzLmpvaW4oJywgJykgKyAnIGZvciBsYW5ndWFnZXMgJyArIGxhbmd1YWdlcy5qb2luKCcsICcpICsgJyB2aWEgbXVsdGlsb2FkaW5nJywgZGF0YSk7XG5cbiAgICAgICAgbGFuZ3VhZ2VzLmZvckVhY2goZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICBuYW1lc3BhY2VzLmZvckVhY2goZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHZhciBidW5kbGUgPSBnZXRQYXRoKGRhdGEsIFtsLCBuXSk7XG4gICAgICAgICAgICBpZiAoYnVuZGxlKSB7XG4gICAgICAgICAgICAgIF90aGlzNi5sb2FkZWQobCArICd8JyArIG4sIGVyciwgYnVuZGxlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHZhciBlcnJvciA9ICdyZWxvYWRpbmcgbmFtZXNwYWNlICcgKyBuICsgJyBmb3IgbGFuZ3VhZ2UgJyArIGwgKyAnIHZpYSBtdWx0aWxvYWRpbmcgZmFpbGVkJztcbiAgICAgICAgICAgICAgX3RoaXM2LmxvYWRlZChsICsgJ3wnICsgbiwgZXJyb3IpO1xuICAgICAgICAgICAgICBfdGhpczYubG9nZ2VyLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGFuZ3VhZ2VzLmZvckVhY2goZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgbmFtZXNwYWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgX3RoaXM2LmxvYWRPbmUobCArICd8JyArIG4sICdyZScpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBDb25uZWN0b3IucHJvdG90eXBlLmxvYWRPbmUgPSBmdW5jdGlvbiBsb2FkT25lKG5hbWUpIHtcbiAgICB2YXIgX3RoaXM3ID0gdGhpcztcblxuICAgIHZhciBwcmVmaXggPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICcnO1xuXG4gICAgdmFyIF9uYW1lJHNwbGl0NSA9IG5hbWUuc3BsaXQoJ3wnKSxcbiAgICAgICAgX25hbWUkc3BsaXQ2ID0gc2xpY2VkVG9BcnJheShfbmFtZSRzcGxpdDUsIDIpLFxuICAgICAgICBsbmcgPSBfbmFtZSRzcGxpdDZbMF0sXG4gICAgICAgIG5zID0gX25hbWUkc3BsaXQ2WzFdO1xuXG4gICAgdGhpcy5yZWFkKGxuZywgbnMsICdyZWFkJywgbnVsbCwgbnVsbCwgZnVuY3Rpb24gKGVyciwgZGF0YSkge1xuICAgICAgaWYgKGVycikgX3RoaXM3LmxvZ2dlci53YXJuKHByZWZpeCArICdsb2FkaW5nIG5hbWVzcGFjZSAnICsgbnMgKyAnIGZvciBsYW5ndWFnZSAnICsgbG5nICsgJyBmYWlsZWQnLCBlcnIpO1xuICAgICAgaWYgKCFlcnIgJiYgZGF0YSkgX3RoaXM3LmxvZ2dlci5sb2cocHJlZml4ICsgJ2xvYWRlZCBuYW1lc3BhY2UgJyArIG5zICsgJyBmb3IgbGFuZ3VhZ2UgJyArIGxuZywgZGF0YSk7XG5cbiAgICAgIF90aGlzNy5sb2FkZWQobmFtZSwgZXJyLCBkYXRhKTtcbiAgICB9KTtcbiAgfTtcblxuICBDb25uZWN0b3IucHJvdG90eXBlLnNhdmVNaXNzaW5nID0gZnVuY3Rpb24gc2F2ZU1pc3NpbmcobGFuZ3VhZ2VzLCBuYW1lc3BhY2UsIGtleSwgZmFsbGJhY2tWYWx1ZSkge1xuICAgIGlmICh0aGlzLmJhY2tlbmQgJiYgdGhpcy5iYWNrZW5kLmNyZWF0ZSkgdGhpcy5iYWNrZW5kLmNyZWF0ZShsYW5ndWFnZXMsIG5hbWVzcGFjZSwga2V5LCBmYWxsYmFja1ZhbHVlKTtcblxuICAgIC8vIHdyaXRlIHRvIHN0b3JlIHRvIGF2b2lkIHJlc2VuZGluZ1xuICAgIGlmICghbGFuZ3VhZ2VzIHx8ICFsYW5ndWFnZXNbMF0pIHJldHVybjtcbiAgICB0aGlzLnN0b3JlLmFkZFJlc291cmNlKGxhbmd1YWdlc1swXSwgbmFtZXNwYWNlLCBrZXksIGZhbGxiYWNrVmFsdWUpO1xuICB9O1xuXG4gIHJldHVybiBDb25uZWN0b3I7XG59KEV2ZW50RW1pdHRlcik7XG5cbnZhciBDb25uZWN0b3IkMSA9IGZ1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7XG4gIGluaGVyaXRzKENvbm5lY3RvciwgX0V2ZW50RW1pdHRlcik7XG5cbiAgZnVuY3Rpb24gQ29ubmVjdG9yKGNhY2hlLCBzdG9yZSwgc2VydmljZXMpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29ubmVjdG9yKTtcblxuICAgIHZhciBfdGhpcyA9IHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0V2ZW50RW1pdHRlci5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzLmNhY2hlID0gY2FjaGU7XG4gICAgX3RoaXMuc3RvcmUgPSBzdG9yZTtcbiAgICBfdGhpcy5zZXJ2aWNlcyA9IHNlcnZpY2VzO1xuICAgIF90aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgIF90aGlzLmxvZ2dlciA9IGJhc2VMb2dnZXIuY3JlYXRlKCdjYWNoZUNvbm5lY3RvcicpO1xuXG4gICAgaWYgKF90aGlzLmNhY2hlICYmIF90aGlzLmNhY2hlLmluaXQpIF90aGlzLmNhY2hlLmluaXQoc2VydmljZXMsIG9wdGlvbnMuY2FjaGUsIG9wdGlvbnMpO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIC8qIGVzbGludCBjb25zaXN0ZW50LXJldHVybjogMCAqL1xuXG5cbiAgQ29ubmVjdG9yLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gbG9hZChsYW5ndWFnZXMsIG5hbWVzcGFjZXMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICBpZiAoIXRoaXMuY2FjaGUpIHJldHVybiBjYWxsYmFjayAmJiBjYWxsYmFjaygpO1xuICAgIHZhciBvcHRpb25zID0gX2V4dGVuZHMoe30sIHRoaXMuY2FjaGUub3B0aW9ucywgdGhpcy5vcHRpb25zLmNhY2hlKTtcblxuICAgIHZhciBsb2FkTG5ncyA9IHR5cGVvZiBsYW5ndWFnZXMgPT09ICdzdHJpbmcnID8gdGhpcy5zZXJ2aWNlcy5sYW5ndWFnZVV0aWxzLnRvUmVzb2x2ZUhpZXJhcmNoeShsYW5ndWFnZXMpIDogbGFuZ3VhZ2VzO1xuXG4gICAgaWYgKG9wdGlvbnMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5jYWNoZS5sb2FkKGxvYWRMbmdzLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7XG4gICAgICAgIGlmIChlcnIpIF90aGlzMi5sb2dnZXIuZXJyb3IoJ2xvYWRpbmcgbGFuZ3VhZ2VzICcgKyBsb2FkTG5ncy5qb2luKCcsICcpICsgJyBmcm9tIGNhY2hlIGZhaWxlZCcsIGVycik7XG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgLyogZXNsaW50IG5vLXJlc3RyaWN0ZWQtc3ludGF4OiAwICovXG4gICAgICAgICAgZm9yICh2YXIgbCBpbiBkYXRhKSB7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGEsIGwpKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIG4gaW4gZGF0YVtsXSkge1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZGF0YVtsXSwgbikpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChuICE9PSAnaTE4blN0YW1wJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnVuZGxlID0gZGF0YVtsXVtuXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1bmRsZSkgX3RoaXMyLnN0b3JlLmFkZFJlc291cmNlQnVuZGxlKGwsIG4sIGJ1bmRsZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoY2FsbGJhY2spIHtcbiAgICAgIGNhbGxiYWNrKCk7XG4gICAgfVxuICB9O1xuXG4gIENvbm5lY3Rvci5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIHNhdmUoKSB7XG4gICAgaWYgKHRoaXMuY2FjaGUgJiYgdGhpcy5vcHRpb25zLmNhY2hlICYmIHRoaXMub3B0aW9ucy5jYWNoZS5lbmFibGVkKSB0aGlzLmNhY2hlLnNhdmUodGhpcy5zdG9yZS5kYXRhKTtcbiAgfTtcblxuICByZXR1cm4gQ29ubmVjdG9yO1xufShFdmVudEVtaXR0ZXIpO1xuXG5mdW5jdGlvbiBnZXQkMSgpIHtcbiAgcmV0dXJuIHtcbiAgICBkZWJ1ZzogZmFsc2UsXG4gICAgaW5pdEltbWVkaWF0ZTogdHJ1ZSxcblxuICAgIG5zOiBbJ3RyYW5zbGF0aW9uJ10sXG4gICAgZGVmYXVsdE5TOiBbJ3RyYW5zbGF0aW9uJ10sXG4gICAgZmFsbGJhY2tMbmc6IFsnZGV2J10sXG4gICAgZmFsbGJhY2tOUzogZmFsc2UsIC8vIHN0cmluZyBvciBhcnJheSBvZiBuYW1lc3BhY2VzXG5cbiAgICB3aGl0ZWxpc3Q6IGZhbHNlLCAvLyBhcnJheSB3aXRoIHdoaXRlbGlzdGVkIGxhbmd1YWdlc1xuICAgIG5vbkV4cGxpY2l0V2hpdGVsaXN0OiBmYWxzZSxcbiAgICBsb2FkOiAnYWxsJywgLy8gfCBjdXJyZW50T25seSB8IGxhbmd1YWdlT25seVxuICAgIHByZWxvYWQ6IGZhbHNlLCAvLyBhcnJheSB3aXRoIHByZWxvYWQgbGFuZ3VhZ2VzXG5cbiAgICBzaW1wbGlmeVBsdXJhbFN1ZmZpeDogdHJ1ZSxcbiAgICBrZXlTZXBhcmF0b3I6ICcuJyxcbiAgICBuc1NlcGFyYXRvcjogJzonLFxuICAgIHBsdXJhbFNlcGFyYXRvcjogJ18nLFxuICAgIGNvbnRleHRTZXBhcmF0b3I6ICdfJyxcblxuICAgIHNhdmVNaXNzaW5nOiBmYWxzZSwgLy8gZW5hYmxlIHRvIHNlbmQgbWlzc2luZyB2YWx1ZXNcbiAgICBzYXZlTWlzc2luZ1RvOiAnZmFsbGJhY2snLCAvLyAnY3VycmVudCcgfHwgJ2FsbCdcbiAgICBtaXNzaW5nS2V5SGFuZGxlcjogZmFsc2UsIC8vIGZ1bmN0aW9uKGxuZywgbnMsIGtleSwgZmFsbGJhY2tWYWx1ZSkgLT4gb3ZlcnJpZGUgaWYgcHJlZmVyIG9uIGhhbmRsaW5nXG5cbiAgICBwb3N0UHJvY2VzczogZmFsc2UsIC8vIHN0cmluZyBvciBhcnJheSBvZiBwb3N0UHJvY2Vzc29yIG5hbWVzXG4gICAgcmV0dXJuTnVsbDogdHJ1ZSwgLy8gYWxsb3dzIG51bGwgdmFsdWUgYXMgdmFsaWQgdHJhbnNsYXRpb25cbiAgICByZXR1cm5FbXB0eVN0cmluZzogdHJ1ZSwgLy8gYWxsb3dzIGVtcHR5IHN0cmluZyB2YWx1ZSBhcyB2YWxpZCB0cmFuc2xhdGlvblxuICAgIHJldHVybk9iamVjdHM6IGZhbHNlLFxuICAgIGpvaW5BcnJheXM6IGZhbHNlLCAvLyBvciBzdHJpbmcgdG8gam9pbiBhcnJheVxuICAgIHJldHVybmVkT2JqZWN0SGFuZGxlcjogZnVuY3Rpb24gcmV0dXJuZWRPYmplY3RIYW5kbGVyKCkge30sIC8vIGZ1bmN0aW9uKGtleSwgdmFsdWUsIG9wdGlvbnMpIHRyaWdnZXJlZCBpZiBrZXkgcmV0dXJucyBvYmplY3QgYnV0IHJldHVybk9iamVjdHMgaXMgc2V0IHRvIGZhbHNlXG4gICAgcGFyc2VNaXNzaW5nS2V5SGFuZGxlcjogZmFsc2UsIC8vIGZ1bmN0aW9uKGtleSkgcGFyc2VkIGEga2V5IHRoYXQgd2FzIG5vdCBmb3VuZCBpbiB0KCkgYmVmb3JlIHJldHVybmluZ1xuICAgIGFwcGVuZE5hbWVzcGFjZVRvTWlzc2luZ0tleTogZmFsc2UsXG4gICAgYXBwZW5kTmFtZXNwYWNlVG9DSU1vZGU6IGZhbHNlLFxuICAgIG92ZXJsb2FkVHJhbnNsYXRpb25PcHRpb25IYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGUoYXJncykge1xuICAgICAgcmV0dXJuIHsgZGVmYXVsdFZhbHVlOiBhcmdzWzFdIH07XG4gICAgfSxcblxuICAgIGludGVycG9sYXRpb246IHtcbiAgICAgIGVzY2FwZVZhbHVlOiB0cnVlLFxuICAgICAgZm9ybWF0OiBmdW5jdGlvbiBmb3JtYXQodmFsdWUsIF9mb3JtYXQsIGxuZykge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9LFxuICAgICAgcHJlZml4OiAne3snLFxuICAgICAgc3VmZml4OiAnfX0nLFxuICAgICAgZm9ybWF0U2VwYXJhdG9yOiAnLCcsXG4gICAgICAvLyBwcmVmaXhFc2NhcGVkOiAne3snLFxuICAgICAgLy8gc3VmZml4RXNjYXBlZDogJ319JyxcbiAgICAgIC8vIHVuZXNjYXBlU3VmZml4OiAnJyxcbiAgICAgIHVuZXNjYXBlUHJlZml4OiAnLScsXG5cbiAgICAgIG5lc3RpbmdQcmVmaXg6ICckdCgnLFxuICAgICAgbmVzdGluZ1N1ZmZpeDogJyknLFxuICAgICAgLy8gbmVzdGluZ1ByZWZpeEVzY2FwZWQ6ICckdCgnLFxuICAgICAgLy8gbmVzdGluZ1N1ZmZpeEVzY2FwZWQ6ICcpJyxcbiAgICAgIC8vIGRlZmF1bHRWYXJpYWJsZXM6IHVuZGVmaW5lZCAvLyBvYmplY3QgdGhhdCBjYW4gaGF2ZSB2YWx1ZXMgdG8gaW50ZXJwb2xhdGUgb24gLSBleHRlbmRzIHBhc3NlZCBpbiBpbnRlcnBvbGF0aW9uIGRhdGFcbiAgICAgIG1heFJlcGxhY2VzOiAxMDAwIC8vIG1heCByZXBsYWNlcyB0byBwcmV2ZW50IGVuZGxlc3MgbG9vcFxuICAgIH1cbiAgfTtcbn1cblxuLyogZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOiAwICovXG5mdW5jdGlvbiB0cmFuc2Zvcm1PcHRpb25zKG9wdGlvbnMpIHtcbiAgLy8gY3JlYXRlIG5hbWVzcGFjZSBvYmplY3QgaWYgbmFtZXNwYWNlIGlzIHBhc3NlZCBpbiBhcyBzdHJpbmdcbiAgaWYgKHR5cGVvZiBvcHRpb25zLm5zID09PSAnc3RyaW5nJykgb3B0aW9ucy5ucyA9IFtvcHRpb25zLm5zXTtcbiAgaWYgKHR5cGVvZiBvcHRpb25zLmZhbGxiYWNrTG5nID09PSAnc3RyaW5nJykgb3B0aW9ucy5mYWxsYmFja0xuZyA9IFtvcHRpb25zLmZhbGxiYWNrTG5nXTtcbiAgaWYgKHR5cGVvZiBvcHRpb25zLmZhbGxiYWNrTlMgPT09ICdzdHJpbmcnKSBvcHRpb25zLmZhbGxiYWNrTlMgPSBbb3B0aW9ucy5mYWxsYmFja05TXTtcblxuICAvLyBleHRlbmQgd2hpdGVsaXN0IHdpdGggY2ltb2RlXG4gIGlmIChvcHRpb25zLndoaXRlbGlzdCAmJiBvcHRpb25zLndoaXRlbGlzdC5pbmRleE9mKCdjaW1vZGUnKSA8IDApIG9wdGlvbnMud2hpdGVsaXN0LnB1c2goJ2NpbW9kZScpO1xuXG4gIHJldHVybiBvcHRpb25zO1xufVxuXG5mdW5jdGlvbiBub29wKCkge31cblxudmFyIEkxOG4gPSBmdW5jdGlvbiAoX0V2ZW50RW1pdHRlcikge1xuICBpbmhlcml0cyhJMThuLCBfRXZlbnRFbWl0dGVyKTtcblxuICBmdW5jdGlvbiBJMThuKCkge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHNbMV07XG4gICAgY2xhc3NDYWxsQ2hlY2sodGhpcywgSTE4bik7XG5cbiAgICB2YXIgX3RoaXMgPSBwb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9FdmVudEVtaXR0ZXIuY2FsbCh0aGlzKSk7XG5cbiAgICBfdGhpcy5vcHRpb25zID0gdHJhbnNmb3JtT3B0aW9ucyhvcHRpb25zKTtcbiAgICBfdGhpcy5zZXJ2aWNlcyA9IHt9O1xuICAgIF90aGlzLmxvZ2dlciA9IGJhc2VMb2dnZXI7XG4gICAgX3RoaXMubW9kdWxlcyA9IHsgZXh0ZXJuYWw6IFtdIH07XG5cbiAgICBpZiAoY2FsbGJhY2sgJiYgIV90aGlzLmlzSW5pdGlhbGl6ZWQgJiYgIW9wdGlvbnMuaXNDbG9uZSkge1xuICAgICAgdmFyIF9yZXQ7XG5cbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9pMThuZXh0L2kxOG5leHQvaXNzdWVzLzg3OVxuICAgICAgaWYgKCFfdGhpcy5vcHRpb25zLmluaXRJbW1lZGlhdGUpIHJldHVybiBfcmV0ID0gX3RoaXMuaW5pdChvcHRpb25zLCBjYWxsYmFjayksIHBvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMsIF9yZXQpO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLmluaXQob3B0aW9ucywgY2FsbGJhY2spO1xuICAgICAgfSwgMCk7XG4gICAgfVxuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIEkxOG4ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1sxXTtcblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY2FsbGJhY2sgPSBvcHRpb25zO1xuICAgICAgb3B0aW9ucyA9IHt9O1xuICAgIH1cbiAgICB0aGlzLm9wdGlvbnMgPSBfZXh0ZW5kcyh7fSwgZ2V0JDEoKSwgdGhpcy5vcHRpb25zLCB0cmFuc2Zvcm1PcHRpb25zKG9wdGlvbnMpKTtcblxuICAgIHRoaXMuZm9ybWF0ID0gdGhpcy5vcHRpb25zLmludGVycG9sYXRpb24uZm9ybWF0O1xuICAgIGlmICghY2FsbGJhY2spIGNhbGxiYWNrID0gbm9vcDtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNsYXNzT25EZW1hbmQoQ2xhc3NPck9iamVjdCkge1xuICAgICAgaWYgKCFDbGFzc09yT2JqZWN0KSByZXR1cm4gbnVsbDtcbiAgICAgIGlmICh0eXBlb2YgQ2xhc3NPck9iamVjdCA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIG5ldyBDbGFzc09yT2JqZWN0KCk7XG4gICAgICByZXR1cm4gQ2xhc3NPck9iamVjdDtcbiAgICB9XG5cbiAgICAvLyBpbml0IHNlcnZpY2VzXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuaXNDbG9uZSkge1xuICAgICAgaWYgKHRoaXMubW9kdWxlcy5sb2dnZXIpIHtcbiAgICAgICAgYmFzZUxvZ2dlci5pbml0KGNyZWF0ZUNsYXNzT25EZW1hbmQodGhpcy5tb2R1bGVzLmxvZ2dlciksIHRoaXMub3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiYXNlTG9nZ2VyLmluaXQobnVsbCwgdGhpcy5vcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGx1ID0gbmV3IExhbmd1YWdlVXRpbCh0aGlzLm9wdGlvbnMpO1xuICAgICAgdGhpcy5zdG9yZSA9IG5ldyBSZXNvdXJjZVN0b3JlKHRoaXMub3B0aW9ucy5yZXNvdXJjZXMsIHRoaXMub3B0aW9ucyk7XG5cbiAgICAgIHZhciBzID0gdGhpcy5zZXJ2aWNlcztcbiAgICAgIHMubG9nZ2VyID0gYmFzZUxvZ2dlcjtcbiAgICAgIHMucmVzb3VyY2VTdG9yZSA9IHRoaXMuc3RvcmU7XG4gICAgICBzLnJlc291cmNlU3RvcmUub24oJ2FkZGVkIHJlbW92ZWQnLCBmdW5jdGlvbiAobG5nLCBucykge1xuICAgICAgICBzLmNhY2hlQ29ubmVjdG9yLnNhdmUoKTtcbiAgICAgIH0pO1xuICAgICAgcy5sYW5ndWFnZVV0aWxzID0gbHU7XG4gICAgICBzLnBsdXJhbFJlc29sdmVyID0gbmV3IFBsdXJhbFJlc29sdmVyKGx1LCB7IHByZXBlbmQ6IHRoaXMub3B0aW9ucy5wbHVyYWxTZXBhcmF0b3IsIGNvbXBhdGliaWxpdHlKU09OOiB0aGlzLm9wdGlvbnMuY29tcGF0aWJpbGl0eUpTT04sIHNpbXBsaWZ5UGx1cmFsU3VmZml4OiB0aGlzLm9wdGlvbnMuc2ltcGxpZnlQbHVyYWxTdWZmaXggfSk7XG4gICAgICBzLmludGVycG9sYXRvciA9IG5ldyBJbnRlcnBvbGF0b3IodGhpcy5vcHRpb25zKTtcblxuICAgICAgcy5iYWNrZW5kQ29ubmVjdG9yID0gbmV3IENvbm5lY3RvcihjcmVhdGVDbGFzc09uRGVtYW5kKHRoaXMubW9kdWxlcy5iYWNrZW5kKSwgcy5yZXNvdXJjZVN0b3JlLCBzLCB0aGlzLm9wdGlvbnMpO1xuICAgICAgLy8gcGlwZSBldmVudHMgZnJvbSBiYWNrZW5kQ29ubmVjdG9yXG4gICAgICBzLmJhY2tlbmRDb25uZWN0b3Iub24oJyonLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczIuZW1pdC5hcHBseShfdGhpczIsIFtldmVudF0uY29uY2F0KGFyZ3MpKTtcbiAgICAgIH0pO1xuXG4gICAgICBzLmJhY2tlbmRDb25uZWN0b3Iub24oJ2xvYWRlZCcsIGZ1bmN0aW9uIChsb2FkZWQpIHtcbiAgICAgICAgcy5jYWNoZUNvbm5lY3Rvci5zYXZlKCk7XG4gICAgICB9KTtcblxuICAgICAgcy5jYWNoZUNvbm5lY3RvciA9IG5ldyBDb25uZWN0b3IkMShjcmVhdGVDbGFzc09uRGVtYW5kKHRoaXMubW9kdWxlcy5jYWNoZSksIHMucmVzb3VyY2VTdG9yZSwgcywgdGhpcy5vcHRpb25zKTtcbiAgICAgIC8vIHBpcGUgZXZlbnRzIGZyb20gYmFja2VuZENvbm5lY3RvclxuICAgICAgcy5jYWNoZUNvbm5lY3Rvci5vbignKicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBmb3IgKHZhciBfbGVuMiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuMiA+IDEgPyBfbGVuMiAtIDEgOiAwKSwgX2tleTIgPSAxOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgICAgYXJnc1tfa2V5MiAtIDFdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzMi5lbWl0LmFwcGx5KF90aGlzMiwgW2V2ZW50XS5jb25jYXQoYXJncykpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmICh0aGlzLm1vZHVsZXMubGFuZ3VhZ2VEZXRlY3Rvcikge1xuICAgICAgICBzLmxhbmd1YWdlRGV0ZWN0b3IgPSBjcmVhdGVDbGFzc09uRGVtYW5kKHRoaXMubW9kdWxlcy5sYW5ndWFnZURldGVjdG9yKTtcbiAgICAgICAgcy5sYW5ndWFnZURldGVjdG9yLmluaXQocywgdGhpcy5vcHRpb25zLmRldGVjdGlvbiwgdGhpcy5vcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy50cmFuc2xhdG9yID0gbmV3IFRyYW5zbGF0b3IodGhpcy5zZXJ2aWNlcywgdGhpcy5vcHRpb25zKTtcbiAgICAgIC8vIHBpcGUgZXZlbnRzIGZyb20gdHJhbnNsYXRvclxuICAgICAgdGhpcy50cmFuc2xhdG9yLm9uKCcqJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IEFycmF5KF9sZW4zID4gMSA/IF9sZW4zIC0gMSA6IDApLCBfa2V5MyA9IDE7IF9rZXkzIDwgX2xlbjM7IF9rZXkzKyspIHtcbiAgICAgICAgICBhcmdzW19rZXkzIC0gMV0gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMyLmVtaXQuYXBwbHkoX3RoaXMyLCBbZXZlbnRdLmNvbmNhdChhcmdzKSk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5tb2R1bGVzLmV4dGVybmFsLmZvckVhY2goZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgaWYgKG0uaW5pdCkgbS5pbml0KF90aGlzMik7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBhcHBlbmQgYXBpXG4gICAgdmFyIHN0b3JlQXBpID0gWydnZXRSZXNvdXJjZScsICdhZGRSZXNvdXJjZScsICdhZGRSZXNvdXJjZXMnLCAnYWRkUmVzb3VyY2VCdW5kbGUnLCAncmVtb3ZlUmVzb3VyY2VCdW5kbGUnLCAnaGFzUmVzb3VyY2VCdW5kbGUnLCAnZ2V0UmVzb3VyY2VCdW5kbGUnXTtcbiAgICBzdG9yZUFwaS5mb3JFYWNoKGZ1bmN0aW9uIChmY05hbWUpIHtcbiAgICAgIF90aGlzMltmY05hbWVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3N0b3JlO1xuXG4gICAgICAgIHJldHVybiAoX3N0b3JlID0gX3RoaXMyLnN0b3JlKVtmY05hbWVdLmFwcGx5KF9zdG9yZSwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICB2YXIgbG9hZCA9IGZ1bmN0aW9uIGxvYWQoKSB7XG4gICAgICBfdGhpczIuY2hhbmdlTGFuZ3VhZ2UoX3RoaXMyLm9wdGlvbnMubG5nLCBmdW5jdGlvbiAoZXJyLCB0KSB7XG4gICAgICAgIF90aGlzMi5pc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMyLmxvZ2dlci5sb2coJ2luaXRpYWxpemVkJywgX3RoaXMyLm9wdGlvbnMpO1xuICAgICAgICBfdGhpczIuZW1pdCgnaW5pdGlhbGl6ZWQnLCBfdGhpczIub3B0aW9ucyk7XG5cbiAgICAgICAgY2FsbGJhY2soZXJyLCB0KTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBpZiAodGhpcy5vcHRpb25zLnJlc291cmNlcyB8fCAhdGhpcy5vcHRpb25zLmluaXRJbW1lZGlhdGUpIHtcbiAgICAgIGxvYWQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0VGltZW91dChsb2FkLCAwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKiBlc2xpbnQgY29uc2lzdGVudC1yZXR1cm46IDAgKi9cblxuXG4gIEkxOG4ucHJvdG90eXBlLmxvYWRSZXNvdXJjZXMgPSBmdW5jdGlvbiBsb2FkUmVzb3VyY2VzKCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBub29wO1xuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMucmVzb3VyY2VzKSB7XG4gICAgICBpZiAodGhpcy5sYW5ndWFnZSAmJiB0aGlzLmxhbmd1YWdlLnRvTG93ZXJDYXNlKCkgPT09ICdjaW1vZGUnKSByZXR1cm4gY2FsbGJhY2soKTsgLy8gYXZvaWQgbG9hZGluZyByZXNvdXJjZXMgZm9yIGNpbW9kZVxuXG4gICAgICB2YXIgdG9Mb2FkID0gW107XG5cbiAgICAgIHZhciBhcHBlbmQgPSBmdW5jdGlvbiBhcHBlbmQobG5nKSB7XG4gICAgICAgIGlmICghbG5nKSByZXR1cm47XG4gICAgICAgIHZhciBsbmdzID0gX3RoaXMzLnNlcnZpY2VzLmxhbmd1YWdlVXRpbHMudG9SZXNvbHZlSGllcmFyY2h5KGxuZyk7XG4gICAgICAgIGxuZ3MuZm9yRWFjaChmdW5jdGlvbiAobCkge1xuICAgICAgICAgIGlmICh0b0xvYWQuaW5kZXhPZihsKSA8IDApIHRvTG9hZC5wdXNoKGwpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG5cbiAgICAgIGlmICghdGhpcy5sYW5ndWFnZSkge1xuICAgICAgICAvLyBhdCBsZWFzdCBsb2FkIGZhbGxiYWNrcyBpbiB0aGlzIGNhc2VcbiAgICAgICAgdmFyIGZhbGxiYWNrcyA9IHRoaXMuc2VydmljZXMubGFuZ3VhZ2VVdGlscy5nZXRGYWxsYmFja0NvZGVzKHRoaXMub3B0aW9ucy5mYWxsYmFja0xuZyk7XG4gICAgICAgIGZhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgcmV0dXJuIGFwcGVuZChsKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcHBlbmQodGhpcy5sYW5ndWFnZSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMucHJlbG9hZCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMucHJlbG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgcmV0dXJuIGFwcGVuZChsKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2VydmljZXMuY2FjaGVDb25uZWN0b3IubG9hZCh0b0xvYWQsIHRoaXMub3B0aW9ucy5ucywgZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpczMuc2VydmljZXMuYmFja2VuZENvbm5lY3Rvci5sb2FkKHRvTG9hZCwgX3RoaXMzLm9wdGlvbnMubnMsIGNhbGxiYWNrKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjayhudWxsKTtcbiAgICB9XG4gIH07XG5cbiAgSTE4bi5wcm90b3R5cGUucmVsb2FkUmVzb3VyY2VzID0gZnVuY3Rpb24gcmVsb2FkUmVzb3VyY2VzKGxuZ3MsIG5zKSB7XG4gICAgaWYgKCFsbmdzKSBsbmdzID0gdGhpcy5sYW5ndWFnZXM7XG4gICAgaWYgKCFucykgbnMgPSB0aGlzLm9wdGlvbnMubnM7XG4gICAgdGhpcy5zZXJ2aWNlcy5iYWNrZW5kQ29ubmVjdG9yLnJlbG9hZChsbmdzLCBucyk7XG4gIH07XG5cbiAgSTE4bi5wcm90b3R5cGUudXNlID0gZnVuY3Rpb24gdXNlKG1vZHVsZSkge1xuICAgIGlmIChtb2R1bGUudHlwZSA9PT0gJ2JhY2tlbmQnKSB7XG4gICAgICB0aGlzLm1vZHVsZXMuYmFja2VuZCA9IG1vZHVsZTtcbiAgICB9XG5cbiAgICBpZiAobW9kdWxlLnR5cGUgPT09ICdjYWNoZScpIHtcbiAgICAgIHRoaXMubW9kdWxlcy5jYWNoZSA9IG1vZHVsZTtcbiAgICB9XG5cbiAgICBpZiAobW9kdWxlLnR5cGUgPT09ICdsb2dnZXInIHx8IG1vZHVsZS5sb2cgJiYgbW9kdWxlLndhcm4gJiYgbW9kdWxlLmVycm9yKSB7XG4gICAgICB0aGlzLm1vZHVsZXMubG9nZ2VyID0gbW9kdWxlO1xuICAgIH1cblxuICAgIGlmIChtb2R1bGUudHlwZSA9PT0gJ2xhbmd1YWdlRGV0ZWN0b3InKSB7XG4gICAgICB0aGlzLm1vZHVsZXMubGFuZ3VhZ2VEZXRlY3RvciA9IG1vZHVsZTtcbiAgICB9XG5cbiAgICBpZiAobW9kdWxlLnR5cGUgPT09ICdwb3N0UHJvY2Vzc29yJykge1xuICAgICAgcG9zdFByb2Nlc3Nvci5hZGRQb3N0UHJvY2Vzc29yKG1vZHVsZSk7XG4gICAgfVxuXG4gICAgaWYgKG1vZHVsZS50eXBlID09PSAnM3JkUGFydHknKSB7XG4gICAgICB0aGlzLm1vZHVsZXMuZXh0ZXJuYWwucHVzaChtb2R1bGUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEkxOG4ucHJvdG90eXBlLmNoYW5nZUxhbmd1YWdlID0gZnVuY3Rpb24gY2hhbmdlTGFuZ3VhZ2UobG5nLCBjYWxsYmFjaykge1xuICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgdmFyIGRvbmUgPSBmdW5jdGlvbiBkb25lKGVyciwgbCkge1xuICAgICAgX3RoaXM0LnRyYW5zbGF0b3IuY2hhbmdlTGFuZ3VhZ2UobCk7XG5cbiAgICAgIGlmIChsKSB7XG4gICAgICAgIF90aGlzNC5lbWl0KCdsYW5ndWFnZUNoYW5nZWQnLCBsKTtcbiAgICAgICAgX3RoaXM0LmxvZ2dlci5sb2coJ2xhbmd1YWdlQ2hhbmdlZCcsIGwpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVyciwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3RoaXM0LnQuYXBwbHkoX3RoaXM0LCBhcmd1bWVudHMpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciBzZXRMbmcgPSBmdW5jdGlvbiBzZXRMbmcobCkge1xuICAgICAgaWYgKGwpIHtcbiAgICAgICAgX3RoaXM0Lmxhbmd1YWdlID0gbDtcbiAgICAgICAgX3RoaXM0Lmxhbmd1YWdlcyA9IF90aGlzNC5zZXJ2aWNlcy5sYW5ndWFnZVV0aWxzLnRvUmVzb2x2ZUhpZXJhcmNoeShsKTtcblxuICAgICAgICBpZiAoX3RoaXM0LnNlcnZpY2VzLmxhbmd1YWdlRGV0ZWN0b3IpIF90aGlzNC5zZXJ2aWNlcy5sYW5ndWFnZURldGVjdG9yLmNhY2hlVXNlckxhbmd1YWdlKGwpO1xuICAgICAgfVxuXG4gICAgICBfdGhpczQubG9hZFJlc291cmNlcyhmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGRvbmUoZXJyLCBsKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICBpZiAoIWxuZyAmJiB0aGlzLnNlcnZpY2VzLmxhbmd1YWdlRGV0ZWN0b3IgJiYgIXRoaXMuc2VydmljZXMubGFuZ3VhZ2VEZXRlY3Rvci5hc3luYykge1xuICAgICAgc2V0TG5nKHRoaXMuc2VydmljZXMubGFuZ3VhZ2VEZXRlY3Rvci5kZXRlY3QoKSk7XG4gICAgfSBlbHNlIGlmICghbG5nICYmIHRoaXMuc2VydmljZXMubGFuZ3VhZ2VEZXRlY3RvciAmJiB0aGlzLnNlcnZpY2VzLmxhbmd1YWdlRGV0ZWN0b3IuYXN5bmMpIHtcbiAgICAgIHRoaXMuc2VydmljZXMubGFuZ3VhZ2VEZXRlY3Rvci5kZXRlY3Qoc2V0TG5nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2V0TG5nKGxuZyk7XG4gICAgfVxuICB9O1xuXG4gIEkxOG4ucHJvdG90eXBlLmdldEZpeGVkVCA9IGZ1bmN0aW9uIGdldEZpeGVkVChsbmcsIG5zKSB7XG4gICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICB2YXIgZml4ZWRUID0gZnVuY3Rpb24gZml4ZWRUKGtleSkge1xuICAgICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBvcHRzID09PSAnc3RyaW5nJyA/IHsgZGVmYXVsdFZhbHVlOiBvcHRzIH0gOiBfZXh0ZW5kcyh7fSwgb3B0cyk7XG4gICAgICBvcHRpb25zLmxuZyA9IG9wdGlvbnMubG5nIHx8IGZpeGVkVC5sbmc7XG4gICAgICBvcHRpb25zLmxuZ3MgPSBvcHRpb25zLmxuZ3MgfHwgZml4ZWRULmxuZ3M7XG4gICAgICBvcHRpb25zLm5zID0gb3B0aW9ucy5ucyB8fCBmaXhlZFQubnM7XG4gICAgICByZXR1cm4gX3RoaXM1LnQoa2V5LCBvcHRpb25zKTtcbiAgICB9O1xuICAgIGlmICh0eXBlb2YgbG5nID09PSAnc3RyaW5nJykge1xuICAgICAgZml4ZWRULmxuZyA9IGxuZztcbiAgICB9IGVsc2Uge1xuICAgICAgZml4ZWRULmxuZ3MgPSBsbmc7XG4gICAgfVxuICAgIGZpeGVkVC5ucyA9IG5zO1xuICAgIHJldHVybiBmaXhlZFQ7XG4gIH07XG5cbiAgSTE4bi5wcm90b3R5cGUudCA9IGZ1bmN0aW9uIHQoKSB7XG4gICAgdmFyIF90cmFuc2xhdG9yO1xuXG4gICAgcmV0dXJuIHRoaXMudHJhbnNsYXRvciAmJiAoX3RyYW5zbGF0b3IgPSB0aGlzLnRyYW5zbGF0b3IpLnRyYW5zbGF0ZS5hcHBseShfdHJhbnNsYXRvciwgYXJndW1lbnRzKTtcbiAgfTtcblxuICBJMThuLnByb3RvdHlwZS5leGlzdHMgPSBmdW5jdGlvbiBleGlzdHMoKSB7XG4gICAgdmFyIF90cmFuc2xhdG9yMjtcblxuICAgIHJldHVybiB0aGlzLnRyYW5zbGF0b3IgJiYgKF90cmFuc2xhdG9yMiA9IHRoaXMudHJhbnNsYXRvcikuZXhpc3RzLmFwcGx5KF90cmFuc2xhdG9yMiwgYXJndW1lbnRzKTtcbiAgfTtcblxuICBJMThuLnByb3RvdHlwZS5zZXREZWZhdWx0TmFtZXNwYWNlID0gZnVuY3Rpb24gc2V0RGVmYXVsdE5hbWVzcGFjZShucykge1xuICAgIHRoaXMub3B0aW9ucy5kZWZhdWx0TlMgPSBucztcbiAgfTtcblxuICBJMThuLnByb3RvdHlwZS5sb2FkTmFtZXNwYWNlcyA9IGZ1bmN0aW9uIGxvYWROYW1lc3BhY2VzKG5zLCBjYWxsYmFjaykge1xuICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMubnMpIHJldHVybiBjYWxsYmFjayAmJiBjYWxsYmFjaygpO1xuICAgIGlmICh0eXBlb2YgbnMgPT09ICdzdHJpbmcnKSBucyA9IFtuc107XG5cbiAgICBucy5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7XG4gICAgICBpZiAoX3RoaXM2Lm9wdGlvbnMubnMuaW5kZXhPZihuKSA8IDApIF90aGlzNi5vcHRpb25zLm5zLnB1c2gobik7XG4gICAgfSk7XG5cbiAgICB0aGlzLmxvYWRSZXNvdXJjZXMoY2FsbGJhY2spO1xuICB9O1xuXG4gIEkxOG4ucHJvdG90eXBlLmxvYWRMYW5ndWFnZXMgPSBmdW5jdGlvbiBsb2FkTGFuZ3VhZ2VzKGxuZ3MsIGNhbGxiYWNrKSB7XG4gICAgaWYgKHR5cGVvZiBsbmdzID09PSAnc3RyaW5nJykgbG5ncyA9IFtsbmdzXTtcbiAgICB2YXIgcHJlbG9hZGVkID0gdGhpcy5vcHRpb25zLnByZWxvYWQgfHwgW107XG5cbiAgICB2YXIgbmV3TG5ncyA9IGxuZ3MuZmlsdGVyKGZ1bmN0aW9uIChsbmcpIHtcbiAgICAgIHJldHVybiBwcmVsb2FkZWQuaW5kZXhPZihsbmcpIDwgMDtcbiAgICB9KTtcbiAgICAvLyBFeGl0IGVhcmx5IGlmIGFsbCBnaXZlbiBsYW5ndWFnZXMgYXJlIGFscmVhZHkgcHJlbG9hZGVkXG4gICAgaWYgKCFuZXdMbmdzLmxlbmd0aCkgcmV0dXJuIGNhbGxiYWNrKCk7XG5cbiAgICB0aGlzLm9wdGlvbnMucHJlbG9hZCA9IHByZWxvYWRlZC5jb25jYXQobmV3TG5ncyk7XG4gICAgdGhpcy5sb2FkUmVzb3VyY2VzKGNhbGxiYWNrKTtcbiAgfTtcblxuICBJMThuLnByb3RvdHlwZS5kaXIgPSBmdW5jdGlvbiBkaXIobG5nKSB7XG4gICAgaWYgKCFsbmcpIGxuZyA9IHRoaXMubGFuZ3VhZ2VzICYmIHRoaXMubGFuZ3VhZ2VzLmxlbmd0aCA+IDAgPyB0aGlzLmxhbmd1YWdlc1swXSA6IHRoaXMubGFuZ3VhZ2U7XG4gICAgaWYgKCFsbmcpIHJldHVybiAncnRsJztcblxuICAgIHZhciBydGxMbmdzID0gWydhcicsICdzaHUnLCAnc3FyJywgJ3NzaCcsICd4YWEnLCAneWhkJywgJ3l1ZCcsICdhYW8nLCAnYWJoJywgJ2FidicsICdhY20nLCAnYWNxJywgJ2FjdycsICdhY3gnLCAnYWN5JywgJ2FkZicsICdhZHMnLCAnYWViJywgJ2FlYycsICdhZmInLCAnYWpwJywgJ2FwYycsICdhcGQnLCAnYXJiJywgJ2FycScsICdhcnMnLCAnYXJ5JywgJ2FyeicsICdhdXonLCAnYXZsJywgJ2F5aCcsICdheWwnLCAnYXluJywgJ2F5cCcsICdiYnonLCAncGdhJywgJ2hlJywgJ2l3JywgJ3BzJywgJ3BidCcsICdwYnUnLCAncHN0JywgJ3BycCcsICdwcmQnLCAndXInLCAneWRkJywgJ3lkcycsICd5aWgnLCAnamknLCAneWknLCAnaGJvJywgJ21lbicsICd4bW4nLCAnZmEnLCAnanByJywgJ3BlbycsICdwZXMnLCAncHJzJywgJ2R2JywgJ3NhbSddO1xuXG4gICAgcmV0dXJuIHJ0bExuZ3MuaW5kZXhPZih0aGlzLnNlcnZpY2VzLmxhbmd1YWdlVXRpbHMuZ2V0TGFuZ3VhZ2VQYXJ0RnJvbUNvZGUobG5nKSkgPj0gMCA/ICdydGwnIDogJ2x0cic7XG4gIH07XG5cbiAgLyogZXNsaW50IGNsYXNzLW1ldGhvZHMtdXNlLXRoaXM6IDAgKi9cblxuXG4gIEkxOG4ucHJvdG90eXBlLmNyZWF0ZUluc3RhbmNlID0gZnVuY3Rpb24gY3JlYXRlSW5zdGFuY2UoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1sxXTtcblxuICAgIHJldHVybiBuZXcgSTE4bihvcHRpb25zLCBjYWxsYmFjayk7XG4gIH07XG5cbiAgSTE4bi5wcm90b3R5cGUuY2xvbmVJbnN0YW5jZSA9IGZ1bmN0aW9uIGNsb25lSW5zdGFuY2UoKSB7XG4gICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBub29wO1xuXG4gICAgdmFyIG1lcmdlZE9wdGlvbnMgPSBfZXh0ZW5kcyh7fSwgdGhpcy5vcHRpb25zLCBvcHRpb25zLCB7IGlzQ2xvbmU6IHRydWUgfSk7XG4gICAgdmFyIGNsb25lID0gbmV3IEkxOG4obWVyZ2VkT3B0aW9ucywgY2FsbGJhY2spO1xuICAgIHZhciBtZW1iZXJzVG9Db3B5ID0gWydzdG9yZScsICdzZXJ2aWNlcycsICdsYW5ndWFnZSddO1xuICAgIG1lbWJlcnNUb0NvcHkuZm9yRWFjaChmdW5jdGlvbiAobSkge1xuICAgICAgY2xvbmVbbV0gPSBfdGhpczdbbV07XG4gICAgfSk7XG4gICAgY2xvbmUudHJhbnNsYXRvciA9IG5ldyBUcmFuc2xhdG9yKGNsb25lLnNlcnZpY2VzLCBjbG9uZS5vcHRpb25zKTtcbiAgICBjbG9uZS50cmFuc2xhdG9yLm9uKCcqJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBmb3IgKHZhciBfbGVuNCA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuNCA+IDEgPyBfbGVuNCAtIDEgOiAwKSwgX2tleTQgPSAxOyBfa2V5NCA8IF9sZW40OyBfa2V5NCsrKSB7XG4gICAgICAgIGFyZ3NbX2tleTQgLSAxXSA9IGFyZ3VtZW50c1tfa2V5NF07XG4gICAgICB9XG5cbiAgICAgIGNsb25lLmVtaXQuYXBwbHkoY2xvbmUsIFtldmVudF0uY29uY2F0KGFyZ3MpKTtcbiAgICB9KTtcbiAgICBjbG9uZS5pbml0KG1lcmdlZE9wdGlvbnMsIGNhbGxiYWNrKTtcblxuICAgIHJldHVybiBjbG9uZTtcbiAgfTtcblxuICByZXR1cm4gSTE4bjtcbn0oRXZlbnRFbWl0dGVyKTtcblxudmFyIGkxOG5leHQgPSBuZXcgSTE4bigpO1xuXG5yZXR1cm4gaTE4bmV4dDtcblxufSkpKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZXh0ZXJuYWwvaTE4bmV4dC9zY3JpcHRzL2kxOG5leHQuanNcbi8vIG1vZHVsZSBpZCA9IDVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuICAoZ2xvYmFsLmkxOG5leHRYSFJCYWNrZW5kID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXJyID0gW107XG52YXIgZWFjaCA9IGFyci5mb3JFYWNoO1xudmFyIHNsaWNlID0gYXJyLnNsaWNlO1xuXG5mdW5jdGlvbiBkZWZhdWx0cyhvYmopIHtcbiAgZWFjaC5jYWxsKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UpIHtcbiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChvYmpbcHJvcF0gPT09IHVuZGVmaW5lZCkgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHJldHVybiBvYmo7XG59XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxuZnVuY3Rpb24gYWRkUXVlcnlTdHJpbmcodXJsLCBwYXJhbXMpIHtcbiAgaWYgKHBhcmFtcyAmJiAodHlwZW9mIHBhcmFtcyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YocGFyYW1zKSkgPT09ICdvYmplY3QnKSB7XG4gICAgdmFyIHF1ZXJ5U3RyaW5nID0gJycsXG4gICAgICAgIGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XG5cbiAgICAvLyBNdXN0IGVuY29kZSBkYXRhXG4gICAgZm9yICh2YXIgcGFyYW1OYW1lIGluIHBhcmFtcykge1xuICAgICAgcXVlcnlTdHJpbmcgKz0gJyYnICsgZShwYXJhbU5hbWUpICsgJz0nICsgZShwYXJhbXNbcGFyYW1OYW1lXSk7XG4gICAgfVxuXG4gICAgaWYgKCFxdWVyeVN0cmluZykge1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG5cbiAgICB1cmwgPSB1cmwgKyAodXJsLmluZGV4T2YoJz8nKSAhPT0gLTEgPyAnJicgOiAnPycpICsgcXVlcnlTdHJpbmcuc2xpY2UoMSk7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufVxuXG4vLyBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9YZW9uY3Jvc3MvNzY2MzI3M1xuZnVuY3Rpb24gYWpheCh1cmwsIG9wdGlvbnMsIGNhbGxiYWNrLCBkYXRhLCBjYWNoZSkge1xuXG4gIGlmIChkYXRhICYmICh0eXBlb2YgZGF0YSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZGF0YSkpID09PSAnb2JqZWN0Jykge1xuICAgIGlmICghY2FjaGUpIHtcbiAgICAgIGRhdGFbJ190J10gPSBuZXcgRGF0ZSgpO1xuICAgIH1cbiAgICAvLyBVUkwgZW5jb2RlZCBmb3JtIGRhdGEgbXVzdCBiZSBpbiBxdWVyeXN0cmluZyBmb3JtYXRcbiAgICBkYXRhID0gYWRkUXVlcnlTdHJpbmcoJycsIGRhdGEpLnNsaWNlKDEpO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMucXVlcnlTdHJpbmdQYXJhbXMpIHtcbiAgICB1cmwgPSBhZGRRdWVyeVN0cmluZyh1cmwsIG9wdGlvbnMucXVlcnlTdHJpbmdQYXJhbXMpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICB2YXIgeDtcbiAgICBpZiAoWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgIHggPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgeCA9IG5ldyBBY3RpdmVYT2JqZWN0KCdNU1hNTDIuWE1MSFRUUC4zLjAnKTtcbiAgICB9XG4gICAgeC5vcGVuKGRhdGEgPyAnUE9TVCcgOiAnR0VUJywgdXJsLCAxKTtcbiAgICBpZiAoIW9wdGlvbnMuY3Jvc3NEb21haW4pIHtcbiAgICAgIHguc2V0UmVxdWVzdEhlYWRlcignWC1SZXF1ZXN0ZWQtV2l0aCcsICdYTUxIdHRwUmVxdWVzdCcpO1xuICAgIH1cbiAgICB4LndpdGhDcmVkZW50aWFscyA9ICEhb3B0aW9ucy53aXRoQ3JlZGVudGlhbHM7XG4gICAgaWYgKGRhdGEpIHtcbiAgICAgIHguc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpO1xuICAgIH1cbiAgICBpZiAoeC5vdmVycmlkZU1pbWVUeXBlKSB7XG4gICAgICB4Lm92ZXJyaWRlTWltZVR5cGUoXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgIH1cbiAgICB2YXIgaCA9IG9wdGlvbnMuY3VzdG9tSGVhZGVycztcbiAgICBpZiAoaCkge1xuICAgICAgZm9yICh2YXIgaSBpbiBoKSB7XG4gICAgICAgIHguc2V0UmVxdWVzdEhlYWRlcihpLCBoW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gICAgeC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB4LnJlYWR5U3RhdGUgPiAzICYmIGNhbGxiYWNrICYmIGNhbGxiYWNrKHgucmVzcG9uc2VUZXh0LCB4KTtcbiAgICB9O1xuICAgIHguc2VuZChkYXRhKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUgJiYgY29uc29sZS5sb2coZSk7XG4gIH1cbn1cblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdHMoKSB7XG4gIHJldHVybiB7XG4gICAgbG9hZFBhdGg6ICcvbG9jYWxlcy97e2xuZ319L3t7bnN9fS5qc29uJyxcbiAgICBhZGRQYXRoOiAnbG9jYWxlcy9hZGQve3tsbmd9fS97e25zfX0nLFxuICAgIGFsbG93TXVsdGlMb2FkaW5nOiBmYWxzZSxcbiAgICBwYXJzZTogSlNPTi5wYXJzZSxcbiAgICBjcm9zc0RvbWFpbjogZmFsc2UsXG4gICAgYWpheDogYWpheFxuICB9O1xufVxuXG52YXIgQmFja2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQmFja2VuZChzZXJ2aWNlcykge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYWNrZW5kKTtcblxuICAgIHRoaXMuaW5pdChzZXJ2aWNlcywgb3B0aW9ucyk7XG5cbiAgICB0aGlzLnR5cGUgPSAnYmFja2VuZCc7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQmFja2VuZCwgW3tcbiAgICBrZXk6ICdpbml0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdChzZXJ2aWNlcykge1xuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgICB0aGlzLnNlcnZpY2VzID0gc2VydmljZXM7XG4gICAgICB0aGlzLm9wdGlvbnMgPSBkZWZhdWx0cyhvcHRpb25zLCB0aGlzLm9wdGlvbnMgfHwge30sIGdldERlZmF1bHRzKCkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3JlYWRNdWx0aScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWRNdWx0aShsYW5ndWFnZXMsIG5hbWVzcGFjZXMsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgbG9hZFBhdGggPSB0aGlzLm9wdGlvbnMubG9hZFBhdGg7XG4gICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5sb2FkUGF0aCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBsb2FkUGF0aCA9IHRoaXMub3B0aW9ucy5sb2FkUGF0aChsYW5ndWFnZXMsIG5hbWVzcGFjZXMpO1xuICAgICAgfVxuXG4gICAgICB2YXIgdXJsID0gdGhpcy5zZXJ2aWNlcy5pbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUobG9hZFBhdGgsIHsgbG5nOiBsYW5ndWFnZXMuam9pbignKycpLCBuczogbmFtZXNwYWNlcy5qb2luKCcrJykgfSk7XG5cbiAgICAgIHRoaXMubG9hZFVybCh1cmwsIGNhbGxiYWNrKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdyZWFkJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZChsYW5ndWFnZSwgbmFtZXNwYWNlLCBjYWxsYmFjaykge1xuICAgICAgdmFyIGxvYWRQYXRoID0gdGhpcy5vcHRpb25zLmxvYWRQYXRoO1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMubG9hZFBhdGggPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgbG9hZFBhdGggPSB0aGlzLm9wdGlvbnMubG9hZFBhdGgoW2xhbmd1YWdlXSwgW25hbWVzcGFjZV0pO1xuICAgICAgfVxuXG4gICAgICB2YXIgdXJsID0gdGhpcy5zZXJ2aWNlcy5pbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUobG9hZFBhdGgsIHsgbG5nOiBsYW5ndWFnZSwgbnM6IG5hbWVzcGFjZSB9KTtcblxuICAgICAgdGhpcy5sb2FkVXJsKHVybCwgY2FsbGJhY2spO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2xvYWRVcmwnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkVXJsKHVybCwgY2FsbGJhY2spIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHRoaXMub3B0aW9ucy5hamF4KHVybCwgdGhpcy5vcHRpb25zLCBmdW5jdGlvbiAoZGF0YSwgeGhyKSB7XG4gICAgICAgIGlmICh4aHIuc3RhdHVzID49IDUwMCAmJiB4aHIuc3RhdHVzIDwgNjAwKSByZXR1cm4gY2FsbGJhY2soJ2ZhaWxlZCBsb2FkaW5nICcgKyB1cmwsIHRydWUgLyogcmV0cnkgKi8pO1xuICAgICAgICBpZiAoeGhyLnN0YXR1cyA+PSA0MDAgJiYgeGhyLnN0YXR1cyA8IDUwMCkgcmV0dXJuIGNhbGxiYWNrKCdmYWlsZWQgbG9hZGluZyAnICsgdXJsLCBmYWxzZSAvKiBubyByZXRyeSAqLyk7XG5cbiAgICAgICAgdmFyIHJldCA9IHZvaWQgMCxcbiAgICAgICAgICAgIGVyciA9IHZvaWQgMDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXQgPSBfdGhpcy5vcHRpb25zLnBhcnNlKGRhdGEsIHVybCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBlcnIgPSAnZmFpbGVkIHBhcnNpbmcgJyArIHVybCArICcgdG8ganNvbic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVycikgcmV0dXJuIGNhbGxiYWNrKGVyciwgZmFsc2UpO1xuICAgICAgICBjYWxsYmFjayhudWxsLCByZXQpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnY3JlYXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKGxhbmd1YWdlcywgbmFtZXNwYWNlLCBrZXksIGZhbGxiYWNrVmFsdWUpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICBpZiAodHlwZW9mIGxhbmd1YWdlcyA9PT0gJ3N0cmluZycpIGxhbmd1YWdlcyA9IFtsYW5ndWFnZXNdO1xuXG4gICAgICB2YXIgcGF5bG9hZCA9IHt9O1xuICAgICAgcGF5bG9hZFtrZXldID0gZmFsbGJhY2tWYWx1ZSB8fCAnJztcblxuICAgICAgbGFuZ3VhZ2VzLmZvckVhY2goZnVuY3Rpb24gKGxuZykge1xuICAgICAgICB2YXIgdXJsID0gX3RoaXMyLnNlcnZpY2VzLmludGVycG9sYXRvci5pbnRlcnBvbGF0ZShfdGhpczIub3B0aW9ucy5hZGRQYXRoLCB7IGxuZzogbG5nLCBuczogbmFtZXNwYWNlIH0pO1xuXG4gICAgICAgIF90aGlzMi5vcHRpb25zLmFqYXgodXJsLCBfdGhpczIub3B0aW9ucywgZnVuY3Rpb24gKGRhdGEsIHhocikge1xuICAgICAgICAgIC8vY29uc3Qgc3RhdHVzQ29kZSA9IHhoci5zdGF0dXMudG9TdHJpbmcoKTtcbiAgICAgICAgICAvLyBUT0RPOiBpZiBzdGF0dXNDb2RlID09PSA0eHggZG8gbG9nXG4gICAgICAgIH0sIHBheWxvYWQpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEJhY2tlbmQ7XG59KCk7XG5cbkJhY2tlbmQudHlwZSA9ICdiYWNrZW5kJztcblxucmV0dXJuIEJhY2tlbmQ7XG5cbn0pKSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2V4dGVybmFsL2kxOG5leHQvc2NyaXB0cy9pMThuZXh0WEhSQmFja2VuZC5qc1xuLy8gbW9kdWxlIGlkID0gNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuaTE4bmV4dExvY2FsU3RvcmFnZUNhY2hlID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXJyID0gW107XG52YXIgZWFjaCA9IGFyci5mb3JFYWNoO1xudmFyIHNsaWNlID0gYXJyLnNsaWNlO1xuXG5mdW5jdGlvbiBkZWZhdWx0cyhvYmopIHtcbiAgZWFjaC5jYWxsKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UpIHtcbiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChvYmpbcHJvcF0gPT09IHVuZGVmaW5lZCkgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIHJldHVybiBvYmo7XG59XG5cblxuXG5mdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcbiAgdmFyIHRpbWVvdXQ7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLFxuICAgICAgICBhcmdzID0gYXJndW1lbnRzO1xuICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uIGxhdGVyKCkge1xuICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICBpZiAoIWltbWVkaWF0ZSkgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICB9O1xuICAgIHZhciBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG4gICAgaWYgKGNhbGxOb3cpIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gIH07XG59XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBzdG9yYWdlID0ge1xuICBzZXRJdGVtOiBmdW5jdGlvbiBzZXRJdGVtKGtleSwgdmFsdWUpIHtcbiAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBmLmxvZygnZmFpbGVkIHRvIHNldCB2YWx1ZSBmb3Iga2V5IFwiJyArIGtleSArICdcIiB0byBsb2NhbFN0b3JhZ2UuJyk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBnZXRJdGVtOiBmdW5jdGlvbiBnZXRJdGVtKGtleSwgdmFsdWUpIHtcbiAgICBpZiAod2luZG93LmxvY2FsU3RvcmFnZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXksIHZhbHVlKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gZi5sb2coJ2ZhaWxlZCB0byBnZXQgdmFsdWUgZm9yIGtleSBcIicgKyBrZXkgKyAnXCIgZnJvbSBsb2NhbFN0b3JhZ2UuJyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGdldERlZmF1bHRzKCkge1xuICByZXR1cm4ge1xuICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIHByZWZpeDogJ2kxOG5leHRfcmVzXycsXG4gICAgZXhwaXJhdGlvblRpbWU6IDcgKiAyNCAqIDYwICogNjAgKiAxMDAwLFxuICAgIHZlcnNpb25zOiB7fVxuICB9O1xufVxuXG52YXIgQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENhY2hlKHNlcnZpY2VzKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENhY2hlKTtcblxuICAgIHRoaXMuaW5pdChzZXJ2aWNlcywgb3B0aW9ucyk7XG5cbiAgICB0aGlzLnR5cGUgPSAnY2FjaGUnO1xuICAgIHRoaXMuZGVib3VuY2VkU3RvcmUgPSBkZWJvdW5jZSh0aGlzLnN0b3JlLCAxMDAwMCk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQ2FjaGUsIFt7XG4gICAga2V5OiAnaW5pdCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoc2VydmljZXMpIHtcbiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgICAgdGhpcy5zZXJ2aWNlcyA9IHNlcnZpY2VzO1xuICAgICAgdGhpcy5vcHRpb25zID0gZGVmYXVsdHMob3B0aW9ucywgdGhpcy5vcHRpb25zIHx8IHt9LCBnZXREZWZhdWx0cygpKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdsb2FkJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZChsbmdzLCBjYWxsYmFjaykge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdmFyIHN0b3JlID0ge307XG4gICAgICB2YXIgbm93TVMgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgaWYgKCF3aW5kb3cubG9jYWxTdG9yYWdlIHx8ICFsbmdzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2sobnVsbCwgbnVsbCk7XG4gICAgICB9XG5cbiAgICAgIHZhciB0b2RvID0gbG5ncy5sZW5ndGg7XG5cbiAgICAgIGxuZ3MuZm9yRWFjaChmdW5jdGlvbiAobG5nKSB7XG4gICAgICAgIHZhciBsb2NhbCA9IHN0b3JhZ2UuZ2V0SXRlbShfdGhpcy5vcHRpb25zLnByZWZpeCArIGxuZyk7XG5cbiAgICAgICAgaWYgKGxvY2FsKSB7XG4gICAgICAgICAgbG9jYWwgPSBKU09OLnBhcnNlKGxvY2FsKTtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgLy8gZXhwaXJhdGlvbiBmaWVsZCBpcyBtYW5kYXRvcnksIGFuZCBzaG91bGQgbm90IGJlIGV4cGlyZWRcbiAgICAgICAgICBsb2NhbC5pMThuU3RhbXAgJiYgbG9jYWwuaTE4blN0YW1wICsgX3RoaXMub3B0aW9ucy5leHBpcmF0aW9uVGltZSA+IG5vd01TICYmXG5cbiAgICAgICAgICAvLyB0aGVyZSBzaG91bGQgYmUgbm8gbGFuZ3VhZ2UgdmVyc2lvbiBzZXQsIG9yIGlmIGl0IGlzLCBpdCBzaG91bGQgbWF0Y2ggdGhlIG9uZSBpbiB0cmFuc2xhdGlvblxuICAgICAgICAgIF90aGlzLm9wdGlvbnMudmVyc2lvbnNbbG5nXSA9PT0gbG9jYWwuaTE4blZlcnNpb24pIHtcbiAgICAgICAgICAgIGRlbGV0ZSBsb2NhbC5pMThuVmVyc2lvbjtcbiAgICAgICAgICAgIHN0b3JlW2xuZ10gPSBsb2NhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0b2RvIC09IDE7XG4gICAgICAgIGlmICh0b2RvID09PSAwKSB7XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCwgc3RvcmUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnc3RvcmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9yZShzdG9yZVBhcmFtKSB7XG4gICAgICB2YXIgc3RvcmUgPSBzdG9yZVBhcmFtO1xuICAgICAgaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgZm9yICh2YXIgbSBpbiBzdG9yZSkge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgICAvLyB0aW1lc3RhbXBcbiAgICAgICAgICBzdG9yZVttXS5pMThuU3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgICAgIC8vIGxhbmd1YWdlIHZlcnNpb24gKGlmIHNldClcbiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnZlcnNpb25zW21dKSB7XG4gICAgICAgICAgICBzdG9yZVttXS5pMThuVmVyc2lvbiA9IHRoaXMub3B0aW9ucy52ZXJzaW9uc1ttXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBzYXZlXG4gICAgICAgICAgc3RvcmFnZS5zZXRJdGVtKHRoaXMub3B0aW9ucy5wcmVmaXggKyBtLCBKU09OLnN0cmluZ2lmeShzdG9yZVttXSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnc2F2ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmUoc3RvcmUpIHtcbiAgICAgIHRoaXMuZGVib3VuY2VkU3RvcmUoc3RvcmUpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBDYWNoZTtcbn0oKTtcblxuQ2FjaGUudHlwZSA9ICdjYWNoZSc7XG5cbnJldHVybiBDYWNoZTtcblxufSkpKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZXh0ZXJuYWwvaTE4bmV4dC9zY3JpcHRzL2kxOG5leHRMb2NhbFN0b3JhZ2VDYWNoZS5qc1xuLy8gbW9kdWxlIGlkID0gN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICAgIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDpcbiAgICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoJ2kxOG5leHRTcHJpbnRmUG9zdFByb2Nlc3NvcicsIGZhY3RvcnkpIDpcbiAgICAoZ2xvYmFsLmkxOG5leHRTcHJpbnRmUG9zdFByb2Nlc3NvciA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGJhYmVsSGVscGVycyA9IHt9O1xuICAgIGJhYmVsSGVscGVycy50eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHJldHVybiB0eXBlb2Ygb2JqO1xuICAgIH0gOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xuICAgIH07XG4gICAgYmFiZWxIZWxwZXJzO1xuXG4gICAgdmFyIHJlID0ge1xuICAgICAgICBub3Rfc3RyaW5nOiAvW15zXS8sXG4gICAgICAgIG51bWJlcjogL1tkaWVmZ10vLFxuICAgICAgICBqc29uOiAvW2pdLyxcbiAgICAgICAgbm90X2pzb246IC9bXmpdLyxcbiAgICAgICAgdGV4dDogL15bXlxceDI1XSsvLFxuICAgICAgICBtb2R1bG86IC9eXFx4MjV7Mn0vLFxuICAgICAgICBwbGFjZWhvbGRlcjogL15cXHgyNSg/OihbMS05XVxcZCopXFwkfFxcKChbXlxcKV0rKVxcKSk/KFxcKyk/KDB8J1teJF0pPygtKT8oXFxkKyk/KD86XFwuKFxcZCspKT8oW2ItZ2lqb3N1eFhdKS8sXG4gICAgICAgIGtleTogL14oW2Etel9dW2Etel9cXGRdKikvaSxcbiAgICAgICAga2V5X2FjY2VzczogL15cXC4oW2Etel9dW2Etel9cXGRdKikvaSxcbiAgICAgICAgaW5kZXhfYWNjZXNzOiAvXlxcWyhcXGQrKVxcXS8sXG4gICAgICAgIHNpZ246IC9eW1xcK1xcLV0vXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHNwcmludGYoKSB7XG4gICAgICAgIHZhciBrZXkgPSBhcmd1bWVudHNbMF0sXG4gICAgICAgICAgICBjYWNoZSA9IHNwcmludGYuY2FjaGU7XG4gICAgICAgIGlmICghKGNhY2hlW2tleV0gJiYgY2FjaGUuaGFzT3duUHJvcGVydHkoa2V5KSkpIHtcbiAgICAgICAgICAgIGNhY2hlW2tleV0gPSBzcHJpbnRmLnBhcnNlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwcmludGYuZm9ybWF0LmNhbGwobnVsbCwgY2FjaGVba2V5XSwgYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICBzcHJpbnRmLmZvcm1hdCA9IGZ1bmN0aW9uIChwYXJzZV90cmVlLCBhcmd2KSB7XG4gICAgICAgIHZhciBjdXJzb3IgPSAxLFxuICAgICAgICAgICAgdHJlZV9sZW5ndGggPSBwYXJzZV90cmVlLmxlbmd0aCxcbiAgICAgICAgICAgIG5vZGVfdHlwZSA9IFwiXCIsXG4gICAgICAgICAgICBhcmcsXG4gICAgICAgICAgICBvdXRwdXQgPSBbXSxcbiAgICAgICAgICAgIGksXG4gICAgICAgICAgICBrLFxuICAgICAgICAgICAgbWF0Y2gsXG4gICAgICAgICAgICBwYWQsXG4gICAgICAgICAgICBwYWRfY2hhcmFjdGVyLFxuICAgICAgICAgICAgcGFkX2xlbmd0aCxcbiAgICAgICAgICAgIGlzX3Bvc2l0aXZlID0gdHJ1ZSxcbiAgICAgICAgICAgIHNpZ24gPSBcIlwiO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdHJlZV9sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbm9kZV90eXBlID0gZ2V0X3R5cGUocGFyc2VfdHJlZVtpXSk7XG4gICAgICAgICAgICBpZiAobm9kZV90eXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0W291dHB1dC5sZW5ndGhdID0gcGFyc2VfdHJlZVtpXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobm9kZV90eXBlID09PSBcImFycmF5XCIpIHtcbiAgICAgICAgICAgICAgICBtYXRjaCA9IHBhcnNlX3RyZWVbaV07IC8vIGNvbnZlbmllbmNlIHB1cnBvc2VzIG9ubHlcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8ga2V5d29yZCBhcmd1bWVudFxuICAgICAgICAgICAgICAgICAgICBhcmcgPSBhcmd2W2N1cnNvcl07XG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBtYXRjaFsyXS5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhcmcuaGFzT3duUHJvcGVydHkobWF0Y2hbMl1ba10pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHNwcmludGYoXCJbc3ByaW50Zl0gcHJvcGVydHkgJyVzJyBkb2VzIG5vdCBleGlzdFwiLCBtYXRjaFsyXVtrXSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnW21hdGNoWzJdW2tdXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcG9zaXRpb25hbCBhcmd1bWVudCAoZXhwbGljaXQpXG4gICAgICAgICAgICAgICAgICAgIGFyZyA9IGFyZ3ZbbWF0Y2hbMV1dO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHBvc2l0aW9uYWwgYXJndW1lbnQgKGltcGxpY2l0KVxuICAgICAgICAgICAgICAgICAgICBhcmcgPSBhcmd2W2N1cnNvcisrXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2V0X3R5cGUoYXJnKSA9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHJlLm5vdF9zdHJpbmcudGVzdChtYXRjaFs4XSkgJiYgcmUubm90X2pzb24udGVzdChtYXRjaFs4XSkgJiYgZ2V0X3R5cGUoYXJnKSAhPSBcIm51bWJlclwiICYmIGlzTmFOKGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzcHJpbnRmKFwiW3NwcmludGZdIGV4cGVjdGluZyBudW1iZXIgYnV0IGZvdW5kICVzXCIsIGdldF90eXBlKGFyZykpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAocmUubnVtYmVyLnRlc3QobWF0Y2hbOF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzX3Bvc2l0aXZlID0gYXJnID49IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChtYXRjaFs4XSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnLnRvU3RyaW5nKDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmcgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGFyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRcIjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImlcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZyA9IHBhcnNlSW50KGFyZywgMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJqXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmcgPSBKU09OLnN0cmluZ2lmeShhcmcsIG51bGwsIG1hdGNoWzZdID8gcGFyc2VJbnQobWF0Y2hbNl0pIDogMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZyA9IG1hdGNoWzddID8gYXJnLnRvRXhwb25lbnRpYWwobWF0Y2hbN10pIDogYXJnLnRvRXhwb25lbnRpYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZlwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gbWF0Y2hbN10gPyBwYXJzZUZsb2F0KGFyZykudG9GaXhlZChtYXRjaFs3XSkgOiBwYXJzZUZsb2F0KGFyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImdcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZyA9IG1hdGNoWzddID8gcGFyc2VGbG9hdChhcmcpLnRvUHJlY2lzaW9uKG1hdGNoWzddKSA6IHBhcnNlRmxvYXQoYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwib1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnLnRvU3RyaW5nKDgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmcgPSAoYXJnID0gU3RyaW5nKGFyZykpICYmIG1hdGNoWzddID8gYXJnLnN1YnN0cmluZygwLCBtYXRjaFs3XSkgOiBhcmc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZyA9IGFyZyA+Pj4gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwieFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiWFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZS5qc29uLnRlc3QobWF0Y2hbOF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dFtvdXRwdXQubGVuZ3RoXSA9IGFyZztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmUubnVtYmVyLnRlc3QobWF0Y2hbOF0pICYmICghaXNfcG9zaXRpdmUgfHwgbWF0Y2hbM10pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduID0gaXNfcG9zaXRpdmUgPyBcIitcIiA6IFwiLVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnID0gYXJnLnRvU3RyaW5nKCkucmVwbGFjZShyZS5zaWduLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ24gPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBhZF9jaGFyYWN0ZXIgPSBtYXRjaFs0XSA/IG1hdGNoWzRdID09PSBcIjBcIiA/IFwiMFwiIDogbWF0Y2hbNF0uY2hhckF0KDEpIDogXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgIHBhZF9sZW5ndGggPSBtYXRjaFs2XSAtIChzaWduICsgYXJnKS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHBhZCA9IG1hdGNoWzZdID8gcGFkX2xlbmd0aCA+IDAgPyBzdHJfcmVwZWF0KHBhZF9jaGFyYWN0ZXIsIHBhZF9sZW5ndGgpIDogXCJcIiA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dFtvdXRwdXQubGVuZ3RoXSA9IG1hdGNoWzVdID8gc2lnbiArIGFyZyArIHBhZCA6IHBhZF9jaGFyYWN0ZXIgPT09IFwiMFwiID8gc2lnbiArIHBhZCArIGFyZyA6IHBhZCArIHNpZ24gKyBhcmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQuam9pbihcIlwiKTtcbiAgICB9O1xuXG4gICAgc3ByaW50Zi5jYWNoZSA9IHt9O1xuXG4gICAgc3ByaW50Zi5wYXJzZSA9IGZ1bmN0aW9uIChmbXQpIHtcbiAgICAgICAgdmFyIF9mbXQgPSBmbXQsXG4gICAgICAgICAgICBtYXRjaCA9IFtdLFxuICAgICAgICAgICAgcGFyc2VfdHJlZSA9IFtdLFxuICAgICAgICAgICAgYXJnX25hbWVzID0gMDtcbiAgICAgICAgd2hpbGUgKF9mbXQpIHtcbiAgICAgICAgICAgIGlmICgobWF0Y2ggPSByZS50ZXh0LmV4ZWMoX2ZtdCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VfdHJlZVtwYXJzZV90cmVlLmxlbmd0aF0gPSBtYXRjaFswXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoKG1hdGNoID0gcmUubW9kdWxvLmV4ZWMoX2ZtdCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VfdHJlZVtwYXJzZV90cmVlLmxlbmd0aF0gPSBcIiVcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoKG1hdGNoID0gcmUucGxhY2Vob2xkZXIuZXhlYyhfZm10KSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnX25hbWVzIHw9IDE7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZF9saXN0ID0gW10sXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlbWVudF9maWVsZCA9IG1hdGNoWzJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRfbWF0Y2ggPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChmaWVsZF9tYXRjaCA9IHJlLmtleS5leGVjKHJlcGxhY2VtZW50X2ZpZWxkKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX2xpc3RbZmllbGRfbGlzdC5sZW5ndGhdID0gZmllbGRfbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKHJlcGxhY2VtZW50X2ZpZWxkID0gcmVwbGFjZW1lbnRfZmllbGQuc3Vic3RyaW5nKGZpZWxkX21hdGNoWzBdLmxlbmd0aCkpICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChmaWVsZF9tYXRjaCA9IHJlLmtleV9hY2Nlc3MuZXhlYyhyZXBsYWNlbWVudF9maWVsZCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX2xpc3RbZmllbGRfbGlzdC5sZW5ndGhdID0gZmllbGRfbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoZmllbGRfbWF0Y2ggPSByZS5pbmRleF9hY2Nlc3MuZXhlYyhyZXBsYWNlbWVudF9maWVsZCkpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkX2xpc3RbZmllbGRfbGlzdC5sZW5ndGhdID0gZmllbGRfbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFwiW3NwcmludGZdIGZhaWxlZCB0byBwYXJzZSBuYW1lZCBhcmd1bWVudCBrZXlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKFwiW3NwcmludGZdIGZhaWxlZCB0byBwYXJzZSBuYW1lZCBhcmd1bWVudCBrZXlcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hbMl0gPSBmaWVsZF9saXN0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ19uYW1lcyB8PSAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYXJnX25hbWVzID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIltzcHJpbnRmXSBtaXhpbmcgcG9zaXRpb25hbCBhbmQgbmFtZWQgcGxhY2Vob2xkZXJzIGlzIG5vdCAoeWV0KSBzdXBwb3J0ZWRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhcnNlX3RyZWVbcGFyc2VfdHJlZS5sZW5ndGhdID0gbWF0Y2g7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihcIltzcHJpbnRmXSB1bmV4cGVjdGVkIHBsYWNlaG9sZGVyXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2ZtdCA9IF9mbXQuc3Vic3RyaW5nKG1hdGNoWzBdLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcnNlX3RyZWU7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHZzcHJpbnRmKGZtdCwgYXJndiwgX2FyZ3YpIHtcbiAgICAgICAgX2FyZ3YgPSAoYXJndiB8fCBbXSkuc2xpY2UoMCk7XG4gICAgICAgIF9hcmd2LnNwbGljZSgwLCAwLCBmbXQpO1xuICAgICAgICByZXR1cm4gc3ByaW50Zi5hcHBseShudWxsLCBfYXJndik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogaGVscGVyc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldF90eXBlKHZhcmlhYmxlKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFyaWFibGUpLnNsaWNlKDgsIC0xKS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0cl9yZXBlYXQoaW5wdXQsIG11bHRpcGxpZXIpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5KG11bHRpcGxpZXIgKyAxKS5qb2luKGlucHV0KTtcbiAgICB9XG5cbiAgICB2YXIgaW5kZXggPSB7XG4gICAgICBuYW1lOiAnc3ByaW50ZicsXG4gICAgICB0eXBlOiAncG9zdFByb2Nlc3NvcicsXG5cbiAgICAgIHByb2Nlc3M6IGZ1bmN0aW9uIHByb2Nlc3ModmFsdWUsIGtleSwgb3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMuc3ByaW50ZikgcmV0dXJuIHZhbHVlO1xuXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KG9wdGlvbnMuc3ByaW50ZikgPT09ICdbb2JqZWN0IEFycmF5XScpIHtcbiAgICAgICAgICByZXR1cm4gdnNwcmludGYodmFsdWUsIG9wdGlvbnMuc3ByaW50Zik7XG4gICAgICAgIH0gZWxzZSBpZiAoYmFiZWxIZWxwZXJzLnR5cGVvZihvcHRpb25zLnNwcmludGYpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIHJldHVybiBzcHJpbnRmKHZhbHVlLCBvcHRpb25zLnNwcmludGYpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfSxcbiAgICAgIG92ZXJsb2FkVHJhbnNsYXRpb25PcHRpb25IYW5kbGVyOiBmdW5jdGlvbiBvdmVybG9hZFRyYW5zbGF0aW9uT3B0aW9uSGFuZGxlcihhcmdzKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YWx1ZXMucHVzaChhcmdzW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgcG9zdFByb2Nlc3M6ICdzcHJpbnRmJyxcbiAgICAgICAgICBzcHJpbnRmOiB2YWx1ZXNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIGluZGV4O1xuXG59KSk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9leHRlcm5hbC9pMThuZXh0L3NjcmlwdHMvaTE4bmV4dFNwcmludGZQb3N0UHJvY2Vzc29yLmpzXG4vLyBtb2R1bGUgaWQgPSA4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDpcbiAgdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDpcbiAgKGdsb2JhbC5pMThuZXh0QnJvd3Nlckxhbmd1YWdlRGV0ZWN0b3IgPSBmYWN0b3J5KCkpO1xufSh0aGlzLCBmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICB2YXIgYmFiZWxIZWxwZXJzID0ge307XG5cbiAgYmFiZWxIZWxwZXJzLmNsYXNzQ2FsbENoZWNrID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgfTtcblxuICBiYWJlbEhlbHBlcnMuY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG4gICAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgICAgIGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgICBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcbiAgICAgIHJldHVybiBDb25zdHJ1Y3RvcjtcbiAgICB9O1xuICB9KCk7XG5cbiAgYmFiZWxIZWxwZXJzO1xuXG4gIHZhciBhcnIgPSBbXTtcbiAgdmFyIGVhY2ggPSBhcnIuZm9yRWFjaDtcbiAgdmFyIHNsaWNlID0gYXJyLnNsaWNlO1xuXG4gIGZ1bmN0aW9uIGRlZmF1bHRzKG9iaikge1xuICAgIGVhY2guY2FsbChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgIGlmIChzb3VyY2UpIHtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcbiAgICAgICAgICBpZiAob2JqW3Byb3BdID09PSB1bmRlZmluZWQpIG9ialtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICB2YXIgY29va2llID0ge1xuICAgIGNyZWF0ZTogZnVuY3Rpb24gY3JlYXRlKG5hbWUsIHZhbHVlLCBtaW51dGVzLCBkb21haW4pIHtcbiAgICAgIHZhciBleHBpcmVzID0gdm9pZCAwO1xuICAgICAgaWYgKG1pbnV0ZXMpIHtcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkgKyBtaW51dGVzICogNjAgKiAxMDAwKTtcbiAgICAgICAgZXhwaXJlcyA9ICc7IGV4cGlyZXM9JyArIGRhdGUudG9HTVRTdHJpbmcoKTtcbiAgICAgIH0gZWxzZSBleHBpcmVzID0gJyc7XG4gICAgICBkb21haW4gPSBkb21haW4gPyAnZG9tYWluPScgKyBkb21haW4gKyAnOycgOiAnJztcbiAgICAgIGRvY3VtZW50LmNvb2tpZSA9IG5hbWUgKyAnPScgKyB2YWx1ZSArIGV4cGlyZXMgKyAnOycgKyBkb21haW4gKyAncGF0aD0vJztcbiAgICB9LFxuXG4gICAgcmVhZDogZnVuY3Rpb24gcmVhZChuYW1lKSB7XG4gICAgICB2YXIgbmFtZUVRID0gbmFtZSArICc9JztcbiAgICAgIHZhciBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYyA9IGNhW2ldO1xuICAgICAgICB3aGlsZSAoYy5jaGFyQXQoMCkgPT09ICcgJykge1xuICAgICAgICAgIGMgPSBjLnN1YnN0cmluZygxLCBjLmxlbmd0aCk7XG4gICAgICAgIH1pZiAoYy5pbmRleE9mKG5hbWVFUSkgPT09IDApIHJldHVybiBjLnN1YnN0cmluZyhuYW1lRVEubGVuZ3RoLCBjLmxlbmd0aCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuXG4gICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUobmFtZSkge1xuICAgICAgdGhpcy5jcmVhdGUobmFtZSwgJycsIC0xKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGNvb2tpZSQxID0ge1xuICAgIG5hbWU6ICdjb29raWUnLFxuXG4gICAgbG9va3VwOiBmdW5jdGlvbiBsb29rdXAob3B0aW9ucykge1xuICAgICAgdmFyIGZvdW5kID0gdm9pZCAwO1xuXG4gICAgICBpZiAob3B0aW9ucy5sb29rdXBDb29raWUgJiYgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB2YXIgYyA9IGNvb2tpZS5yZWFkKG9wdGlvbnMubG9va3VwQ29va2llKTtcbiAgICAgICAgaWYgKGMpIGZvdW5kID0gYztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH0sXG4gICAgY2FjaGVVc2VyTGFuZ3VhZ2U6IGZ1bmN0aW9uIGNhY2hlVXNlckxhbmd1YWdlKGxuZywgb3B0aW9ucykge1xuICAgICAgaWYgKG9wdGlvbnMubG9va3VwQ29va2llICYmIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgY29va2llLmNyZWF0ZShvcHRpb25zLmxvb2t1cENvb2tpZSwgbG5nLCBvcHRpb25zLmNvb2tpZU1pbnV0ZXMsIG9wdGlvbnMuY29va2llRG9tYWluKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdmFyIHF1ZXJ5c3RyaW5nID0ge1xuICAgIG5hbWU6ICdxdWVyeXN0cmluZycsXG5cbiAgICBsb29rdXA6IGZ1bmN0aW9uIGxvb2t1cChvcHRpb25zKSB7XG4gICAgICB2YXIgZm91bmQgPSB2b2lkIDA7XG5cbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB2YXIgcXVlcnkgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cmluZygxKTtcbiAgICAgICAgdmFyIHBhcmFtcyA9IHF1ZXJ5LnNwbGl0KCcmJyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdmFyIHBvcyA9IHBhcmFtc1tpXS5pbmRleE9mKCc9Jyk7XG4gICAgICAgICAgaWYgKHBvcyA+IDApIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBwYXJhbXNbaV0uc3Vic3RyaW5nKDAsIHBvcyk7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSBvcHRpb25zLmxvb2t1cFF1ZXJ5c3RyaW5nKSB7XG4gICAgICAgICAgICAgIGZvdW5kID0gcGFyYW1zW2ldLnN1YnN0cmluZyhwb3MgKyAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaGFzTG9jYWxTdG9yYWdlU3VwcG9ydCA9IHZvaWQgMDtcbiAgdHJ5IHtcbiAgICBoYXNMb2NhbFN0b3JhZ2VTdXBwb3J0ID0gd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cubG9jYWxTdG9yYWdlICE9PSBudWxsO1xuICAgIHZhciB0ZXN0S2V5ID0gJ2kxOG5leHQudHJhbnNsYXRlLmJvbyc7XG4gICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKHRlc3RLZXksICdmb28nKTtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGVzdEtleSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBoYXNMb2NhbFN0b3JhZ2VTdXBwb3J0ID0gZmFsc2U7XG4gIH1cblxuICB2YXIgbG9jYWxTdG9yYWdlID0ge1xuICAgIG5hbWU6ICdsb2NhbFN0b3JhZ2UnLFxuXG4gICAgbG9va3VwOiBmdW5jdGlvbiBsb29rdXAob3B0aW9ucykge1xuICAgICAgdmFyIGZvdW5kID0gdm9pZCAwO1xuXG4gICAgICBpZiAob3B0aW9ucy5sb29rdXBMb2NhbFN0b3JhZ2UgJiYgaGFzTG9jYWxTdG9yYWdlU3VwcG9ydCkge1xuICAgICAgICB2YXIgbG5nID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKG9wdGlvbnMubG9va3VwTG9jYWxTdG9yYWdlKTtcbiAgICAgICAgaWYgKGxuZykgZm91bmQgPSBsbmc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9LFxuICAgIGNhY2hlVXNlckxhbmd1YWdlOiBmdW5jdGlvbiBjYWNoZVVzZXJMYW5ndWFnZShsbmcsIG9wdGlvbnMpIHtcbiAgICAgIGlmIChvcHRpb25zLmxvb2t1cExvY2FsU3RvcmFnZSAmJiBoYXNMb2NhbFN0b3JhZ2VTdXBwb3J0KSB7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShvcHRpb25zLmxvb2t1cExvY2FsU3RvcmFnZSwgbG5nKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdmFyIG5hdmlnYXRvciQxID0ge1xuICAgIG5hbWU6ICduYXZpZ2F0b3InLFxuXG4gICAgbG9va3VwOiBmdW5jdGlvbiBsb29rdXAob3B0aW9ucykge1xuICAgICAgdmFyIGZvdW5kID0gW107XG5cbiAgICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpZiAobmF2aWdhdG9yLmxhbmd1YWdlcykge1xuICAgICAgICAgIC8vIGNocm9tZSBvbmx5OyBub3QgYW4gYXJyYXksIHNvIGNhbid0IHVzZSAucHVzaC5hcHBseSBpbnN0ZWFkIG9mIGl0ZXJhdGluZ1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbmF2aWdhdG9yLmxhbmd1YWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZm91bmQucHVzaChuYXZpZ2F0b3IubGFuZ3VhZ2VzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hdmlnYXRvci51c2VyTGFuZ3VhZ2UpIHtcbiAgICAgICAgICBmb3VuZC5wdXNoKG5hdmlnYXRvci51c2VyTGFuZ3VhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuYXZpZ2F0b3IubGFuZ3VhZ2UpIHtcbiAgICAgICAgICBmb3VuZC5wdXNoKG5hdmlnYXRvci5sYW5ndWFnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZvdW5kLmxlbmd0aCA+IDAgPyBmb3VuZCA6IHVuZGVmaW5lZDtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGh0bWxUYWcgPSB7XG4gICAgbmFtZTogJ2h0bWxUYWcnLFxuXG4gICAgbG9va3VwOiBmdW5jdGlvbiBsb29rdXAob3B0aW9ucykge1xuICAgICAgdmFyIGZvdW5kID0gdm9pZCAwO1xuICAgICAgdmFyIGh0bWxUYWcgPSBvcHRpb25zLmh0bWxUYWcgfHwgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgPyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgOiBudWxsKTtcblxuICAgICAgaWYgKGh0bWxUYWcgJiYgdHlwZW9mIGh0bWxUYWcuZ2V0QXR0cmlidXRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGZvdW5kID0gaHRtbFRhZy5nZXRBdHRyaWJ1dGUoJ2xhbmcnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBnZXREZWZhdWx0cygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb3JkZXI6IFsncXVlcnlzdHJpbmcnLCAnY29va2llJywgJ2xvY2FsU3RvcmFnZScsICduYXZpZ2F0b3InLCAnaHRtbFRhZyddLFxuICAgICAgbG9va3VwUXVlcnlzdHJpbmc6ICdsbmcnLFxuICAgICAgbG9va3VwQ29va2llOiAnaTE4bmV4dCcsXG4gICAgICBsb29rdXBMb2NhbFN0b3JhZ2U6ICdpMThuZXh0TG5nJyxcblxuICAgICAgLy8gY2FjaGUgdXNlciBsYW5ndWFnZVxuICAgICAgY2FjaGVzOiBbJ2xvY2FsU3RvcmFnZSddLFxuICAgICAgZXhjbHVkZUNhY2hlRm9yOiBbJ2NpbW9kZSddXG4gICAgICAvL2Nvb2tpZU1pbnV0ZXM6IDEwLFxuICAgICAgLy9jb29raWVEb21haW46ICdteURvbWFpbidcbiAgICB9O1xuICB9XG5cbiAgdmFyIEJyb3dzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQnJvd3NlcihzZXJ2aWNlcykge1xuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcbiAgICAgIGJhYmVsSGVscGVycy5jbGFzc0NhbGxDaGVjayh0aGlzLCBCcm93c2VyKTtcblxuICAgICAgdGhpcy50eXBlID0gJ2xhbmd1YWdlRGV0ZWN0b3InO1xuICAgICAgdGhpcy5kZXRlY3RvcnMgPSB7fTtcblxuICAgICAgdGhpcy5pbml0KHNlcnZpY2VzLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICBiYWJlbEhlbHBlcnMuY3JlYXRlQ2xhc3MoQnJvd3NlciwgW3tcbiAgICAgIGtleTogJ2luaXQnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoc2VydmljZXMpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgdmFyIGkxOG5PcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAyIHx8IGFyZ3VtZW50c1syXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMl07XG5cbiAgICAgICAgdGhpcy5zZXJ2aWNlcyA9IHNlcnZpY2VzO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBkZWZhdWx0cyhvcHRpb25zLCB0aGlzLm9wdGlvbnMgfHwge30sIGdldERlZmF1bHRzKCkpO1xuICAgICAgICB0aGlzLmkxOG5PcHRpb25zID0gaTE4bk9wdGlvbnM7XG5cbiAgICAgICAgdGhpcy5hZGREZXRlY3Rvcihjb29raWUkMSk7XG4gICAgICAgIHRoaXMuYWRkRGV0ZWN0b3IocXVlcnlzdHJpbmcpO1xuICAgICAgICB0aGlzLmFkZERldGVjdG9yKGxvY2FsU3RvcmFnZSk7XG4gICAgICAgIHRoaXMuYWRkRGV0ZWN0b3IobmF2aWdhdG9yJDEpO1xuICAgICAgICB0aGlzLmFkZERldGVjdG9yKGh0bWxUYWcpO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2FkZERldGVjdG9yJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGREZXRlY3RvcihkZXRlY3Rvcikge1xuICAgICAgICB0aGlzLmRldGVjdG9yc1tkZXRlY3Rvci5uYW1lXSA9IGRldGVjdG9yO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2RldGVjdCcsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gZGV0ZWN0KGRldGVjdGlvbk9yZGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgaWYgKCFkZXRlY3Rpb25PcmRlcikgZGV0ZWN0aW9uT3JkZXIgPSB0aGlzLm9wdGlvbnMub3JkZXI7XG5cbiAgICAgICAgdmFyIGRldGVjdGVkID0gW107XG4gICAgICAgIGRldGVjdGlvbk9yZGVyLmZvckVhY2goZnVuY3Rpb24gKGRldGVjdG9yTmFtZSkge1xuICAgICAgICAgIGlmIChfdGhpcy5kZXRlY3RvcnNbZGV0ZWN0b3JOYW1lXSkge1xuICAgICAgICAgICAgdmFyIGxvb2t1cCA9IF90aGlzLmRldGVjdG9yc1tkZXRlY3Rvck5hbWVdLmxvb2t1cChfdGhpcy5vcHRpb25zKTtcbiAgICAgICAgICAgIGlmIChsb29rdXAgJiYgdHlwZW9mIGxvb2t1cCA9PT0gJ3N0cmluZycpIGxvb2t1cCA9IFtsb29rdXBdO1xuICAgICAgICAgICAgaWYgKGxvb2t1cCkgZGV0ZWN0ZWQgPSBkZXRlY3RlZC5jb25jYXQobG9va3VwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBmb3VuZCA9IHZvaWQgMDtcbiAgICAgICAgZGV0ZWN0ZWQuZm9yRWFjaChmdW5jdGlvbiAobG5nKSB7XG4gICAgICAgICAgaWYgKGZvdW5kKSByZXR1cm47XG4gICAgICAgICAgdmFyIGNsZWFuZWRMbmcgPSBfdGhpcy5zZXJ2aWNlcy5sYW5ndWFnZVV0aWxzLmZvcm1hdExhbmd1YWdlQ29kZShsbmcpO1xuICAgICAgICAgIGlmIChfdGhpcy5zZXJ2aWNlcy5sYW5ndWFnZVV0aWxzLmlzV2hpdGVsaXN0ZWQoY2xlYW5lZExuZykpIGZvdW5kID0gY2xlYW5lZExuZztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZvdW5kIHx8IHRoaXMuaTE4bk9wdGlvbnMuZmFsbGJhY2tMbmdbMF07XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiAnY2FjaGVVc2VyTGFuZ3VhZ2UnLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhY2hlVXNlckxhbmd1YWdlKGxuZywgY2FjaGVzKSB7XG4gICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgIGlmICghY2FjaGVzKSBjYWNoZXMgPSB0aGlzLm9wdGlvbnMuY2FjaGVzO1xuICAgICAgICBpZiAoIWNhY2hlcykgcmV0dXJuO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmV4Y2x1ZGVDYWNoZUZvciAmJiB0aGlzLm9wdGlvbnMuZXhjbHVkZUNhY2hlRm9yLmluZGV4T2YobG5nKSA+IC0xKSByZXR1cm47XG4gICAgICAgIGNhY2hlcy5mb3JFYWNoKGZ1bmN0aW9uIChjYWNoZU5hbWUpIHtcbiAgICAgICAgICBpZiAoX3RoaXMyLmRldGVjdG9yc1tjYWNoZU5hbWVdKSBfdGhpczIuZGV0ZWN0b3JzW2NhY2hlTmFtZV0uY2FjaGVVc2VyTGFuZ3VhZ2UobG5nLCBfdGhpczIub3B0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1dKTtcbiAgICByZXR1cm4gQnJvd3NlcjtcbiAgfSgpO1xuXG4gIEJyb3dzZXIudHlwZSA9ICdsYW5ndWFnZURldGVjdG9yJztcblxuICByZXR1cm4gQnJvd3NlcjtcblxufSkpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vZXh0ZXJuYWwvaTE4bmV4dC9zY3JpcHRzL2kxOG5leHRCcm93c2VyTGFuZ3VhZ2VEZXRlY3Rvci5qc1xuLy8gbW9kdWxlIGlkID0gOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXX0="]}